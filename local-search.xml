<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>DEXæ–‡ä»¶ç»“æ„</title>
    <link href="/2025/09/21/DEX%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"/>
    <url>/2025/09/21/DEX%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<h2 id="ğŸ“„-åœ¨çº¿æŸ¥çœ‹-PDF"><a href="#ğŸ“„-åœ¨çº¿æŸ¥çœ‹-PDF" class="headerlink" title="ğŸ“„ åœ¨çº¿æŸ¥çœ‹ PDF"></a>ğŸ“„ åœ¨çº¿æŸ¥çœ‹ PDF</h2><iframe src="/PDF/DEXåŸºæœ¬ç»“æ„.pdf" width="100%" height="600px"></iframe>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DEXç»“æ„</tag>
      
      <tag>å£³</tag>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯†ç å­¦åŸºç¡€ï¼Œç®—æ³•è‡ªå</title>
    <link href="/2025/04/01/ZJ9/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%EF%BC%8C%E7%AE%97%E6%B3%95%E8%87%AA%E5%90%90%EF%BC%8C%E9%9D%9E%E6%A0%87%E5%87%86%E5%8A%A0%E5%AF%86%E5%AF%B9%E6%8A%97%201c3a6f4b4daf803eb988f970e5d95436/"/>
    <url>/2025/04/01/ZJ9/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80%EF%BC%8C%E7%AE%97%E6%B3%95%E8%87%AA%E5%90%90%EF%BC%8C%E9%9D%9E%E6%A0%87%E5%87%86%E5%8A%A0%E5%AF%86%E5%AF%B9%E6%8A%97%201c3a6f4b4daf803eb988f970e5d95436/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯†ç å­¦åŸºç¡€ï¼Œç®—æ³•è‡ªåï¼Œéæ ‡å‡†åŠ å¯†å¯¹æŠ—"><a href="#å¯†ç å­¦åŸºç¡€ï¼Œç®—æ³•è‡ªåï¼Œéæ ‡å‡†åŠ å¯†å¯¹æŠ—" class="headerlink" title="å¯†ç å­¦åŸºç¡€ï¼Œç®—æ³•è‡ªåï¼Œéæ ‡å‡†åŠ å¯†å¯¹æŠ—"></a>å¯†ç å­¦åŸºç¡€ï¼Œç®—æ³•è‡ªåï¼Œéæ ‡å‡†åŠ å¯†å¯¹æŠ—</h1><h1 id="1-ä»€ä¹ˆæ˜¯å¯†ç å­¦"><a href="#1-ä»€ä¹ˆæ˜¯å¯†ç å­¦" class="headerlink" title="1.ä»€ä¹ˆæ˜¯å¯†ç å­¦?"></a><strong>1.ä»€ä¹ˆæ˜¯å¯†ç å­¦?</strong></h1><p>å¯†ç å­¦(cryptography)æ˜¯ä¸€ç§å°†ä¿¡æ¯è¡¨è¿°ä¸ºä¸å¯è¯»çš„æ–¹å¼ï¼Œå¹¶ä½¿ç”¨ä¸€ç§ç§˜å¯†çš„æ–¹æ³•å°†ä¿¡æ¯æ¢å¤å‡ºæ¥çš„ç§‘å­¦ã€‚å¯†ç å­¦æä¾›çš„æœ€åŸºæœ¬çš„æœåŠ¡æ˜¯æ•°æ®æœºå¯†æ€§æœåŠ¡ï¼Œå°±æ˜¯ä½¿é€šä¿¡åŒæ–¹å¯ä»¥äº’ç›¸å‘é€æ¶ˆæ¯ï¼Œå¹¶ä¸”é¿å…ä»–äººçªƒå–æ¶ˆæ¯çš„å†…å®¹ã€‚åŠ å¯†ç®—æ³•æ˜¯å¯†ç å­¦çš„æ ¸å¿ƒã€‚</p><ul><li><p>æ˜æ–‡ï¼šåŸå§‹æ¶ˆæ¯</p></li><li><p>å¯†æ–‡ï¼šåŠ å¯†åçš„æ¶ˆæ¯</p></li><li><p>åŠ å¯†ï¼šä»æ˜æ–‡åˆ°å¯†æ–‡çš„å˜æ¢è¿‡ç¨‹</p></li><li><p>è§£å¯†ï¼šä»å¯†æ–‡åˆ°æ˜æ–‡çš„å˜æ¢è¿‡ç¨‹</p></li><li><p>å¯†é’¥ï¼šç›¸ç”¨æ¥å®ŒæˆåŠ è§£å¯†ç­‰è¿‡ç¨‹çš„ç§˜å¯†ä¿¡æ¯</p><p>  <img src="http://pic.rmb.bdstatic.com/bjh/2115b905b61a6e036f43b84c8bcd545d.png"></p></li></ul><h1 id="2-å¸¸è§ç¼–ç "><a href="#2-å¸¸è§ç¼–ç " class="headerlink" title="2.å¸¸è§ç¼–ç "></a><strong>2.å¸¸è§ç¼–ç </strong></h1><p>åœ¨android studioä¸­å¦‚æœæ— æ³•è¿è¡Œjavaå¯¹gradleæ–‡ä»¶è¿›è¡Œä¸€ä¸‹ä¿®æ”¹</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011856496.png"></p><h2 id="1-Base64ç¼–ç "><a href="#1-Base64ç¼–ç " class="headerlink" title="1.Base64ç¼–ç "></a><strong>1.Base64ç¼–ç </strong></h2><p><a href="https://gchq.github.io/CyberChef/">CyberChef</a></p><p>å®šä¹‰:</p><p>Base64æ˜¯ä¸€ç§ç”¨64ä¸ªå­—ç¬¦è¡¨ç¤ºä»»æ„äºŒè¿›åˆ¶æ•°æ®çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ç§ç¼–ç ï¼Œå¹¶éåŠ å¯†å­—ç¬¦ç¼–ç ï¼Œç”± A-Z a-z 0-9 + / å’Œè¡¥å……å­—ç¬¦ â€œ=â€ ç»„æˆï¼ŒBase64ç¼–ç åçš„å­—ç¬¦æ•°æ˜¯4çš„å€æ•°ï¼ˆä¸è¶³ä¼šè¡¥â€=â€ï¼‰</p><p>æ˜æ–‡:</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">CC<span class="hljs-number">1313113</span>!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Encoded string: <span class="hljs-attribute">Q0MxMzEzMTEzIQ</span>==<br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Base64Example</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br><br>        <span class="hljs-comment">// ç¼–ç </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">encodedString</span> <span class="hljs-operator">=</span> Base64.getEncoder().encodeToString(text.getBytes());<br>        System.out.println(<span class="hljs-string">"Encoded string: "</span> + encodedString);<br><br>        <span class="hljs-comment">// è§£ç </span><br>        <span class="hljs-type">byte</span>[] decodedBytes = Base64.getDecoder().decode(encodedString);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decodedString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decodedBytes);<br>        System.out.println(<span class="hljs-string">"Decoded string: "</span> + decodedString);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011857105.png"></p><p>è‡ªå®ç°base64ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Base64Example</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//base64ç è¡¨</span><br>&nbsp; &nbsp; <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">base64Chars</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;<br><br>&nbsp; &nbsp; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">originalInput</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å¾çˆ±ç ´è§£è®ºå›"</span>;<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">// ç¼–ç </span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">encodedString</span> <span class="hljs-operator">=</span> encodeBase64(originalInput.getBytes());<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;System.out.println(<span class="hljs-string">"Encoded string: "</span> + encodedString);<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">// è§£ç </span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">byte</span>[] decodedBytes = decodeBase64(encodedString);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">decodedString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decodedBytes);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;System.out.println(<span class="hljs-string">"Decoded string: "</span> + decodedString);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">encodeBase64</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] inputBytes)</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">int</span> <span class="hljs-variable">paddingCount</span> <span class="hljs-operator">=</span> (<span class="hljs-number">3</span> - inputBytes.length % <span class="hljs-number">3</span>) % <span class="hljs-number">3</span>;<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; inputBytes.length; i += <span class="hljs-number">3</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> ((inputBytes[i] &amp; <span class="hljs-number">0xFF</span>) &lt;&lt; <span class="hljs-number">16</span>) | ((i + <span class="hljs-number">1</span> &lt; inputBytes.length ? inputBytes[i + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0xFF</span> : <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">8</span>) | (i + <span class="hljs-number">2</span> &lt; inputBytes.length ? inputBytes[i + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xFF</span> : <span class="hljs-number">0</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sb.append(base64Chars.charAt((b &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3F</span>)).append(base64Chars.charAt((b &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3F</span>)).append(base64Chars.charAt((b &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>)).append(base64Chars.charAt(b &amp; <span class="hljs-number">0x3F</span>));<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; paddingCount; i++) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sb.setCharAt(sb.length() - i - <span class="hljs-number">1</span>, <span class="hljs-string">'='</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> sb.toString();<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] decodeBase64(String inputString) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">bos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">int</span> <span class="hljs-variable">paddingCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; inputString.length(); i += <span class="hljs-number">4</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> (base64Chars.indexOf(inputString.charAt(i)) &lt;&lt; <span class="hljs-number">18</span>) | (base64Chars.indexOf(inputString.charAt(i + <span class="hljs-number">1</span>)) &lt;&lt; <span class="hljs-number">12</span>) | (i + <span class="hljs-number">2</span> &lt; inputString.length() &amp;&amp; inputString.charAt(i + <span class="hljs-number">2</span>) != <span class="hljs-string">'='</span> ? base64Chars.indexOf(inputString.charAt(i + <span class="hljs-number">2</span>)) &lt;&lt; <span class="hljs-number">6</span> : <span class="hljs-number">0</span>) | (i + <span class="hljs-number">3</span> &lt; inputString.length() &amp;&amp; inputString.charAt(i + <span class="hljs-number">3</span>) != <span class="hljs-string">'='</span> ? base64Chars.indexOf(inputString.charAt(i + <span class="hljs-number">3</span>)) : <span class="hljs-number">0</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;bos.write((b &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;bos.write((b &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;bos.write(b &amp; <span class="hljs-number">0xFF</span>);<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">if</span> (inputString.charAt(i + <span class="hljs-number">2</span>) == <span class="hljs-string">'='</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; paddingCount++;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">if</span> (inputString.charAt(i + <span class="hljs-number">3</span>) == <span class="hljs-string">'='</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; paddingCount++;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">byte</span>[] result = bos.toByteArray();<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (paddingCount &gt; <span class="hljs-number">0</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">byte</span>[] trimmedResult = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[result.length - paddingCount];<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;System.arraycopy(result, <span class="hljs-number">0</span>, trimmedResult, <span class="hljs-number">0</span>, trimmedResult.length);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">return</span> trimmedResult;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;} <span class="hljs-keyword">else</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">return</span> result;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>&nbsp; &nbsp; }<br>}<br><br></code></pre></td></tr></tbody></table></figure><h2 id="2-Hexç¼–ç "><a href="#2-Hexç¼–ç " class="headerlink" title="2.Hexç¼–ç "></a><strong>2.Hexç¼–ç </strong></h2><p>å®šä¹‰:</p><p>hexç¼–ç ï¼Œåˆç§°åå…­è¿›åˆ¶ç¼–ç (ä¹Ÿç§°base16)ï¼Œä¸€èˆ¬ç”¨äºæ–¹ä¾¿äººä»¬æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹ï¼Œå®ƒå°†å­—èŠ‚æ•°æ®ä¸­çš„æ¯4ä¸ªbitä½¿ç”¨æ•°å­—(0-9)ã€å­—æ¯(A-F)å…±16ä¸ªå­—ç¬¦ç­‰æ•ˆè¡¨ç¤ºï¼Œç”±äºä¸€ä¸ªå­—èŠ‚æœ‰8ä¸ªbitï¼Œæ‰€ä»¥ä¸€ä¸ªå­—èŠ‚ä¼šè¢«ç¼–ç ä¸º2ä¸ªhexå­—ç¬¦</p><p>PS:åœ¨ ASCII ç¼–ç ä¸­ï¼Œåªæœ‰0åˆ°127ä¹‹é—´çš„æ•°å­—æ˜¯è¡¨ç¤ºè‹±æ–‡å­—æ¯ã€æ•°å­—å’Œç¬¦å·çš„ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦éœ€è¦ä½¿ç”¨å…¶ä»–ç¼–ç æ–¹å¼,ä¾‹å¦‚æ±‰å­—å°±éœ€è¦ä½¿ç”¨ UTF-8 æˆ– UTF-16</p><p>æ˜æ–‡:</p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">å¾çˆ±ç ´è§£è®ºå›<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">E590BEE788B1E7A0B4E8A7A3E8AEBAE59D9B<br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><p><code>%02X</code>&nbsp;æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå…¶ä¸­&nbsp;<code>%</code>&nbsp;æ˜¯è½¬ä¹‰ç¬¦ï¼Œ<code>02</code>&nbsp;æ˜¯æœ€å°å®½åº¦ï¼Œè¡¨ç¤ºè¾“å‡ºçš„å­—ç¬¦ä¸²è‡³å°‘åŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼Œä¸è¶³ä¸¤ä¸ªå­—ç¬¦æ—¶ç”¨&nbsp;<code>0</code>&nbsp;å¡«å……ï¼Œ<code>X</code>&nbsp;è¡¨ç¤ºè¾“å‡ºçš„å­—ç¬¦é›†ä¸ºå¤§å†™çš„åå…­è¿›åˆ¶æ•°ã€‚(ç®—æ˜¯ä¸€ä¸ªç‰¹å¾)</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å°†æ™®é€šå­—ç¬¦ä¸²è½¬æ¢ä¸ºHexå­—ç¬¦ä¸²</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-type">byte</span>[] bytes = input.getBytes(StandardCharsets.UTF_8);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">byte</span> b : bytes) {<br>            output.append(String.format(<span class="hljs-string">"%02X"</span>, b));<br>        }<br>        System.out.println(output.toString());<br>    }<br><span class="hljs-comment">// å°†Hexå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ™®é€šå­—ç¬¦ä¸²</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">hexToString</span><span class="hljs-params">(String input)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">byte</span>[] bytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[input.length() / <span class="hljs-number">2</span>];<br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; input.length(); i += <span class="hljs-number">2</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;bytes[i / <span class="hljs-number">2</span>] = (<span class="hljs-type">byte</span>) Integer.parseInt(input.substring(i, i + <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(bytes, StandardCharsets.UTF_8);<br>}                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011857834.png"></p><h2 id="3-Unicodeç¼–ç "><a href="#3-Unicodeç¼–ç " class="headerlink" title="3.Unicodeç¼–ç "></a><strong>3.Unicodeç¼–ç </strong></h2><p>å®šä¹‰:</p><p>Unicodeï¼ˆç»Ÿä¸€ç ã€ä¸‡å›½ç ã€å•ä¸€ç ï¼‰æ˜¯ä¸€ç§åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨çš„å­—ç¬¦ç¼–ç ã€‚</p><p>æ˜æ–‡:</p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">å¾çˆ±ç ´è§£è®ºå›<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight clojure"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clojure"><span class="hljs-character">\u543E</span><span class="hljs-character">\u7231</span><span class="hljs-character">\u7834</span><span class="hljs-character">\u89E3</span><span class="hljs-character">\u8BBA</span><span class="hljs-character">\u575B</span><br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºUnicodeæ ¼å¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">stringToUnicode</span><span class="hljs-params">(String input)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; input.length(); i++) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;output.append(String.format(<span class="hljs-string">"\\u%04X"</span>, (<span class="hljs-type">int</span>) input.charAt(i)));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> output.toString();<br>}<br><span class="hljs-comment">// å°†Unicodeæ ¼å¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºåŸå§‹å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">unicodeToString</span><span class="hljs-params">(String input)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; input.length(); i += <span class="hljs-number">6</span>) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> input.substring(i + <span class="hljs-number">2</span>, i + <span class="hljs-number">6</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;output.append((<span class="hljs-type">char</span>) Integer.parseInt(str, <span class="hljs-number">16</span>));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> output.toString();<br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011858599.png"></p><p>æœ‰äº›ç¼–è¯‘å™¨å¯ä»¥å°†Unicodeç¼–ç ç›´æ¥åç¼–è¯‘å‡ºæ¥ï¼Œå½“ç„¶æˆ‘çš„jebæ˜¾ç„¶æ²¡æœ‰è‡ªå·±è¿˜åŸç¼–ç ï¼ˆå¹æ°”ï¼Œå®³ï¼‰ã€‚</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011858909.png"></p><h2 id="4-Byteæ•°ç»„"><a href="#4-Byteæ•°ç»„" class="headerlink" title="4.Byteæ•°ç»„"></a><strong>4.Byteæ•°ç»„</strong></h2><p>PSï¼šå¸¸ç”¨äºå­—ç¬¦ä¸²åŠ å¯†</p><p>æ˜æ–‡ï¼š</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">CC<span class="hljs-number">1313113</span>!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">[<span class="hljs-number">67</span>, <span class="hljs-number">67</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">33</span>]<br></code></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cc.xoseddemo1;<br><br><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">text</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">originalInput</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br>        <span class="hljs-type">byte</span>[] bytes = originalInput.getBytes();<br>        System.out.println(Arrays.toString(bytes));<br><br>        <span class="hljs-type">byte</span>[] byteArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">67</span>, <span class="hljs-number">67</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">33</span>};<br>        <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(byteArray);<br>        System.out.println(str);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011858329.png"></p><h1 id="3-åŠ å¯†ç®—æ³•"><a href="#3-åŠ å¯†ç®—æ³•" class="headerlink" title="3.åŠ å¯†ç®—æ³•"></a><strong>3.åŠ å¯†ç®—æ³•</strong></h1><h2 id="1-æ¶ˆæ¯æ‘˜è¦ç®—æ³•-å•å‘æ•£åˆ—å‡½æ•°-å“ˆå¸Œç®—æ³•"><a href="#1-æ¶ˆæ¯æ‘˜è¦ç®—æ³•-å•å‘æ•£åˆ—å‡½æ•°-å“ˆå¸Œç®—æ³•" class="headerlink" title="1.æ¶ˆæ¯æ‘˜è¦ç®—æ³•&amp;å•å‘æ•£åˆ—å‡½æ•°&amp;å“ˆå¸Œç®—æ³•"></a><strong>1.æ¶ˆæ¯æ‘˜è¦ç®—æ³•&amp;å•å‘æ•£åˆ—å‡½æ•°&amp;å“ˆå¸Œç®—æ³•</strong></h2><p>å®šä¹‰:</p><p>å•å‘æ•£åˆ—å‡½æ•°ç®—æ³•ä¹Ÿç§°Hashï¼ˆå“ˆå¸Œï¼‰ç®—æ³•(æ¶ˆæ¯æ‘˜è¦ç®—æ³•)ï¼Œæ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦ï¼ˆæ¶ˆæ¯æ‘˜è¦ï¼‰çš„å‡½æ•°ï¼ˆè¯¥è¿‡ç¨‹ä¸å¯é€†ï¼‰ã€‚ Hashå‡½æ•°å¯ç”¨äºæ•°å­—ç­¾åã€ æ¶ˆæ¯çš„å®Œæ•´æ€§æ£€æµ‹ã€æ¶ˆæ¯èµ·æºçš„è®¤è¯æ£€æµ‹ç­‰ã€‚</p><p>å¸¸è§çš„ç®—æ³•:MD5ã€HMACã€SHA-X(SHA-1,SHA-2)</p><h3 id="MD5æ‘˜è¦"><a href="#MD5æ‘˜è¦" class="headerlink" title="MD5æ‘˜è¦"></a><strong>MD5æ‘˜è¦</strong></h3><p>ç‰¹æ€§:</p><ul><li>å‹ç¼©æ€§:æ— è®ºæ•°æ®é•¿åº¦æ˜¯å¤šå°‘,è®¡ç®—å‡ºæ¥çš„MD5å€¼é•¿åº¦ç›¸åŒ(16ä½ã€32ä½)</li><li>æŠ—ä¿®æ”¹æ€§:å³ä¾¿ä¿®æ”¹ä¸€ä¸ªå­—èŠ‚ï¼Œè®¡ç®—å‡ºæ¥çš„MD5å€¼ä¹Ÿä¼šå·¨å¤§å·®å¼‚</li></ul><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011858146.png"></p><ul><li>æŠ—ç¢°æ’æ€§:çŸ¥é“æ•°æ®å’ŒMD5å€¼ï¼Œå¾ˆå°æ¦‚ç‡æ‰¾åˆ°ç›¸åŒMD5å€¼ç›¸åŒçš„åŸæ•°æ®</li><li>æ˜“è®¡ç®—æ€§:ç”±åŸæ•°æ®å®¹æ˜“è®¡ç®—å‡ºMD5å€¼(é€†æ¨)</li></ul><p>æ˜æ–‡:</p><figure class="highlight erlang-repl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">CC313113!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">f80ca4900ca4b8a6e9b676bcc<span class="hljs-number">203d0d9</span><br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchAlgorithmException {<br>        <span class="hljs-type">MessageDigest</span> <span class="hljs-variable">md</span> <span class="hljs-operator">=</span> MessageDigest.getInstance(<span class="hljs-string">"MD5"</span>);<br>        md.update(<span class="hljs-string">"CC313113!"</span>.getBytes());<br>        <span class="hljs-type">byte</span>[] res = md.digest();<br>        System.out.println(byteToHexString(res));<br>    }<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">byteToHexString</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] by)</span> {<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">SB</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k : by) {<br>            <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> k;<br>            <span class="hljs-keyword">if</span> (k &lt; <span class="hljs-number">0</span>) {<br>                j = k + <span class="hljs-number">256</span>;<br>            }<br>            <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">16</span>) {<br>                SB.append(<span class="hljs-string">"0"</span>);<br>            }<br>            SB.append(Integer.toHexString(j));<br>        }<br>        <span class="hljs-keyword">return</span> SB.toString();<br>    }<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011858439.png"></p><h2 id="2-å¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#2-å¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="2.å¯¹ç§°åŠ å¯†ç®—æ³•"></a><strong>2.å¯¹ç§°åŠ å¯†ç®—æ³•</strong></h2><p>å®šä¹‰:</p><p>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒå¯†é’¥çš„å¯†ç ç®—æ³•å«å¯¹ç§°åŠ è§£å¯†ç®—æ³•ï¼Œç®€ç§°å¯¹ç§°ç®—æ³•ã€‚å¯¹ç§°ç®—æ³•é€Ÿåº¦å¿«ï¼Œé€šå¸¸åœ¨éœ€è¦åŠ å¯†å¤§é‡æ•°æ®æ—¶ä½¿ç”¨ã€‚æ‰€è°“å¯¹ç§°ï¼Œå°±æ˜¯é‡‡ç”¨è¿™ç§å¯†ç æ–¹æ³•çš„åŒæ–¹ä½¿ç”¨åŒæ ·çš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</p><p><img src="http://pic.rmb.bdstatic.com/bjh/bb79537ec46505e2af3db6ad7d945ef8.png"></p><p>å¯¹ç§°åŠ å¯†ç®—æ³•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p><ul><li>DESï¼ˆæ•°æ®åŠ å¯†æ ‡å‡†ï¼‰ï¼šDESæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨56ä½å¯†é’¥ï¼Œå°†æ•°æ®åˆ†æˆ64ä½å—ï¼Œç„¶åè¿›è¡ŒåŠ å¯†ã€‚ç”±äºDESçš„å¯†é’¥é•¿åº¦æ¯”è¾ƒçŸ­ï¼Œæ˜“å—åˆ°æš´åŠ›ç ´è§£æ”»å‡»ã€‚</li><li>3DESï¼ˆä¸‰é‡DESï¼‰ï¼š3DESæ˜¯åŸºäºDESç®—æ³•çš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä½¿ç”¨ä¸‰ä¸ª56ä½çš„å¯†é’¥ï¼Œå¯¹æ•°æ®è¿›è¡Œä¸‰æ¬¡åŠ å¯†ï¼Œä»è€Œå¢åŠ äº†åŠ å¯†å¼ºåº¦ã€‚3DESæ¯”DESæ›´åŠ å®‰å…¨ï¼Œä½†æ˜¯åŠ å¯†é€Ÿåº¦è¾ƒæ…¢ã€‚</li><li>AESï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰ï¼šAESæ˜¯ä¸€ç§é«˜çº§çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨128ã€192æˆ–256ä½å¯†é’¥ï¼Œå¯ä»¥å¯¹ä¸åŒé•¿åº¦çš„æ•°æ®å—è¿›è¡ŒåŠ å¯†ã€‚AESæ¯”DESå’Œ3DESæ›´åŠ å®‰å…¨ï¼Œä¸”åŠ å¯†é€Ÿåº¦æ›´å¿«ã€‚</li><li>RC4ï¼šRC4æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚RC4çš„å¯†é’¥é•¿åº¦å¯ä»¥æ˜¯40ä½ã€64ä½ã€128ä½ç­‰ä¸åŒé•¿åº¦ã€‚RC4åœ¨å®é™…åº”ç”¨ä¸­å·²ç»è¢«è¯æ˜å­˜åœ¨æ¼æ´ï¼Œä¸å†è¢«æ¨èä½¿ç”¨ã€‚</li></ul><h3 id="1-AESåŠ è§£å¯†"><a href="#1-AESåŠ è§£å¯†" class="headerlink" title="(1)AESåŠ è§£å¯†"></a><strong>(1)AESåŠ è§£å¯†</strong></h3><p>æ˜æ–‡:</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">CC<span class="hljs-number">1313113</span>!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">j94q+kL0+SlVpeGPYjAztA==<br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AES</span> <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ALGORITHM</span> <span class="hljs-operator">=</span> <span class="hljs-string">"AES"</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TRANSFORMATION</span> <span class="hljs-operator">=</span> <span class="hljs-string">"AES/ECB/PKCS5Padding"</span>;<span class="hljs-comment">//åŠ å¯†æ¨¡å¼</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SECRET_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC13131234567890"</span>;<span class="hljs-comment">//å¯†é’¥</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {<br>                <span class="hljs-type">String</span> <span class="hljs-variable">originalMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br>                <span class="hljs-type">byte</span>[] encryptedMessage = encrypt(originalMessage);<br>                System.out.println(<span class="hljs-string">"åŠ å¯†ç»“æœ: "</span> + Base64.getEncoder().encodeToString(encryptedMessage));<br>                <span class="hljs-type">String</span> <span class="hljs-variable">decryptedMessage</span> <span class="hljs-operator">=</span> decrypt(encryptedMessage);<br>                System.out.println(<span class="hljs-string">"è§£å¯†ç»“æœ: "</span> + decryptedMessage);<br>            }<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] encrypt(String message) <span class="hljs-keyword">throws</span> Exception {<br>                <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(SECRET_KEY.getBytes(), ALGORITHM);<br>                <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(TRANSFORMATION);<br>                cipher.init(Cipher.ENCRYPT_MODE, key);<br>                <span class="hljs-keyword">return</span> cipher.doFinal(message.getBytes());<br>            }<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] encryptedMessage)</span> <span class="hljs-keyword">throws</span> Exception {<br>                <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(SECRET_KEY.getBytes(), ALGORITHM);<br>                <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(TRANSFORMATION);cipher.init(Cipher.DECRYPT_MODE, key);<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(cipher.doFinal(encryptedMessage));<br>            }<br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011859051.png"></p><h3 id="2-DESåŠ è§£å¯†"><a href="#2-DESåŠ è§£å¯†" class="headerlink" title="(2)DESåŠ è§£å¯†"></a><strong>(2)DESåŠ è§£å¯†</strong></h3><p>æ˜æ–‡:</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">CC<span class="hljs-number">1313113</span>!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">43N9cLCP1sTHGJRnh62iDw==<br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DES</span> {<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ALGORITHM</span> <span class="hljs-operator">=</span> <span class="hljs-string">"DES"</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TRANSFORMATION</span> <span class="hljs-operator">=</span> <span class="hljs-string">"DES/ECB/PKCS5Padding"</span>;<span class="hljs-comment">//åŠ å¯†æ¨¡å¼</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SECRET_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC123456"</span>;<span class="hljs-comment">//å¯†é’¥</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">originalMessage</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br>        <span class="hljs-type">byte</span>[] encryptedMessage = encrypt(originalMessage);<br>        System.out.println(<span class="hljs-string">"åŠ å¯†ç»“æœ: "</span> + Base64.getEncoder().encodeToString(encryptedMessage));<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decryptedMessage</span> <span class="hljs-operator">=</span> decrypt(encryptedMessage);<br>        System.out.println(<span class="hljs-string">"è§£å¯†ç»“æœ: "</span> + decryptedMessage);<br>    }<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] encrypt(String message) <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(SECRET_KEY.getBytes(), ALGORITHM);<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(TRANSFORMATION);<br>        cipher.init(Cipher.ENCRYPT_MODE, key);<br>        <span class="hljs-keyword">return</span> cipher.doFinal(message.getBytes());<br>    }<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] encryptedMessage)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(SECRET_KEY.getBytes(), ALGORITHM);<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(TRANSFORMATION);<br>        cipher.init(Cipher.DECRYPT_MODE, key);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(cipher.doFinal(encryptedMessage));<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011859372.png"></p><h2 id="3-éå¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#3-éå¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="3.éå¯¹ç§°åŠ å¯†ç®—æ³•"></a><strong>3.éå¯¹ç§°åŠ å¯†ç®—æ³•</strong></h2><p>å®šä¹‰:</p><p>éå¯¹ç§°åŠ å¯†ï¼Œä¹Ÿç§°ä¸ºå…¬é’¥åŠ å¯†ï¼Œä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œè¿™ä¸¤ä¸ªå¯†é’¥æ˜¯ä¸€å¯¹ï¼Œä¸€ä¸ªè¢«ç§°ä¸ºå…¬é’¥ï¼Œä¸€ä¸ªè¢«ç§°ä¸ºç§é’¥ã€‚å…¬é’¥å¯ä»¥éšæ„åˆ†å‘ç»™ä»»ä½•éœ€è¦é€šä¿¡çš„äººï¼Œè€Œç§é’¥åˆ™åªèƒ½ç”±å¯†é’¥æŒæœ‰è€…ä¿ç•™ã€‚åœ¨éå¯¹ç§°åŠ å¯†ä¸­ï¼Œå…¬é’¥ç”¨äºåŠ å¯†æ¶ˆæ¯ï¼Œè€Œç§é’¥ç”¨äºè§£å¯†æ¶ˆæ¯ï¼Œè¿™ä½¿å¾—éå¯¹ç§°åŠ å¯†æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå³ä½¿å…¬é’¥è¢«æ³„éœ²ï¼Œä¹Ÿæ— æ³•ç ´è§£å¯†æ–‡ã€‚</p><p>å¸¸è§çš„éå¯¹ç§°åŠ å¯†:RSA</p><h3 id="RSAåŠ è§£å¯†"><a href="#RSAåŠ è§£å¯†" class="headerlink" title="RSAåŠ è§£å¯†"></a><strong>RSAåŠ è§£å¯†</strong></h3><p>å®šä¹‰:</p><p>RSAæ˜¯æœ€å…·ä»£è¡¨æ€§çš„å…¬é’¥å¯†ç ä½“åˆ¶ã€‚ç”±äºç®—æ³•å®Œå–„ï¼ˆæ—¢å¯ç”¨äºæ•°æ®åŠ å¯†åˆå¯ç”¨äºæ•°å­—ç­¾åï¼‰ã€å®‰å…¨æ€§è‰¯å¥½ã€æ˜“äºå®ç°å’Œç†è§£ï¼ŒRSAå·²æˆä¸ºä¸€ç§åº”ç”¨æå¹¿çš„å…¬é’¥å¯†ç ä½“åˆ¶ï¼Œä¹Ÿæ˜¯ç›®å‰ä¸–ç•Œä¸Šå”¯ä¸€è¢«å¹¿æ³›ä½¿ç”¨çš„å…¬é’¥å¯†ç ã€‚åœ¨å¹¿æ³›çš„åº”ç”¨ä¸­ï¼Œå®ƒä¸ä»…å®ç°æŠ€æœ¯æ—¥è¶‹æˆç†Ÿè€Œä¸”å®‰å…¨æ€§é€æ¸å¾—åˆ°è¯æ˜ã€‚ç”±æ­¤äººä»¬è¶Šå‘å¯¹RSAåçˆ±æœ‰åŠ ï¼Œå¹¶æå‡ºäº†è®¸å¤šåŸºäºRSAçš„åŠ å¼ºæˆ–å˜å½¢å…¬é’¥å¯†ç ä½“åˆ¶ã€‚æ ¹æ®ä¸åŒçš„åº”ç”¨éœ€è¦ï¼Œäººä»¬åŸºäºRSAç®—æ³•å¼€å‘äº†å¤§é‡çš„åŠ å¯†æ–¹æ¡ˆä¸äº§å“ã€‚</p><p><img src="http://pic.rmb.bdstatic.com/bjh/9728127b75870d2592e42699757952d8.png"></p><p><code>PS:RSAå…¬é’¥åŠ å¯†çš„æ¯æ¬¡ç»“æœéƒ½ä¸ä¸€æ ·</code></p><p>æ˜æ–‡:</p><figure class="highlight dns"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">CC<span class="hljs-number">1313113</span>!<br></code></pre></td></tr></tbody></table></figure><p>å¯†æ–‡:</p><figure class="highlight 1c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">HNXogsqfIl4n0e2Tlk7iYi4AfDRD1kVIRBhBUjz0XxYrSqUixrDZ5Oox<span class="hljs-comment">//sYMFwqqsSMPJJ+wXKJywudtDUmIyJi0Ssj9UJr6eEXguqJrEJOQs+x+6qLJXr6A+PJaGjTBa0dgCOwibJl4ZcuvWnKYgM18lTNLviZtDhldvdO03s=</span><br><br></code></pre></td></tr></tbody></table></figure><p>é€»è¾‘å®ç°:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">KEY_ALGORITHM</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RSA"</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PUBLIC_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RSAPublicKey"</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PRIVATE_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RSAPrivateKey"</span>;<br><br>    <span class="hljs-comment">// 1024 bits çš„ RSA å¯†é’¥å¯¹ï¼Œæœ€å¤§åŠ å¯†æ˜æ–‡å¤§å°  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_ENCRYPT_BLOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">117</span>;<br><br>    <span class="hljs-comment">// 1024 bits çš„ RSA å¯†é’¥å¯¹ï¼Œæœ€å¤§è§£å¯†å¯†æ–‡å¤§å°  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_DECRYPT_BLOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">128</span>;<br><br>    <span class="hljs-comment">// ç”Ÿæˆå¯†é’¥å¯¹  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title function_">initKey</span><span class="hljs-params">(<span class="hljs-type">int</span> keysize)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-type">KeyPairGenerator</span> <span class="hljs-variable">keyPairGen</span> <span class="hljs-operator">=</span> KeyPairGenerator.getInstance(KEY_ALGORITHM);<br>        <span class="hljs-comment">// è®¾ç½®å¯†é’¥å¯¹çš„ bit æ•°ï¼Œè¶Šå¤§è¶Šå®‰å…¨  </span><br>        keyPairGen.initialize(keysize);<br>        <span class="hljs-type">KeyPair</span> <span class="hljs-variable">keyPair</span> <span class="hljs-operator">=</span> keyPairGen.generateKeyPair();<br><br>        <span class="hljs-comment">// è·å–å…¬é’¥  </span><br>        <span class="hljs-type">RSAPublicKey</span> <span class="hljs-variable">publicKey</span> <span class="hljs-operator">=</span> (RSAPublicKey) keyPair.getPublic();<br>        <span class="hljs-comment">// è·å–ç§é’¥  </span><br>        <span class="hljs-type">RSAPrivateKey</span> <span class="hljs-variable">privateKey</span> <span class="hljs-operator">=</span> (RSAPrivateKey) keyPair.getPrivate();<br>        Map&lt;String, Object&gt; keyMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(<span class="hljs-number">2</span>);<br>        keyMap.put(PUBLIC_KEY, publicKey);<br>        keyMap.put(PRIVATE_KEY, privateKey);<br>        <span class="hljs-keyword">return</span> keyMap;<br>    }<br><br>    <span class="hljs-comment">// è·å–å…¬é’¥å­—ç¬¦ä¸²  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getPublicKeyStr</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span> {<br>        <span class="hljs-comment">// è·å¾— map ä¸­çš„å…¬é’¥å¯¹è±¡ï¼Œè½¬ä¸º key å¯¹è±¡  </span><br>        <span class="hljs-type">Key</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> (Key) keyMap.get(PUBLIC_KEY);<br>        <span class="hljs-comment">// ç¼–ç è¿”å›å­—ç¬¦ä¸²  </span><br>        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());<br>    }<br><br>    <span class="hljs-comment">// è·å–ç§é’¥å­—ç¬¦ä¸²  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getPrivateKeyStr</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span> {<br>        <span class="hljs-comment">// è·å¾— map ä¸­çš„ç§é’¥å¯¹è±¡ï¼Œè½¬ä¸º key å¯¹è±¡  </span><br>        <span class="hljs-type">Key</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> (Key) keyMap.get(PRIVATE_KEY);<br>        <span class="hljs-comment">// ç¼–ç è¿”å›å­—ç¬¦ä¸²  </span><br>        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());<br>    }<br><br>    <span class="hljs-comment">// è·å–å…¬é’¥  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PublicKey <span class="hljs-title function_">getPublicKey</span><span class="hljs-params">(String publicKeyString)</span> <span class="hljs-keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException {<br>        <span class="hljs-type">byte</span>[] publicKeyByte = Base64.getDecoder().decode(publicKeyString);<br>        <span class="hljs-type">X509EncodedKeySpec</span> <span class="hljs-variable">keySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">X509EncodedKeySpec</span>(publicKeyByte);<br>        <span class="hljs-type">KeyFactory</span> <span class="hljs-variable">keyFactory</span> <span class="hljs-operator">=</span> KeyFactory.getInstance(KEY_ALGORITHM);<br>        <span class="hljs-keyword">return</span> keyFactory.generatePublic(keySpec);<br>    }<br><br>    <span class="hljs-comment">// è·å–ç§é’¥  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PrivateKey <span class="hljs-title function_">getPrivateKey</span><span class="hljs-params">(String privateKeyString)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-type">byte</span>[] privateKeyByte = Base64.getDecoder().decode(privateKeyString);<br>        <span class="hljs-type">PKCS8EncodedKeySpec</span> <span class="hljs-variable">keySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PKCS8EncodedKeySpec</span>(privateKeyByte);<br>        <span class="hljs-type">KeyFactory</span> <span class="hljs-variable">keyFactory</span> <span class="hljs-operator">=</span> KeyFactory.getInstance(KEY_ALGORITHM);<br>        <span class="hljs-keyword">return</span> keyFactory.generatePrivate(keySpec);<br>    }<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * BASE64 ç¼–ç è¿”å›åŠ å¯†å­—ç¬¦ä¸²  </span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Param</span> key éœ€è¦ç¼–ç çš„å­—èŠ‚æ•°ç»„  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Return</span> ç¼–ç åçš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">encryptBASE64</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] key)</span> {<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Base64.getEncoder().encode(key));<br>    }<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * BASE64 è§£ç ï¼Œè¿”å›å­—èŠ‚æ•°ç»„  </span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Param</span> key å¾…è§£ç çš„å­—ç¬¦ä¸²  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Return</span> è§£ç åçš„å­—èŠ‚æ•°ç»„</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] decryptBASE64(String key) {<br>        <span class="hljs-keyword">return</span> Base64.getDecoder().decode(key);<br>    }<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å…¬é’¥åŠ å¯†  </span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Param</span> text         å¾…åŠ å¯†çš„æ˜æ–‡å­—ç¬¦ä¸²  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> publicKeyStr å…¬é’¥  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Return</span> åŠ å¯†åçš„å¯†æ–‡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">encrypt1</span><span class="hljs-params">(String text, String publicKeyStr)</span> {<br>        <span class="hljs-keyword">try</span> {<br><br>            System.out.println(<span class="hljs-string">"æ˜æ–‡å­—ç¬¦ä¸²ä¸º:"</span>+text);<br>            <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(KEY_ALGORITHM);<br>            cipher.init(Cipher.ENCRYPT_MODE, getPublicKey(publicKeyStr));<br>            <span class="hljs-type">byte</span>[] tempBytes = cipher.doFinal(text.getBytes(<span class="hljs-string">"UTF-8"</span>));<br>            <span class="hljs-keyword">return</span> Base64.getEncoder().encodeToString(tempBytes);<br>        } <span class="hljs-keyword">catch</span> (Exception e) {<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åŠ å¯†å­—ç¬¦ä¸²["</span> + text + <span class="hljs-string">"]æ—¶é‡åˆ°å¼‚å¸¸"</span>, e);<br>        }<br>    }<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç§é’¥è§£å¯†  </span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> secretText    å¾…è§£å¯†çš„å¯†æ–‡å­—ç¬¦ä¸²  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> privateKeyStr ç§é’¥  </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è§£å¯†åçš„æ˜æ–‡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decrypt1</span><span class="hljs-params">(String secretText, String privateKeyStr)</span> {<br>        <span class="hljs-keyword">try</span> {<br>            <span class="hljs-comment">// ç”Ÿæˆç§é’¥  </span><br>            <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(KEY_ALGORITHM);<br>            cipher.init(Cipher.DECRYPT_MODE, getPrivateKey(privateKeyStr));<br>            <span class="hljs-comment">// å¯†æ–‡è§£ç   </span><br>            <span class="hljs-type">byte</span>[] secretTextDecoded = Base64.getDecoder().decode(secretText.getBytes(<span class="hljs-string">"UTF-8"</span>));<br>            <span class="hljs-type">byte</span>[] tempBytes = cipher.doFinal(secretTextDecoded);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(tempBytes);<br>        } <span class="hljs-keyword">catch</span> (Exception e) {<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è§£å¯†å­—ç¬¦ä¸²["</span> + secretText + <span class="hljs-string">"]æ—¶é‡åˆ°å¼‚å¸¸"</span>, e);<br>        }<br>    }<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {<br>        Map&lt;String, Object&gt; keyMap;<br>        String cipherText;<br>        <span class="hljs-comment">// åŸå§‹æ˜æ–‡  </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">"CC1313113!"</span>;<br><br>        <span class="hljs-comment">// ç”Ÿæˆå¯†é’¥å¯¹  </span><br>        keyMap = initKey(<span class="hljs-number">1024</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">publicKey</span> <span class="hljs-operator">=</span> getPublicKeyStr(keyMap);<br>        System.out.println(<span class="hljs-string">"å…¬é’¥:"</span>+publicKey);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">privateKey</span> <span class="hljs-operator">=</span> getPrivateKeyStr(keyMap);<br>        System.out.println(<span class="hljs-string">"ç§é’¥:"</span>+privateKey);<br><br>        <span class="hljs-comment">// åŠ å¯†  </span><br>        cipherText = encrypt1(content, publicKey);<br>        System.out.println(<span class="hljs-string">"åŠ å¯†åçš„å¯†æ–‡:"</span>+cipherText);<br><br>        <span class="hljs-comment">// è§£å¯†  </span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">plainText</span> <span class="hljs-operator">=</span> decrypt1(cipherText, privateKey);<br>        System.out.println(<span class="hljs-string">"è§£å¯†åæ˜æ–‡:"</span>+plainText);<br>    }<br><br>}<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011859239.png"></p><p>RSAæ¯ä¸€æ¬¡è·‘å‡ºæ¥çš„å¯†æ–‡ç»“æœéƒ½ä¸ç›¸åŒ</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011859230.png"></p><p>æ€»çš„æ¥è¯´ï¼Œéå¯¹ç§°åŠ å¯†æ¯”å¯¹ç§°åŠ å¯†æ›´åŠ å®‰å…¨ï¼Œä½†åŒæ—¶ä¹Ÿæ›´åŠ è®¡ç®—å¯†é›†å’Œå¤æ‚ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥é€‰æ‹©åˆé€‚çš„åŠ å¯†æ–¹å¼ã€‚å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†æ•°æ®ï¼Œç„¶åä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨çš„å¯†é’¥ï¼Œè¿™æ ·æ—¢ä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ï¼Œåˆé¿å…äº†éå¯¹ç§°åŠ å¯†ç®—æ³•çš„èµ„æºæ¶ˆè€—ã€‚</p><h2 id="4-ç®—æ³•è‡ªå"><a href="#4-ç®—æ³•è‡ªå" class="headerlink" title="4.ç®—æ³•è‡ªå"></a>4.ç®—æ³•è‡ªå</h2><ul><li><p>ç®—æ³•åŠ©æ‰‹ä½¿ç”¨ç¤ºä¾‹</p><p>  è¿ç”¨äº†ç³»ç»ŸåŠ è§£å¯†åŒ…çš„è¯å¯ä»¥é€šè¿‡Hookç³»ç»Ÿçš„è¿™äº›åŠ è§£å¯†åº“æ¥è·å–å®ƒçš„æ˜æ–‡ä»¥åŠå¯†é’¥ã€‚</p><ol><li>å°†ç®—æ³•åŠ©æ‰‹æ‰“å¼€é€‰æ‹©åˆ†æçš„ç®—æ³•</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011859011.png"></p><ol><li>é‡æ–°è¿è¡Œåå°†ç®—æ³•éƒ½è¿›è¡Œè§¦å‘</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011900676.png"></p><ol><li>æˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¿—ä¸­å‘ç°Hookåˆ°çš„é€šè¿‡ç³»ç»ŸåŠ è§£å¯†åº“çš„ä¿¡æ¯</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011900692.png"></p><ol><li>é€šè¿‡ç®—æ³•åŠ©æ‰‹ä¸­çš„åŠ å¯†ä¿¡æ¯ä»¥åŠ<a href="https://gchq.github.io/CyberChef/">CyberChef</a>ç½‘ç«™æ¥å®ç°ä¸€ä¸‹ç®—æ³•</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011900744.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202504011900806.png"></p></li></ul><h2 id="4-éæ ‡å‡†åŠ å¯†ç®—æ³•"><a href="#4-éæ ‡å‡†åŠ å¯†ç®—æ³•" class="headerlink" title="4.éæ ‡å‡†åŠ å¯†ç®—æ³•"></a><strong>4.éæ ‡å‡†åŠ å¯†ç®—æ³•</strong></h2><p>é‡åˆ°ä¸æ˜¯å¸¸è§„çš„åŠ å¯†æ€ä¹ˆåŠï¼Ÿ</p><p>æ–¹æ³•ä¸€:ä¸»åŠ¨è°ƒç”¨</p><p>æ–¹æ³•äºŒ:æ‰£ç®—æ³•</p><p>æ–¹æ³•ä¸‰:é—®é—®ç¥å¥‡çš„ChatGPT</p><p>æ¨èä¹¦ç›®:</p><p><a href="https://book.douban.com/subject/30288807/">åŠ å¯†ä¸è§£å¯†ï¼ˆç¬¬4ç‰ˆï¼‰</a></p><p><a href="https://book.douban.com/subject/25861566/">JavaåŠ å¯†ä¸è§£å¯†çš„è‰ºæœ¯(ç¬¬2ç‰ˆ)</a></p><p><a href="https://book.douban.com/subject/35662338/">å¯†ç å­¦åŸç†ä¸Javaå®ç°</a></p><p>æ–‡æ¡£:</p><p><a href="https://www.52pojie.cn/thread-1729095-1-1.html">å®‰å“é€†å‘ä¸­å…³äºå¯†ç å­¦ã€NDKå¼€å‘ï¼ˆJNIè°ƒç”¨ï¼‰ä»¥åŠJavaå±‚é€†å‘åŸºç¡€çŸ¥è¯†æ€ç»´å¯¼å›¾</a></p><p><a href="https://book.douban.com/subject/35662338/">å¯†ç å­¦åŸç†ä¸Javaå®ç°</a></p><p><a href="https://blog.csdn.net/Oliver_xpl/article/details/90214896">MD5åŠ å¯†æ¦‚è¿°ï¼ŒåŸç†åŠå®ç°</a></p><p><a href="https://blog.csdn.net/piaoranyuji/article/details/126140261">RSA åŠ è§£å¯†ï¼ˆJava å®ç°ï¼‰</a></p><p><a href="https://blog.csdn.net/lemon_tree12138/article/details/50696926">å¯†ç å­¦ï¼šRSAåŠ å¯†ç®—æ³•è¯¦è§£</a></p>]]></content>
    
    
    <categories>
      
      <category>å¯†ç å­¦åŸºç¡€</category>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RSA</tag>
      
      <tag>DES</tag>
      
      <tag>AES</tag>
      
      <tag>Base64</tag>
      
      <tag>ç®—æ³•åŠ©æ‰‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Xposdæ¨¡å—ç¼–å†™ï¼ŒAPIè¯¦è§£</title>
    <link href="/2025/03/26/ZJ7,8/Xposd%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%EF%BC%8CAPI%E8%AF%A6%E8%A7%A3%201baa6f4b4daf802c9edfdb04c625b4b5/"/>
    <url>/2025/03/26/ZJ7,8/Xposd%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%EF%BC%8CAPI%E8%AF%A6%E8%A7%A3%201baa6f4b4daf802c9edfdb04c625b4b5/</url>
    
    <content type="html"><![CDATA[<h1 id="Xposdæ¨¡å—ç¼–å†™ï¼ŒAPIè¯¦è§£"><a href="#Xposdæ¨¡å—ç¼–å†™ï¼ŒAPIè¯¦è§£" class="headerlink" title="Xposdæ¨¡å—ç¼–å†™ï¼ŒAPIè¯¦è§£"></a>Xposdæ¨¡å—ç¼–å†™ï¼ŒAPIè¯¦è§£</h1><h2 id="1-ä»€ä¹ˆæ˜¯Xposedï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯Xposedï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯Xposedï¼Ÿ"></a><strong>1.ä»€ä¹ˆæ˜¯Xposedï¼Ÿ</strong></h2><p>Xposedæ˜¯ä¸€æ¬¾å¯ä»¥åœ¨ä¸ä¿®æ”¹APKçš„æƒ…å†µä¸‹å½±å“ç¨‹åºè¿è¡Œçš„æ¡†æ¶ï¼ŒåŸºäºå®ƒå¯ä»¥åˆ¶ä½œå‡ºè®¸å¤šåŠŸèƒ½å¼ºå¤§çš„æ¨¡å—ï¼Œä¸”åœ¨åŠŸèƒ½ä¸å†²çªçš„æƒ…å†µä¸‹åŒæ—¶è¿ä½œã€‚åœ¨è¿™ä¸ªæ¡†æ¶ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¹¶åŠ è½½è‡ªå·±ç¼–å†™çš„æ’ä»¶APPï¼Œå®ç°å¯¹ç›®æ ‡apkçš„æ³¨å…¥æ‹¦æˆªç­‰ã€‚</p><ul><li>æ ¸å¿ƒåŠŸèƒ½<ol><li><strong>åŠ¨æ€Hook</strong>ï¼šæ— éœ€ä¿®æ”¹APKå³å¯æ‹¦æˆªå’Œä¿®æ”¹ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œé€»è¾‘ï¼Œä¾‹å¦‚æ”¹å˜è¿”å›å€¼ã€æ’å…¥ä»£ç ç­‰38ã€‚</li><li><strong>æ¨¡å—åŒ–æ‰©å±•</strong>ï¼šå¼€å‘è€…å¯é€šè¿‡ç¼–å†™æ¨¡å—ï¼ˆModuleï¼‰å®ç°åŠŸèƒ½æ‰©å±•ï¼Œæ¨¡å—é—´ç›¸äº’ç‹¬ç«‹ä¸”å¯åŒæ—¶è¿è¡Œ46ã€‚</li><li><strong>ç³»ç»Ÿçº§æ§åˆ¶</strong>ï¼šèƒ½å¤Ÿå¹²é¢„ç³»ç»Ÿæ ¸å¿ƒè¿›ç¨‹ï¼ˆå¦‚Zygoteï¼‰ï¼Œå½±å“æ‰€æœ‰åº”ç”¨çš„è¿è¡Œç¯å¢ƒ</li></ol></li></ul><h2 id="2-XposedåŸç†"><a href="#2-XposedåŸç†" class="headerlink" title="2.XposedåŸç†"></a><strong>2.XposedåŸç†</strong></h2><p>ç”¨è‡ªå·±å®ç°çš„<strong>app_process</strong>æ›¿æ¢æ‰äº†ç³»ç»ŸåŸæœ¬æä¾›çš„<strong>app_process</strong>ï¼ŒåŠ è½½ä¸€ä¸ªé¢å¤–çš„jaråŒ…ï¼Œå…¥å£ä»åŸæ¥çš„ï¼š&nbsp;&nbsp;<strong>com.android.internal.osZygoteInit.main()è¢«æ›¿æ¢æˆäº†ï¼š&nbsp;&nbsp;de.robv.android.xposed.XposedBridge.main()</strong>ï¼Œ</p><p>åˆ›å»ºçš„Zygoteè¿›ç¨‹å°±å˜æˆHookçš„Zygoteè¿›ç¨‹äº†ï¼Œä»è€Œå®Œæˆå¯¹zygoteè¿›ç¨‹åŠå…¶åˆ›å»ºçš„Dalvik/ARTè™šæ‹Ÿæœºçš„åŠ«æŒ(zytogeæ³¨å…¥)</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262059416.png"></p><ul><li><p>æ–‡å­—è§£é‡Š</p><h3 id="1-åŠ«æŒZygoteè¿›ç¨‹"><a href="#1-åŠ«æŒZygoteè¿›ç¨‹" class="headerlink" title="(1) åŠ«æŒZygoteè¿›ç¨‹"></a><strong>(1) åŠ«æŒZygoteè¿›ç¨‹</strong></h3><ul><li><strong>Zygoteçš„ä½œç”¨</strong>ï¼šAndroidç³»ç»Ÿä¸­æ‰€æœ‰åº”ç”¨è¿›ç¨‹å‡ç”±Zygoteè¿›ç¨‹å­µåŒ–è€Œæ¥ã€‚Xposedé€šè¿‡æ›¿æ¢ç³»ç»Ÿæ–‡ä»¶<code>/system/bin/app_process</code>ï¼Œåœ¨Zygoteå¯åŠ¨æ—¶åŠ è½½è‡ªå®šä¹‰çš„<code>XposedBridge.jar</code>ï¼Œä»è€Œæ¥ç®¡Zygoteçš„åˆå§‹åŒ–æµç¨‹ã€‚</li><li><strong>æ³¨å…¥é€»è¾‘</strong>ï¼šä¿®æ”¹åçš„<code>app_process</code>ä¼šä¼˜å…ˆæ‰§è¡Œ<code>XposedBridge.main()</code>ï¼Œè€ŒéåŸç”Ÿçš„<code>ZygoteInit.main()</code>ã€‚æ­¤æ—¶ï¼ŒXposedæ¡†æ¶å®ŒæˆHookæœºåˆ¶çš„åˆå§‹åŒ–ï¼Œå¹¶åŠ è½½æ‰€æœ‰å¯ç”¨çš„æ¨¡å—ã€‚</li></ul><h3 id="2-Hookæœºåˆ¶å®ç°"><a href="#2-Hookæœºåˆ¶å®ç°" class="headerlink" title="(2) Hookæœºåˆ¶å®ç°"></a><strong>(2) Hookæœºåˆ¶å®ç°</strong></h3><ul><li><strong>æ–¹æ³•æ›¿æ¢</strong>ï¼šXposedå°†ç›®æ ‡Javaæ–¹æ³•æ ‡è®°ä¸ºNativeæ–¹æ³•ï¼Œå¹¶å°†å…¶å®ç°æŒ‡å‘è‡ªå®šä¹‰çš„<code>xposedCallHandler</code>å‡½æ•°ã€‚å½“æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ§åˆ¶æƒä¼šè½¬ç§»åˆ°Xposedæ¡†æ¶ï¼Œæ‰§è¡Œæ¨¡å—ä¸­å®šä¹‰çš„<code>beforeHookedMethod</code>å’Œ<code>afterHookedMethod</code>å›è°ƒ89ã€‚</li><li><strong>å›è°ƒé“¾ç®¡ç†</strong>ï¼šè‹¥å¤šä¸ªæ¨¡å—HookåŒä¸€æ–¹æ³•ï¼ŒXposedä¼šæ ¹æ®ä¼˜å…ˆçº§æ’åºæ‰§è¡Œå›è°ƒï¼Œé¡ºåºä¸ºï¼š<code>A.before â†’ B.before â†’ åŸæ–¹æ³• â†’ B.after â†’ A.after</code>ã€‚</li></ul><h3 id="3-æ¨¡å—åŠ è½½ä¸æ‰§è¡Œ"><a href="#3-æ¨¡å—åŠ è½½ä¸æ‰§è¡Œ" class="headerlink" title="(3) æ¨¡å—åŠ è½½ä¸æ‰§è¡Œ"></a><strong>(3) æ¨¡å—åŠ è½½ä¸æ‰§è¡Œ</strong></h3><ul><li><strong>æ¨¡å—å…¥å£</strong>ï¼šæ¯ä¸ªXposedæ¨¡å—éœ€åœ¨<code>AndroidManifest.xml</code>ä¸­å£°æ˜<code>xposedmodule</code>å…ƒæ•°æ®ï¼Œå¹¶é€šè¿‡<code>xposed_init</code>æ–‡ä»¶æŒ‡å®šå…¥å£ç±»ã€‚æ¡†æ¶åœ¨Zygoteå¯åŠ¨æ—¶åŠ è½½è¿™äº›æ¨¡å—ï¼Œå¹¶åœ¨ç›®æ ‡åº”ç”¨å¯åŠ¨æ—¶è§¦å‘Hooké€»è¾‘34ã€‚</li><li><strong>APIæ”¯æŒ</strong>ï¼šé€šè¿‡<code>XposedHelpers</code>å’Œ<code>XposedBridge</code>ç­‰å·¥å…·ç±»ï¼Œå¼€å‘è€…å¯ä¾¿æ·åœ°å®šä½ç›®æ ‡ç±»ä¸æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨<code>findAndHookMethod</code>å®ç°æ–¹æ³•æ‹¦æˆªã€‚</li></ul></li></ul><h3 id="3-Xposedçš„å‘å±•åŠå…rootæ¡†æ¶"><a href="#3-Xposedçš„å‘å±•åŠå…rootæ¡†æ¶" class="headerlink" title="3.Xposedçš„å‘å±•åŠå…rootæ¡†æ¶"></a><strong>3.Xposedçš„å‘å±•åŠå…rootæ¡†æ¶</strong></h3><table><thead><tr><th><strong>åç§°</strong></th><th><strong>åœ°å€</strong></th><th><strong>æ”¯æŒç‰ˆæœ¬</strong></th><th><strong>æ˜¯å¦å…root</strong></th></tr></thead><tbody><tr><td>xposed</td><td><a href="https://github.com/rovo89/Xposed">https://github.com/rovo89/Xposed</a></td><td>2.3-8.1</td><td>å¦</td></tr><tr><td>EDXposed</td><td><a href="https://github.com/ElderDrivers/EdXposed">https://github.com/ElderDrivers/EdXposed</a></td><td>8.0-10</td><td>å¦</td></tr><tr><td>LSPosed</td><td><a href="https://github.com/LSPosed/LSPosed">https://github.com/LSPosed/LSPosed</a></td><td>8.1-13</td><td>å¦</td></tr><tr><td>VirtualXposed</td><td><a href="https://github.com/android-hacker/VirtualXposed">https://github.com/android-hacker/VirtualXposed</a></td><td>5.0-10.0</td><td>æ˜¯</td></tr><tr><td>å¤ªæ</td><td><a href="https://www.coolapk.com/apk/me.weishu.exp">https://www.coolapk.com/apk/me.weishu.exp</a></td><td>5.0-13</td><td>æ˜¯</td></tr><tr><td>ä¸¤ä»ª</td><td><a href="https://www.coolapk.com/apk/io.twoyi">https://www.coolapk.com/apk/io.twoyi</a></td><td>8.1-13</td><td>æ˜¯</td></tr><tr><td>å¤©é‰´</td><td><a href="https://github.com/Katana-Official/SPatch-Update">https://github.com/Katana-Official/SPatch-Update</a></td><td>6-10</td><td>æ˜¯</td></tr></tbody></table><h3 id="4-Xposedå¯ä»¥åšä»€ä¹ˆï¼Ÿ"><a href="#4-Xposedå¯ä»¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="4.Xposedå¯ä»¥åšä»€ä¹ˆï¼Ÿ"></a><strong>4.Xposedå¯ä»¥åšä»€ä¹ˆï¼Ÿ</strong></h3><p>1.ä¿®æ”¹appå¸ƒå±€:<a href="https://github.com/kaisar945/Xposed-GodMode">ä¸Šå¸æ¨¡å¼</a></p><p>2.åŠ«æŒæ•°æ®ï¼Œä¿®æ”¹å‚æ•°å€¼ã€è¿”å›å€¼ã€ä¸»åŠ¨è°ƒç”¨ç­‰ã€‚ä¾‹:å¾®ä¿¡é˜²æ’¤å›ã€æ­¥æ•°ä¿®æ”¹ã€ä¸€é”®æ–°æœº</p><p><a href="https://github.com/kingsollyu/AppEnv">åº”ç”¨å˜é‡</a></p><p>3.è‡ªåŠ¨åŒ–æ“ä½œï¼Œä¾‹:å¾®ä¿¡æŠ¢çº¢åŒ…</p><p>å­¦ä¹ é¡¹ç›®:</p><p><a href="https://www.xda-developers.com/best-xposed-modules/">2022 æœ€å¥½çš„Xposedæ¨¡å—: GravityBox, Pixelify, XPrivacyLua</a></p><p><a href="https://github.com/Lstaynight/xposed-dy">åŸºäºXposedçš„æŠ–éŸ³çˆ¬è™«ï¼ŒæŠ–éŸ³é£æ§åè‡ªåŠ¨ä¸€é”®æ–°æœºï¼Œæ¨¡æ‹Ÿä¸€ä¸ªå…¨æ–°çš„è¿è¡Œç¯å¢ƒ</a></p><p><a href="https://github.com/svengong/xcubebase">åŸºäºxposedçš„fridaæŒä¹…åŒ–æ–¹æ¡ˆ</a></p><p><a href="https://github.com/monkeylord/XServer">A Xposed Module for Android Penetration Test, with NanoHttpd.</a></p><p><a href="https://github.com/GravityBox/GravityBox">GravityBox</a></p><p><a href="https://github.com/Xposed-Modules-Repo">Xposed-Modules-Repo</a></p><p><a href="https://github.com/ferredoxin/QNotified">ä¸€ä¸ªæ—¨åœ¨ä½¿QQå˜å¾—æ›´å¥½ç”¨çš„å¼€æºXposedæ¨¡å—</a></p><p><a href="https://github.com/nining377/dolby_beta">æœæ¯”å¤§å–‡å­</a></p><p><a href="https://github.com/shatyuka/Zhiliao">çŸ¥ä¹å»å¹¿å‘ŠXposedæ¨¡å—</a></p><p><a href="https://github.com/yujincheng08/BiliRoaming">å“”å“©æ¼«æ¸¸</a></p><p><a href="https://github.com/Mocha-L/QuJing">æ›²å¢ƒ</a></p><p><a href="https://github.com/monkeylord/XposedTemplateForAS">è‡ªåŠ¨åŒ–åˆ›å»ºXposedæ¨¡å—åŠé’©å­ï¼Œè®©Xposedæ¨¡å—ç¼–å†™æ—¶åªéœ€å…³æ³¨é’©å­å®ç°</a></p><h3 id="5-Xposedç¯å¢ƒé…ç½®"><a href="#5-Xposedç¯å¢ƒé…ç½®" class="headerlink" title="5.Xposedç¯å¢ƒé…ç½®"></a><strong>5.Xposedç¯å¢ƒé…ç½®</strong></h3><h3 id="å‰ç½®"><a href="#å‰ç½®" class="headerlink" title="å‰ç½®"></a><strong>å‰ç½®</strong></h3><p>ubuntuè™šæ‹Ÿæœºé•œåƒï¼Œæ„Ÿè°¢æ²é˜³å“¥æä¾›çš„é•œåƒï¼ï¼ï¼</p><p>å†…ç½®:</p><ul><li><code>Frida</code>å¼€å‘ç¯å¢ƒ</li><li>åŠ¨æ€åˆ†æåŠå¼€å‘å·¥å…·ï¼šandroid-studio</li><li>åŠ¨æ€åˆ†æå·¥å…·ï¼šddms</li><li>é™æ€åˆ†æå·¥å…·ï¼šjadx1.4.4</li><li>åŠ¨é™æ€åˆ†æå·¥å…·ï¼šjeb</li><li>åŠ¨æ€åˆ†æå·¥å…·ï¼šé›†æˆHyperPwn</li><li>é™æ€åˆ†æå·¥å…·ï¼š010 editor</li><li>æŠ“åŒ…å·¥å…·ï¼šCharles</li><li>æŠ“åŒ…å·¥å…·ï¼šWireShark</li><li>åŠ¨æ€åˆ†æå·¥å…·:unidbg</li></ul><p>vmè™šæ‹Ÿæœºï¼š<a href="https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html">https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html</a></p><p>(æˆ–ä¸‹è½½æˆ‘æ‰“åŒ…å¥½çš„)</p><p>æ¿€æ´»ç è‡ªè¡Œç™¾åº¦å“¦</p><p>ç¬¬ä¸€æ­¥ï¼Œå®‰è£…è™šæ‹Ÿæœºè°ƒæ•´è·¯å¾„ï¼Œè¾“å…¥æ¿€æ´»ç </p><p>ç¬¬äºŒæ­¥ï¼Œå¯¼å…¥é•œåƒï¼Œæ–‡ä»¶-&gt;æ‰“å¼€-&gt;é€‰æ‹©è§£å‹å¥½çš„é•œåƒ</p><p>ç¬¬ä¸‰æ­¥ï¼Œç‚¹å‡»è¿è¡Œï¼Œå¾…åˆå§‹åŒ–ï¼Œè¾“å…¥å¯†ç :toor</p><hr><p>1.Android Studioåˆ›å»ºæ–°é¡¹ç›®</p><p>2.å°†ä¸‹è½½çš„xposedBridgeApi.jaråŒ…æ‹–è¿›libsæ–‡ä»¶å¤¹</p><p>3.å³å‡»jaråŒ…ï¼Œé€‰æ‹©add as library</p><ul><li><p>4.ä¿®æ”¹xmlæ–‡ä»¶é…ç½®</p>  <figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- æ˜¯å¦æ˜¯xposedæ¨¡å—ï¼Œxposedæ ¹æ®è¿™ä¸ªæ¥åˆ¤æ–­æ˜¯å¦æ˜¯æ¨¡å— --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:name</span>=<span class="hljs-string">"xposedmodule"</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:value</span>=<span class="hljs-string">"true"</span> /&gt;</span><br><span class="hljs-comment">&lt;!-- æ¨¡å—æè¿°ï¼Œæ˜¾ç¤ºåœ¨xposedæ¨¡å—åˆ—è¡¨é‚£é‡Œç¬¬äºŒè¡Œ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:name</span>=<span class="hljs-string">"xposeddescription"</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:value</span>=<span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªXposedæ¨¡å—"</span> /&gt;</span><br><span class="hljs-comment">&lt;!-- æœ€ä½xposedç‰ˆæœ¬å·(libæ–‡ä»¶åå¯çŸ¥) --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:name</span>=<span class="hljs-string">"xposedminversion"</span></span><br><span class="hljs-tag">&nbsp; &nbsp; <span class="hljs-attr">android:value</span>=<span class="hljs-string">"89"</span> /&gt;</span><br></code></pre></td></tr></tbody></table></figure><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262059490.png"></p></li><li><p>5.ä¿®æ”¹build.gradle,å°†æ­¤å¤„ä¿®æ”¹ä¸ºcompileOnly é»˜è®¤çš„æ˜¯implementation</p>  <figure class="highlight clean"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs clean">**<span class="hljs-keyword">implementation</span> ä½¿ç”¨è¯¥æ–¹å¼ä¾èµ–çš„åº“å°†ä¼šå‚ä¸ç¼–è¯‘å’Œæ‰“åŒ…<br>compileOnly åªåœ¨ç¼–è¯‘æ—¶æœ‰æ•ˆï¼Œä¸ä¼šå‚ä¸æ‰“åŒ…**<br></code></pre></td></tr></tbody></table></figure><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262059812.png"></p></li><li><p>6.æ–°å»ºâ€“&gt;Folderâ€“&gt;Assets Folderï¼Œåˆ›å»ºxposed_init(ä¸è¦åç¼€å):åªæœ‰ä¸€è¡Œä»£ç ï¼Œå°±æ˜¯è¯´æ˜å…¥å£ç±»</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100155.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100156.png"></p><p>  è¿™é‡Œç”¨æ¥å¡«å†™æˆ‘ä»¬å…·ä½“çš„hookå…¥å£ï¼Œå…ˆå»ºä¸€ä¸ªhookæ–‡æ¡£ã€‚æ ¹æ®æ–°å»ºçš„Hookæ–‡æ¡£æ¥å£°æ˜å…¥å£</p><p>  <code>com.cc.xoseddemo1.Hook</code></p></li><li><p>7.æ–°å»ºHookç±»ï¼Œå®ç°IXposedHookLoadPackageæ¥å£ï¼Œç„¶ååœ¨handleLoadPackageå‡½æ•°å†…ç¼–å†™Hooké€»è¾‘</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100386.png"></p><p>  ç»§æ‰¿äº†IXposedHookLoadPackagä¾¿æ‹¥æœ‰äº†hookçš„èƒ½åŠ›</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;<br><span class="hljs-keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hook</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IXposedHookLoadPackage</span> {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleLoadPackage</span><span class="hljs-params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="hljs-keyword">throws</span> Throwable {<br><br>&nbsp; &nbsp; }<br>}<br></code></pre></td></tr></tbody></table></figure><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100074.png"></p></li></ul><h2 id="6-Xpoosedå¸¸ç”¨API"><a href="#6-Xpoosedå¸¸ç”¨API" class="headerlink" title="6.Xpoosedå¸¸ç”¨API"></a><strong>6.Xpoosedå¸¸ç”¨API</strong></h2><p><a href="https://github.com/fankes/YukiHookAPI">An efficient Hook API and Xposed Module solution built in Kotlin</a></p><ul><li><p>ç¤ºä¾‹</p><ol><li>ä½¿ç”¨logcatå¯¹æ—¥å¿—è¿›è¡Œæ•æ‰è¿‡æ»¤</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100371.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262100372.png"></p><ol><li>æ‰¾åˆ°æˆ‘ä»¬è¦Hookçš„æ™®é€šæ–¹æ³•ï¼Œå‘ç°ä¼ å…¥äº†aï¼Œæˆ‘ä»¬å¯¹aè¿›è¡ŒHook</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262101405.png"></p><ol><li>åœ¨hookä¹‹å‰éœ€è¦å…ˆåšä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœç›´æ¥è¿›è¡Œæ‰“åŒ…çš„è¯ï¼Œä¼šHookæ‰‹æœºä¸­çš„æ‰€æœ‰åº”ç”¨ï¼Œæˆ‘ä»¬é€šè¿‡åŒ…åè¿›è¡Œè¿‡æ»¤</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262101120.png"></p><ol><li>å°†ç¬¬2æ­¥å¤åˆ¶çš„xposedç‰‡æ®µå¤åˆ¶è¿›å»ï¼Œåˆ©ç”¨å¿«æ·é”®è¿›è¡Œå¯¼åŒ…ï¼Œå®ŒæˆHookè¯¥å‡½æ•°æ–¹æ³•çš„åŸºæœ¬æ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ–¹æ³•å‰åçš„ä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262101716.png"></p><ol><li>ä¿®æ”¹ä¼ å…¥çš„å‚æ•°å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ—¥å¿—è¾“å‡ºï¼ˆå¯ä»¥åœ¨lspè½¯ä»¶ä¸­çš„æ—¥å¿—é‡ŒæŸ¥çœ‹ï¼‰çš„æ–¹å¼éªŒè¯ä¸€ä¸‹å‡½æ•°ï¼ˆç”¨XPè‡ªå¸¦çš„APIï¼‰</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262101026.png"></p><ul><li><p>è¯­æ³•è§£æ</p><h3 id="ä¸€ã€ä»£ç é€å±‚è§£æ"><a href="#ä¸€ã€ä»£ç é€å±‚è§£æ" class="headerlink" title="ä¸€ã€ä»£ç é€å±‚è§£æ"></a>ä¸€ã€ä»£ç é€å±‚è§£æ</h3><h3 id="1-XposedBridge-log"><a href="#1-XposedBridge-log" class="headerlink" title="1.&nbsp;XposedBridge.log()"></a>1.&nbsp;<strong><code>XposedBridge.log()</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šXposedæ¡†æ¶æä¾›çš„æ—¥å¿—è¾“å‡ºæ¥å£ï¼Œå°†å†…å®¹å†™å…¥Xposed Installerçš„æ—¥å¿—ç³»ç»Ÿï¼ˆå¯é€šè¿‡Xposedåº”ç”¨æŸ¥çœ‹ï¼‰ã€‚</li><li><strong>è¯­æ³•ç‰¹æ€§</strong>ï¼š<ul><li><code>XposedBridge</code>&nbsp;æ˜¯Xposedæ¡†æ¶çš„æ ¸å¿ƒç±»ï¼Œæä¾›æ¨¡å—ä¸æ¡†æ¶çš„äº¤äº’æ¥å£ã€‚</li><li><code>log()</code>&nbsp;æ˜¯é™æ€æ–¹æ³•ï¼Œå¯ç›´æ¥è°ƒç”¨ï¼Œæ— éœ€å®ä¾‹åŒ–å¯¹è±¡ã€‚</li><li>å‚æ•°ç±»å‹ä¸º&nbsp;<code>String</code>ï¼Œéœ€ä¼ é€’å­—ç¬¦ä¸²å†…å®¹ã€‚</li></ul></li></ul><h3 id="2-param-args"><a href="#2-param-args" class="headerlink" title="2.&nbsp;param.args"></a>2.&nbsp;<strong><code>param.args</code></strong></h3><ul><li><p><strong><code>param</code>&nbsp;çš„æ¥æº</strong>ï¼š</p><ul><li><p>æ¥è‡ªXposed Hookå›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œé€šå¸¸æ˜¯&nbsp;<code>XC_MethodHook.MethodHookParam</code>&nbsp;å¯¹è±¡ã€‚</p></li><li><p>ä¾‹å¦‚åœ¨Hookæ–¹æ³•æ—¶å®šä¹‰çš„å›è°ƒï¼š</p>  <figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-title class_">XposedHelpers</span>.<span class="hljs-title function_">findAndHookMethod</span>(<span class="hljs-string">"com.example.TargetClass"</span>,<br>    loadPackageParam.<span class="hljs-property">classLoader</span>,<br>    <span class="hljs-string">"targetMethod"</span>,<br>    <span class="hljs-title class_">String</span>.<span class="hljs-property">class</span>,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title function_">XC_MethodHook</span>(<span class="hljs-params"></span>) {<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">beforeHookedMethod</span>(<span class="hljs-params"><span class="hljs-title class_">MethodHookParam</span> param</span>) {<br>            <span class="hljs-comment">// è¿™é‡Œçš„paramå³MethodHookParamå®ä¾‹</span><br>            <span class="hljs-title class_">XposedBridge</span>.<span class="hljs-title function_">log</span>(param.<span class="hljs-property">args</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">toString</span>());<br>        }<br>    });<br></code></pre></td></tr></tbody></table></figure></li></ul></li><li><p><strong><code>args</code>&nbsp;å±æ€§</strong>ï¼š</p><ul><li>æ˜¯è¢«Hookæ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼ˆ<code>Object[]</code>&nbsp;æ•°ç»„ï¼‰ã€‚</li><li>ä¾‹å¦‚ï¼šè‹¥è¢«Hookæ–¹æ³•ç­¾åæ˜¯&nbsp;<code>void func(String arg1, int arg2)</code>ï¼Œåˆ™ï¼š<ul><li><code>param.args[0]</code>&nbsp;å¯¹åº”&nbsp;<code>arg1</code>ï¼ˆç±»å‹ä¸ºStringï¼‰</li><li><code>param.args[1]</code>&nbsp;å¯¹åº”&nbsp;<code>arg2</code>ï¼ˆç±»å‹ä¸ºIntegerï¼Œè‡ªåŠ¨è£…ç®±ï¼‰</li></ul></li></ul></li></ul><h3 id="3-param-args-0"><a href="#3-param-args-0" class="headerlink" title="3.&nbsp;param.args[0]"></a>3.&nbsp;<strong><code>param.args[0]</code></strong></h3><ul><li>è¡¨ç¤ºè·å–è¢«Hookæ–¹æ³•çš„&nbsp;<strong>ç¬¬ä¸€ä¸ªå‚æ•°</strong>ã€‚</li><li>ç´¢å¼•ä»0å¼€å§‹ï¼š<ul><li><code>param.args[0]</code>&nbsp;â†’ ç¬¬1ä¸ªå‚æ•°</li><li><code>param.args[1]</code>&nbsp;â†’ ç¬¬2ä¸ªå‚æ•°</li><li>ä¾æ­¤ç±»æ¨ã€‚</li></ul></li><li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š<ul><li>è‹¥æ–¹æ³•æ— å‚æ•°ï¼ˆå¦‚&nbsp;<code>void func()</code>ï¼‰ï¼Œè®¿é—®&nbsp;<code>args[0]</code>&nbsp;ä¼šå¯¼è‡´&nbsp;<code>ArrayIndexOutOfBoundsException</code>ã€‚</li><li>éœ€ç¡®ä¿ç›®æ ‡æ–¹æ³•è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ã€‚</li></ul></li></ul><h3 id="4-toString"><a href="#4-toString" class="headerlink" title="4.&nbsp;.toString()"></a>4.&nbsp;<strong><code>.toString()</code></strong></h3><ul><li>å°†å‚æ•°å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š<ul><li>è‹¥å‚æ•°æ˜¯Javaå¯¹è±¡ï¼ˆå¦‚Stringã€è‡ªå®šä¹‰ç±»å®ä¾‹ï¼‰ï¼Œè°ƒç”¨å…¶&nbsp;<code>toString()</code>&nbsp;æ–¹æ³•ã€‚</li><li>è‹¥å‚æ•°æ˜¯åŸºæœ¬ç±»å‹ï¼ˆå¦‚intã€booleanï¼‰ï¼Œè‡ªåŠ¨è£…ç®±ä¸ºIntegerã€Booleanåè°ƒç”¨&nbsp;<code>toString()</code>ã€‚</li></ul></li><li><strong>é£é™©ç‚¹</strong>ï¼š<ul><li><p>è‹¥å‚æ•°ä¸º&nbsp;<code>null</code>ï¼Œè°ƒç”¨&nbsp;<code>null.toString()</code>&nbsp;ä¼šæŠ›å‡º&nbsp;<code>NullPointerException</code>ã€‚</p></li><li><p>å¯ä¼˜åŒ–ä¸ºå®‰å…¨è°ƒç”¨ï¼š</p>  <figure class="highlight jsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsx">(param.<span class="hljs-property">args</span>[<span class="hljs-number">0</span>] != <span class="hljs-literal">null</span> ? param.<span class="hljs-property">args</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">toString</span>() : <span class="hljs-string">"null"</span>)<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><hr><h3 id="äºŒã€å®Œæ•´ä»£ç æµç¨‹"><a href="#äºŒã€å®Œæ•´ä»£ç æµç¨‹" class="headerlink" title="äºŒã€å®Œæ•´ä»£ç æµç¨‹"></a>äºŒã€å®Œæ•´ä»£ç æµç¨‹</h3><ol><li><strong>Hookç›®æ ‡æ–¹æ³•</strong>ï¼šé€šè¿‡Xposedæ¡†æ¶æ³¨å†ŒHookç‚¹ï¼Œæ‹¦æˆªæŸä¸ªç±»çš„æ–¹æ³•è°ƒç”¨ã€‚</li><li><strong>è¿›å…¥å›è°ƒå‡½æ•°</strong>ï¼šå½“ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè§¦å‘&nbsp;<code>beforeHookedMethod</code>&nbsp;æˆ–&nbsp;<code>afterHookedMethod</code>&nbsp;å›è°ƒã€‚</li><li><strong>è®¿é—®å‚æ•°</strong>ï¼šé€šè¿‡&nbsp;<code>param.args</code>&nbsp;æ•°ç»„è·å–æ–¹æ³•å‚æ•°å€¼ã€‚</li><li><strong>è½¬æ¢å­—ç¬¦ä¸²</strong>ï¼šè°ƒç”¨&nbsp;<code>toString()</code>&nbsp;å°†å‚æ•°è½¬ä¸ºå¯è¯»å­—ç¬¦ä¸²ã€‚</li><li><strong>è®°å½•æ—¥å¿—</strong>ï¼šé€šè¿‡&nbsp;<code>XposedBridge.log()</code>&nbsp;è¾“å‡ºåˆ°Xposedæ—¥å¿—ç³»ç»Ÿã€‚</li></ol><hr><h3 id="ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯"><a href="#ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯" class="headerlink" title="ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯"></a>ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯</h3><h3 id="åœºæ™¯ï¼šç›‘æ§æŸä¸ªåº”ç”¨çš„ç™»å½•å¯†ç å‚æ•°"><a href="#åœºæ™¯ï¼šç›‘æ§æŸä¸ªåº”ç”¨çš„ç™»å½•å¯†ç å‚æ•°" class="headerlink" title="åœºæ™¯ï¼šç›‘æ§æŸä¸ªåº”ç”¨çš„ç™»å½•å¯†ç å‚æ•°"></a>åœºæ™¯ï¼šç›‘æ§æŸä¸ªåº”ç”¨çš„ç™»å½•å¯†ç å‚æ•°</h3><p>  å‡è®¾Hookä¸€ä¸ªç™»å½•æ–¹æ³•&nbsp;<code>login(String username, String password)</code>ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">XposedBridge.<span class="hljs-built_in">log</span>(<span class="hljs-string">"ç”¨æˆ·åï¼š"</span> + param.<span class="hljs-keyword">args</span>[0].<span class="hljs-keyword">toString</span>());<br>XposedBridge.<span class="hljs-built_in">log</span>(<span class="hljs-string">"å¯†ç ï¼š"</span> + param.<span class="hljs-keyword">args</span>[1].<span class="hljs-keyword">toString</span>());<br></code></pre></td></tr></tbody></table></figure><p>  è¾“å‡ºç»“æœï¼š</p><p>  å¤åˆ¶</p>  <figure class="highlight nsis"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis">ç”¨æˆ·åï¼š<span class="hljs-literal">admin</span><br>å¯†ç ï¼š<span class="hljs-number">123456</span><br></code></pre></td></tr></tbody></table></figure><h3 id="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š"><a href="#é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š" class="headerlink" title="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š"></a>é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š</h3><ul><li><strong>å‚æ•°æ··æ·†</strong>ï¼šå°†å‚æ•°ç±»å‹ä»Stringæ”¹ä¸ºbyteæ•°ç»„ï¼Œå¢åŠ å¯è¯»æ€§éš¾åº¦ã€‚</li><li><strong>ä¸»åŠ¨æ£€æµ‹Xposed</strong>ï¼šåœ¨å…³é”®æ–¹æ³•ä¸­æ£€æµ‹Xposedç¯å¢ƒï¼Œè‹¥å­˜åœ¨åˆ™æ‹’ç»æ‰§è¡Œã€‚</li></ul></li></ul><ol><li>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å®‰å“è‡ªå¸¦çš„log</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262102101.png"></p><ul><li><p>è¯­æ³•è§£æ</p><h3 id="1-Log-d-zj2595-param-args-0-toString"><a href="#1-Log-d-zj2595-param-args-0-toString" class="headerlink" title="1.&nbsp;Log.d(&quot;zj2595&quot;, param.args[0.toString());"></a><strong>1.&nbsp;<code>Log.d("zj2595", param.args[0.toString());</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šé€šè¿‡AndroidåŸç”Ÿæ—¥å¿—ç³»ç»Ÿè¾“å‡ºè¢«Hookæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å€¼ã€‚</li><li><strong>è¯­æ³•</strong>ï¼š<ul><li><code>Log.d(String tag, String msg)</code>ï¼šAndroidçš„è°ƒè¯•æ—¥å¿—æ¥å£ï¼Œ<code>tag</code>ä¸ºæ—¥å¿—æ ‡ç­¾ï¼Œ<code>msg</code>ä¸ºæ—¥å¿—å†…å®¹ã€‚</li><li><code>param.args[0]</code>ï¼šè·å–è¢«Hookæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰ã€‚</li><li><code>toString()</code>ï¼šå°†å‚æ•°å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²ï¼ˆå¯èƒ½å› å¯¹è±¡ç±»å‹ä¸åŒè€Œç»“æœä¸åŒï¼‰ã€‚</li></ul></li><li><strong>é£é™©</strong>ï¼š<ul><li><p>è‹¥å‚æ•°ä¸º&nbsp;<code>null</code>ï¼Œ<code>toString()</code>&nbsp;ä¼šæŠ›å‡º&nbsp;<code>NullPointerException</code>ã€‚</p></li><li><p>å»ºè®®ä¼˜åŒ–ä¸ºå®‰å…¨è°ƒç”¨ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">String arg0 = (param.<span class="hljs-keyword">args</span>[0] != null) ? param.<span class="hljs-keyword">args</span>[0].<span class="hljs-keyword">toString</span>() : <span class="hljs-string">"null"</span>;<br><span class="hljs-keyword">Log</span>.<span class="hljs-built_in">d</span>(<span class="hljs-string">"zj2595"</span>, arg0);<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><h3 id="2-XposedBridge-log-param-args-0-toString"><a href="#2-XposedBridge-log-param-args-0-toString" class="headerlink" title="2.&nbsp;XposedBridge.log(param.args[0].toString());"></a><strong>2.&nbsp;<code>XposedBridge.log(param.args[0].toString());</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šé€šè¿‡Xposedæ¡†æ¶çš„æ—¥å¿—ç³»ç»Ÿè®°å½•å‚æ•°å€¼ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>æ—¥å¿—å†…å®¹å¯åœ¨Xposed Installerçš„æ—¥å¿—é¡µé¢æŸ¥çœ‹ï¼Œç‹¬ç«‹äºAndroidåŸç”Ÿæ—¥å¿—ã€‚</li><li>é€‚åˆé•¿æœŸè°ƒè¯•ï¼Œä½†ç¼ºä¹æ—¥å¿—æ ‡ç­¾åˆ†ç±»ã€‚</li></ul></li></ul><h3 id="3-String-a-pt"><a href="#3-String-a-pt" class="headerlink" title="3.&nbsp;String a = &quot;pt&quot;;"></a><strong>3.&nbsp;<code>String a = "pt";</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡&nbsp;<code>a</code>ï¼Œå€¼ä¸º&nbsp;<code>"pt"</code>ã€‚</li><li><strong>æ½œåœ¨ç”¨é€”</strong>ï¼š<ul><li>ç¡¬ç¼–ç æ›¿æ¢ç›®æ ‡å‚æ•°å€¼ï¼ˆå¦‚ä¿®æ”¹å¯†ç ã€å¯†é’¥ç­‰ï¼‰ã€‚</li><li>å¯ä½œä¸ºä¸­é—´å˜é‡é˜²æ­¢ç›´æ¥æš´éœ²æ•æ„Ÿé€»è¾‘ã€‚</li></ul></li></ul><h3 id="4-param-args-0-a"><a href="#4-param-args-0-a" class="headerlink" title="4.&nbsp;param.args[0] = a;"></a><strong>4.&nbsp;<code>param.args[0] = a;</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šä¿®æ”¹è¢«Hookæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å€¼ä¸º&nbsp;<code>"pt"</code>ã€‚</li><li><strong>åŸç†</strong>ï¼š<ul><li>Xposedæ¡†æ¶çš„&nbsp;<code>MethodHookParam</code>&nbsp;å¯¹è±¡å…è®¸åœ¨&nbsp;<code>beforeHookedMethod</code>&nbsp;é˜¶æ®µä¿®æ”¹å‚æ•°å€¼ã€‚</li><li>ä¿®æ”¹åçš„å€¼ä¼šä¼ é€’ç»™åŸå§‹æ–¹æ³•æ‰§è¡Œï¼Œä»è€Œå®ç°<strong>è¿è¡Œæ—¶å‚æ•°ç¯¡æ”¹</strong>ã€‚</li></ul></li><li><strong>é™åˆ¶</strong>ï¼š<ul><li>åªèƒ½åœ¨&nbsp;<code>beforeHookedMethod</code>&nbsp;å›è°ƒä¸­ä¿®æ”¹å‚æ•°ï¼ˆ<code>afterHookedMethod</code>&nbsp;é˜¶æ®µä¿®æ”¹æ— æ•ˆï¼‰ã€‚</li><li>å‚æ•°ç±»å‹éœ€åŒ¹é…ç›®æ ‡æ–¹æ³•å£°æ˜ç±»å‹ï¼Œå¦åˆ™å¯èƒ½å¼•å‘ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚</li></ul></li></ul><h3 id="5-Log-d-zj2595-param-args-0-toString"><a href="#5-Log-d-zj2595-param-args-0-toString" class="headerlink" title="5.&nbsp;Log.d(&quot;zj2595&quot;, param.args[0].toString());"></a><strong>5.&nbsp;<code>Log.d("zj2595", param.args[0].toString());</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šéªŒè¯å‚æ•°æ˜¯å¦è¢«æˆåŠŸä¿®æ”¹ã€‚</li><li><strong>é¢„æœŸè¾“å‡º</strong>ï¼š<ul><li>è‹¥ä¿®æ”¹æˆåŠŸï¼Œæ—¥å¿—åº”æ˜¾ç¤º&nbsp;<code>pt</code>ã€‚</li><li>è‹¥ä¿®æ”¹å¤±è´¥ï¼Œæ—¥å¿—ä»æ˜¾ç¤ºåŸå§‹å€¼ï¼ˆéœ€æ£€æŸ¥Hookç‚¹æ˜¯å¦æ­£ç¡®ï¼‰ã€‚</li></ul></li></ul><hr><h3 id="å®Œæ•´æµç¨‹"><a href="#å®Œæ•´æµç¨‹" class="headerlink" title="å®Œæ•´æµç¨‹"></a><strong>å®Œæ•´æµç¨‹</strong></h3><ol><li><strong>æ‹¦æˆªæ–¹æ³•è°ƒç”¨</strong>ï¼šé€šè¿‡Xposed Hookç›®æ ‡æ–¹æ³•ï¼Œè¿›å…¥&nbsp;<code>beforeHookedMethod</code>&nbsp;å›è°ƒã€‚</li><li><strong>è®°å½•åŸå§‹å‚æ•°</strong>ï¼šé€šè¿‡Androidæ—¥å¿—å’ŒXposedæ—¥å¿—è¾“å‡ºåŸå§‹å‚æ•°å€¼ã€‚</li><li><strong>ç¯¡æ”¹å‚æ•°å€¼</strong>ï¼šå°†ç¬¬ä¸€ä¸ªå‚æ•°æ›¿æ¢ä¸ºç¡¬ç¼–ç å€¼&nbsp;<code>"pt"</code>ã€‚</li><li><strong>ä¼ é€’ä¿®æ”¹åçš„å‚æ•°</strong>ï¼šXposedæ¡†æ¶å°†ä¿®æ”¹åçš„å‚æ•°ä¼ é€’ç»™åŸå§‹æ–¹æ³•ã€‚</li><li><strong>éªŒè¯ç¯¡æ”¹ç»“æœ</strong>ï¼šé€šè¿‡ç¬¬äºŒæ¬¡æ—¥å¿—è¾“å‡ºç¡®è®¤ä¿®æ”¹æ˜¯å¦ç”Ÿæ•ˆã€‚</li></ol><hr><h3 id="å…¸å‹åº”ç”¨åœºæ™¯"><a href="#å…¸å‹åº”ç”¨åœºæ™¯" class="headerlink" title="å…¸å‹åº”ç”¨åœºæ™¯"></a><strong>å…¸å‹åº”ç”¨åœºæ™¯</strong></h3><h3 id="åœºæ™¯ï¼šç»•è¿‡å¯†ç éªŒè¯"><a href="#åœºæ™¯ï¼šç»•è¿‡å¯†ç éªŒè¯" class="headerlink" title="åœºæ™¯ï¼šç»•è¿‡å¯†ç éªŒè¯"></a><strong>åœºæ™¯ï¼šç»•è¿‡å¯†ç éªŒè¯</strong></h3><p>  å‡è®¾ç›®æ ‡æ–¹æ³•ä¸º&nbsp;<code>checkPassword(String password)</code>ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">checkPassword</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> password</span>) {<br>    <span class="hljs-keyword">return</span> password.<span class="hljs-title function_">equals</span>(<span class="hljs-string">"secret"</span>);<br>}<br></code></pre></td></tr></tbody></table></figure><p>  é€šè¿‡ä»¥ä¸‹ä»£ç ç¯¡æ”¹å‚æ•°ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight abnf"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">param.args[<span class="hljs-number">0</span>] <span class="hljs-operator">=</span> <span class="hljs-string">"secret"</span><span class="hljs-comment">; // å¼ºåˆ¶è®©å¯†ç éªŒè¯é€šè¿‡</span><br></code></pre></td></tr></tbody></table></figure><p>  æ­¤æ—¶æ— è®ºç”¨æˆ·è¾“å…¥ä»€ä¹ˆå¯†ç ï¼Œæ–¹æ³•éƒ½ä¼šè¿”å›&nbsp;<code>true</code>ã€‚</p><h3 id="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š-1"><a href="#é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š-1" class="headerlink" title="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š"></a><strong>é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰</strong>ï¼š</h3><ol><li><p><strong>å‚æ•°æ ¡éªŒ</strong>ï¼šåœ¨æ–¹æ³•å†…éƒ¨å¯¹å‚æ•°å€¼è¿›è¡ŒäºŒæ¬¡æ ¡éªŒã€‚</p><p> java</p><p> å¤åˆ¶</p> <figure class="highlight pgsql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">public</span> <span class="hljs-type">boolean</span> checkPassword(String <span class="hljs-keyword">password</span>) {<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">password</span> == <span class="hljs-keyword">null</span> || <span class="hljs-keyword">password</span>.length() != <span class="hljs-number">6</span>) {<br>        throw <span class="hljs-built_in">new</span> SecurityException("Invalid password format");<br>    }<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">password</span>.equals("secret");<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ£€æµ‹Hookç¯å¢ƒ</strong>ï¼šé€šè¿‡æ£€æŸ¥è°ƒç”¨æ ˆæˆ–ç±»åŠ è½½å™¨ï¼Œå‘ç°Xposedå­˜åœ¨æ—¶æ‹’ç»æ‰§è¡Œã€‚</p></li></ol></li><li><p>log.då’Œlog.eçš„åŒºåˆ«</p><p>  åœ¨Androidå¼€å‘ä¸­ï¼Œ<code>Log.d()</code>&nbsp;å’Œ&nbsp;<code>Log.e()</code>&nbsp;æ˜¯&nbsp;<code>android.util.Log</code>&nbsp;ç±»æä¾›çš„ä¸åŒçº§åˆ«çš„æ—¥å¿—è¾“å‡ºæ–¹æ³•ã€‚å®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«åœ¨äº<strong>æ—¥å¿—çº§åˆ«</strong>ã€<strong>ä½¿ç”¨åœºæ™¯</strong>å’Œ<strong>è¾“å‡ºè¡¨ç°</strong>ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†å¯¹æ¯”ï¼š</p><hr><h3 id="1-æ—¥å¿—çº§åˆ«ä¸è¯­ä¹‰"><a href="#1-æ—¥å¿—çº§åˆ«ä¸è¯­ä¹‰" class="headerlink" title="1. æ—¥å¿—çº§åˆ«ä¸è¯­ä¹‰"></a><strong>1. æ—¥å¿—çº§åˆ«ä¸è¯­ä¹‰</strong></h3><table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>çº§åˆ«ï¼ˆVerbosityï¼‰</strong></th><th><strong>è¯­ä¹‰å«ä¹‰</strong></th></tr></thead><tbody><tr><td><code>Log.d(String tag, String msg)</code></td><td><strong>DEBUG</strong></td><td>è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œç”¨äºå¼€å‘é˜¶æ®µè¿½è¸ªç¨‹åºæµç¨‹ã€å˜é‡å€¼ç­‰éå…³é”®ä¿¡æ¯ã€‚</td></tr><tr><td><code>Log.e(String tag, String msg)</code></td><td><strong>ERROR</strong></td><td>è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†ä¸¥é‡é—®é¢˜ï¼ˆå¦‚å´©æºƒã€åŠŸèƒ½å¤±æ•ˆç­‰ï¼‰ï¼Œéœ€è¦ä¼˜å…ˆå¤„ç†ã€‚</td></tr></tbody></table><hr><h3 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2. ä½¿ç”¨åœºæ™¯"></a><strong>2. ä½¿ç”¨åœºæ™¯</strong></h3><h3 id="Log-d-ï¼ˆè°ƒè¯•æ—¥å¿—ï¼‰"><a href="#Log-d-ï¼ˆè°ƒè¯•æ—¥å¿—ï¼‰" class="headerlink" title="Log.d()ï¼ˆè°ƒè¯•æ—¥å¿—ï¼‰"></a><strong><code>Log.d()</code>ï¼ˆè°ƒè¯•æ—¥å¿—ï¼‰</strong></h3><ul><li><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>è¿½è¸ªä»£ç æ‰§è¡Œæµç¨‹ï¼ˆå¦‚æ–¹æ³•è°ƒç”¨é¡ºåºï¼‰ã€‚</li><li>è¾“å‡ºä¸´æ—¶å˜é‡çš„å€¼ï¼ˆå¦‚å‚æ•°ã€ä¸­é—´è®¡ç®—ç»“æœï¼‰ã€‚</li><li>è°ƒè¯•é€»è¾‘åˆ†æ”¯ï¼ˆå¦‚æ¡ä»¶åˆ¤æ–­æ˜¯å¦è¿›å…¥æŸä¸ªåˆ†æ”¯ï¼‰ã€‚</li></ul></li><li><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">Log</span>.<span class="hljs-built_in">d</span>(<span class="hljs-string">"MainActivity"</span>, <span class="hljs-string">"onCreate() called"</span>); <span class="hljs-comment">// è·Ÿè¸ªç”Ÿå‘½å‘¨æœŸ</span><br><span class="hljs-keyword">Log</span>.<span class="hljs-built_in">d</span>(<span class="hljs-string">"Network"</span>, <span class="hljs-string">"Response data: "</span> + response); <span class="hljs-comment">// è¾“å‡ºç½‘ç»œå“åº”æ•°æ®</span><br></code></pre></td></tr></tbody></table></figure></li></ul><h3 id="Log-e-ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰"><a href="#Log-e-ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰" class="headerlink" title="Log.e()ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰"></a><strong><code>Log.e()</code>ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰</strong></h3><ul><li><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>è®°å½•ç¨‹åºå¼‚å¸¸ï¼ˆå¦‚&nbsp;<code>try-catch</code>&nbsp;å—ä¸­çš„é”™è¯¯ï¼‰ã€‚</li><li>æ ‡è®°ä¸å¯æ¢å¤çš„æ•…éšœï¼ˆå¦‚æ•°æ®åº“è¿æ¥å¤±è´¥ã€å…³é”®APIè°ƒç”¨é”™è¯¯ï¼‰ã€‚</li><li>è¾“å‡ºå¯¹ç”¨æˆ·ä½“éªŒæœ‰é‡å¤§å½±å“çš„é”™è¯¯ï¼ˆå¦‚æ”¯ä»˜å¤±è´¥ã€æ•°æ®ä¸¢å¤±ï¼‰ã€‚</li></ul></li><li><p><strong>ç¤ºä¾‹</strong>ï¼š</p><p>  java</p><p>  å¤åˆ¶</p>  <figure class="highlight arcade"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">try</span> {<br>    parseJson(rawData);<br>} <span class="hljs-keyword">catch</span> (JSONException e) {<br>    <span class="hljs-built_in">Log</span>.e(<span class="hljs-string">"Parser"</span>, <span class="hljs-string">"JSONè§£æå¤±è´¥: "</span> + e.getMessage()); <span class="hljs-comment">// è®°å½•è‡´å‘½é”™è¯¯</span><br>}<br></code></pre></td></tr></tbody></table></figure></li></ul><hr><h3 id="3-è¾“å‡ºè¡¨ç°"><a href="#3-è¾“å‡ºè¡¨ç°" class="headerlink" title="3. è¾“å‡ºè¡¨ç°"></a><strong>3. è¾“å‡ºè¡¨ç°</strong></h3><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong><code>Log.d()</code></strong></th><th><strong><code>Log.e()</code></strong></th></tr></thead><tbody><tr><td><strong>Logcatæ˜¾ç¤ºé¢œè‰²</strong></td><td>é»˜è®¤é»‘è‰²ï¼ˆæˆ–ç°è‰²ï¼Œå–å†³äºIDEä¸»é¢˜ï¼‰</td><td><strong>çº¢è‰²</strong>ï¼ˆé«˜äº®æç¤ºï¼Œæ˜“äºå¿«é€Ÿå®šä½ï¼‰</td></tr><tr><td><strong>è¿‡æ»¤ä¼˜å…ˆçº§</strong></td><td>ä½</td><td>é«˜ï¼ˆ<code>ERROR</code>&nbsp;&gt;&nbsp;<code>WARN</code>&nbsp;&gt;&nbsp;<code>INFO</code>&nbsp;&gt;&nbsp;<code>DEBUG</code>&nbsp;&gt;&nbsp;<code>VERBOSE</code>ï¼‰</td></tr><tr><td><strong>é»˜è®¤å¯è§æ€§</strong></td><td>é€šå¸¸åœ¨è°ƒè¯•ç‰ˆæœ¬ï¼ˆDebug Buildï¼‰å¯ç”¨</td><td>å§‹ç»ˆè¾“å‡ºï¼ˆå³ä½¿å‘å¸ƒç‰ˆæœ¬ä¹Ÿå¯èƒ½ä¿ç•™ï¼‰</td></tr></tbody></table><hr><h3 id="4-å®é™…åº”ç”¨å»ºè®®"><a href="#4-å®é™…åº”ç”¨å»ºè®®" class="headerlink" title="4. å®é™…åº”ç”¨å»ºè®®"></a><strong>4. å®é™…åº”ç”¨å»ºè®®</strong></h3><h3 id="ä½•æ—¶ç”¨-Log-dï¼Ÿ"><a href="#ä½•æ—¶ç”¨-Log-dï¼Ÿ" class="headerlink" title="ä½•æ—¶ç”¨&nbsp;Log.dï¼Ÿ"></a><strong>ä½•æ—¶ç”¨&nbsp;<code>Log.d</code>ï¼Ÿ</strong></h3><ul><li><p>å¼€å‘é˜¶æ®µä¸´æ—¶è°ƒè¯•ï¼Œéœ€åœ¨<strong>å‘å¸ƒç‰ˆæœ¬ä¸­ç§»é™¤</strong>ï¼ˆé€šè¿‡&nbsp;<code>BuildConfig.DEBUG</code>&nbsp;æ§åˆ¶ï¼‰ï¼š</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">if</span> (BuildConfig.DEBUG) {<br>    <span class="hljs-keyword">Log</span>.<span class="hljs-built_in">d</span>(<span class="hljs-string">"Tag"</span>, <span class="hljs-string">"è°ƒè¯•ä¿¡æ¯"</span>); <span class="hljs-comment">// ä»…è°ƒè¯•ç‰ˆæœ¬è¾“å‡º</span><br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p>è¾“å‡ºé«˜é¢‘æ¬¡ã€éå…³é”®ä¿¡æ¯ï¼ˆå¦‚å¾ªç¯å†…çš„å˜é‡å€¼ï¼‰ã€‚</p></li></ul><h3 id="ä½•æ—¶ç”¨-Log-eï¼Ÿ"><a href="#ä½•æ—¶ç”¨-Log-eï¼Ÿ" class="headerlink" title="ä½•æ—¶ç”¨&nbsp;Log.eï¼Ÿ"></a><strong>ä½•æ—¶ç”¨&nbsp;<code>Log.e</code>ï¼Ÿ</strong></h3><ul><li>è®°å½•<strong>å¿…é¡»ä¿®å¤</strong>çš„é—®é¢˜ï¼ˆå¦‚å´©æºƒã€æ•°æ®é”™è¯¯ï¼‰ã€‚</li><li>éœ€è¦é•¿æœŸç›‘æ§çš„ä¸¥é‡äº‹ä»¶ï¼ˆå³ä½¿åº”ç”¨å·²å‘å¸ƒï¼‰ã€‚</li></ul><hr><h3 id="5-é€†å‘å·¥ç¨‹ä¸­çš„ç‰¹æ®Šç”¨é€”"><a href="#5-é€†å‘å·¥ç¨‹ä¸­çš„ç‰¹æ®Šç”¨é€”" class="headerlink" title="5. é€†å‘å·¥ç¨‹ä¸­çš„ç‰¹æ®Šç”¨é€”"></a><strong>5. é€†å‘å·¥ç¨‹ä¸­çš„ç‰¹æ®Šç”¨é€”</strong></h3><p>  åœ¨Androidé€†å‘åˆ†æä¸­ï¼Œæ—¥å¿—è¾“å‡ºå¸¸ç”¨äºåŠ¨æ€è°ƒè¯•ï¼š</p><ul><li><p><strong><code>Log.d</code></strong>ï¼šç”¨äºè¿½è¸ªç›®æ ‡æ–¹æ³•çš„å‚æ•°ä¼ é€’æˆ–æµç¨‹åˆ†æ”¯ã€‚</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-comment">// Hookæ–¹æ³•å¹¶è¾“å‡ºå‚æ•°</span><br>XposedBridge.<span class="hljs-built_in">log</span>(<span class="hljs-string">"å‚æ•°1: "</span> + param.<span class="hljs-keyword">args</span>[0]);<br><span class="hljs-keyword">Log</span>.<span class="hljs-built_in">d</span>(<span class="hljs-string">"Hook"</span>, <span class="hljs-string">"å‚æ•°1: "</span> + param.<span class="hljs-keyword">args</span>[0]); <span class="hljs-comment">// åŒä¿é™©è®°å½•</span><br></code></pre></td></tr></tbody></table></figure></li><li><p><strong><code>Log.e</code></strong>ï¼šæ ‡è®°å…³é”®é”™è¯¯ï¼ˆå¦‚åŠ å¯†ç®—æ³•å¤±è´¥ã€åè°ƒè¯•æ£€æµ‹è§¦å‘ï¼‰ã€‚</p>  <figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">if</span> (detectXposed()) { <span class="hljs-comment">// æ£€æµ‹åˆ°Xposedç¯å¢ƒ</span><br>    <span class="hljs-keyword">Log</span>.<span class="hljs-built_in">e</span>(<span class="hljs-string">"Security"</span>, <span class="hljs-string">"Xposedæ¡†æ¶å·²æ³¨å…¥ï¼"</span>); <span class="hljs-comment">// é«˜äº®æç¤ºé£é™©</span><br>}<br></code></pre></td></tr></tbody></table></figure></li></ul><hr><h3 id="6-å…¶ä»–æ—¥å¿—æ–¹æ³•å¯¹æ¯”"><a href="#6-å…¶ä»–æ—¥å¿—æ–¹æ³•å¯¹æ¯”" class="headerlink" title="6. å…¶ä»–æ—¥å¿—æ–¹æ³•å¯¹æ¯”"></a><strong>6. å…¶ä»–æ—¥å¿—æ–¹æ³•å¯¹æ¯”</strong></h3><table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>çº§åˆ«</strong></th><th><strong>ç”¨é€”</strong></th></tr></thead><tbody><tr><td><code>Log.v()</code></td><td>VERBOSE</td><td>æœ€è¯¦ç»†çš„æ—¥å¿—ï¼ˆæå°‘ä½¿ç”¨ï¼‰</td></tr><tr><td><code>Log.i()</code></td><td>INFO</td><td>æ™®é€šæµç¨‹ä¿¡æ¯ï¼ˆå¦‚æœåŠ¡å¯åŠ¨ï¼‰</td></tr><tr><td><code>Log.w()</code></td><td>WARN</td><td>è­¦å‘Šï¼ˆæ½œåœ¨é—®é¢˜ï¼Œä½†æœªå¯¼è‡´é”™è¯¯ï¼‰</td></tr></tbody></table></li></ul><p>  7.æˆ‘ä»¬ä¿®æ”¹å¥½åè¿è¡Œç¨‹åºï¼Œå¹¶åœ¨æ‰‹æœºä¸Šå‹¾é€‰æˆ‘ä»¬çš„Demoæ¨¡å—ï¼Œå†è¿›è¡ŒæŸ¥çœ‹ä¼šå‘ç°å‚æ•°å·²ä¿®æ”¹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262103369.png"></p><ol><li>è¿”å›å€¼çš„Hookï¼Œå…ˆæ‰“å°è¿”å›å€¼ï¼Œç„¶åè¿›è¡Œä¿®æ”¹</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262103041.png"></p><ul><li><p>è¯­æ³•åˆ†æ</p><h3 id="ä»£ç ä½œç”¨"><a href="#ä»£ç ä½œç”¨" class="headerlink" title="ä»£ç ä½œç”¨"></a><strong>ä»£ç ä½œç”¨</strong></h3><ul><li><p><strong><code>Log.d("zj2595", param.getResult().toString())</code></strong>ï¼š</p><p>  è®°å½•è¢«Hookæ–¹æ³•çš„<strong>åŸå§‹è¿”å›å€¼</strong>åˆ°Androidè°ƒè¯•æ—¥å¿—ï¼ˆLogcatï¼‰ã€‚</p></li><li><p><strong><code>param.setResult("222222")</code></strong>ï¼š</p><p>  å¼ºåˆ¶ä¿®æ”¹è¢«Hookæ–¹æ³•çš„<strong>æœ€ç»ˆè¿”å›å€¼</strong>ä¸ºå­—ç¬¦ä¸²&nbsp;<code>"222222"</code>ã€‚</p></li></ul><hr><h3 id="ä½¿ç”¨åœºæ™¯ï¼ˆé€†å‘å·¥ç¨‹å…¸å‹ç”¨é€”ï¼‰"><a href="#ä½¿ç”¨åœºæ™¯ï¼ˆé€†å‘å·¥ç¨‹å…¸å‹ç”¨é€”ï¼‰" class="headerlink" title="ä½¿ç”¨åœºæ™¯ï¼ˆé€†å‘å·¥ç¨‹å…¸å‹ç”¨é€”ï¼‰"></a><strong>ä½¿ç”¨åœºæ™¯ï¼ˆé€†å‘å·¥ç¨‹å…¸å‹ç”¨é€”ï¼‰</strong></h3><ol><li><p><strong>ç»•è¿‡è¿”å›å€¼æ ¡éªŒ</strong>ï¼š</p><p> ä¾‹å¦‚ï¼ŒHookä¸€ä¸ªéªŒè¯å‡½æ•°&nbsp;<code>boolean checkLicense()</code>ï¼Œå°†å…¶å¸ƒå°”å‹è¿”å›å€¼ä»&nbsp;<code>false</code>&nbsp;æ”¹ä¸º&nbsp;<code>true</code>ï¼Œå®ç°ç ´è§£æˆæƒé€»è¾‘ã€‚</p></li><li><p><strong>ç¯¡æ”¹æ•æ„Ÿæ•°æ®</strong>ï¼š</p><p> ä¾‹å¦‚ï¼ŒHookè·å–è®¾å¤‡IDçš„æ–¹æ³•&nbsp;<code>String getDeviceId()</code>ï¼Œè¿”å›ä¼ªé€ çš„IDå€¼ã€‚</p></li><li><p><strong>åŠ¨æ€è°ƒè¯•åˆ†æ</strong>ï¼š</p><p> é€šè¿‡è¾“å‡ºåŸå§‹è¿”å›å€¼ï¼Œè§‚å¯Ÿç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œç»“æœï¼Œè¾…åŠ©é™æ€åç¼–è¯‘åˆ†æã€‚</p></li></ol><hr><h3 id="ä»£ç æ‰§è¡ŒåŸç†"><a href="#ä»£ç æ‰§è¡ŒåŸç†" class="headerlink" title="ä»£ç æ‰§è¡ŒåŸç†"></a><strong>ä»£ç æ‰§è¡ŒåŸç†</strong></h3><h3 id="1-ä¾èµ–çš„ä¸Šä¸‹æ–‡"><a href="#1-ä¾èµ–çš„ä¸Šä¸‹æ–‡" class="headerlink" title="1. ä¾èµ–çš„ä¸Šä¸‹æ–‡"></a><strong>1. ä¾èµ–çš„ä¸Šä¸‹æ–‡</strong></h3><ul><li><p><strong><code>param</code>&nbsp;çš„ç±»å‹</strong>ï¼š</p><p>  <code>XC_MethodHook.MethodHookParam</code>ï¼ˆXposedæ¡†æ¶çš„å›è°ƒå‚æ•°å¯¹è±¡ï¼‰ã€‚</p></li><li><p><strong>è§¦å‘é˜¶æ®µ</strong>ï¼š</p><p>  ä»£ç éœ€å†™åœ¨&nbsp;<code>afterHookedMethod</code>&nbsp;å›è°ƒä¸­ï¼ˆè‹¥åœ¨&nbsp;<code>beforeHookedMethod</code>&nbsp;é˜¶æ®µè°ƒç”¨&nbsp;<code>getResult()</code>ï¼Œè¿”å›å€¼å¯èƒ½ä¸º&nbsp;<code>null</code>ï¼‰ã€‚</p></li></ul><h3 id="2-å…³é”®æ–¹æ³•è¯´æ˜"><a href="#2-å…³é”®æ–¹æ³•è¯´æ˜" class="headerlink" title="2. å…³é”®æ–¹æ³•è¯´æ˜"></a><strong>2. å…³é”®æ–¹æ³•è¯´æ˜</strong></h3><table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><code>param.getResult()</code></td><td>è·å–è¢«Hookæ–¹æ³•çš„åŸå§‹è¿”å›å€¼ï¼ˆéœ€åœ¨&nbsp;<code>afterHookedMethod</code>&nbsp;é˜¶æ®µè°ƒç”¨æœ‰æ•ˆï¼‰ã€‚</td></tr><tr><td><code>param.setResult()</code></td><td>å¼ºåˆ¶ä¿®æ”¹æ–¹æ³•çš„è¿”å›å€¼ï¼ˆå¯å®Œå…¨è¦†ç›–åŸå§‹é€»è¾‘çš„æ‰§è¡Œç»“æœï¼‰ã€‚</td></tr></tbody></table><h3 id="3-æ‰§è¡Œæµç¨‹"><a href="#3-æ‰§è¡Œæµç¨‹" class="headerlink" title="3. æ‰§è¡Œæµç¨‹"></a><strong>3. æ‰§è¡Œæµç¨‹</strong></h3><ol><li><strong>æ‹¦æˆªç›®æ ‡æ–¹æ³•</strong>ï¼šé€šè¿‡Xposed Hookç›®æ ‡æ–¹æ³•ï¼ˆå¦‚&nbsp;<code>getToken()</code>ï¼‰ã€‚</li><li><strong>è¿›å…¥å›è°ƒé˜¶æ®µ</strong>ï¼šåœ¨&nbsp;<code>afterHookedMethod</code>&nbsp;ä¸­æ‰§è¡Œä»£ç ã€‚</li><li><strong>è®°å½•åŸå§‹è¿”å›å€¼</strong>ï¼šé€šè¿‡&nbsp;<code>Log.d</code>&nbsp;è¾“å‡ºåŸå§‹å€¼åˆ°Logcatã€‚</li><li><strong>ç¯¡æ”¹è¿”å›å€¼</strong>ï¼šä½¿ç”¨&nbsp;<code>setResult</code>&nbsp;è¦†ç›–ä¸ºæŒ‡å®šå€¼ï¼ˆå¦‚&nbsp;<code>"222222"</code>ï¼‰ã€‚</li><li><strong>ä¼ é€’ç»“æœ</strong>ï¼šä¿®æ”¹åçš„å€¼è¿”å›ç»™è°ƒç”¨è€…ï¼ŒåŸå§‹é€»è¾‘è¢«ç»•è¿‡ã€‚</li></ol><hr><h3 id="å®Œæ•´ç¤ºä¾‹ï¼ˆXposedæ¨¡å—ä»£ç ï¼‰"><a href="#å®Œæ•´ç¤ºä¾‹ï¼ˆXposedæ¨¡å—ä»£ç ï¼‰" class="headerlink" title="å®Œæ•´ç¤ºä¾‹ï¼ˆXposedæ¨¡å—ä»£ç ï¼‰"></a><strong>å®Œæ•´ç¤ºä¾‹ï¼ˆXposedæ¨¡å—ä»£ç ï¼‰</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.example.TargetClass"</span>,<br>    loadPackageParam.classLoader,<br>    <span class="hljs-string">"getSecretData"</span>,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> {<br>            <span class="hljs-comment">// 1. è®°å½•åŸå§‹è¿”å›å€¼</span><br>            <span class="hljs-type">Object</span> <span class="hljs-variable">originalResult</span> <span class="hljs-operator">=</span> param.getResult();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">logMsg</span> <span class="hljs-operator">=</span> (originalResult != <span class="hljs-literal">null</span>) ? originalResult.toString() : <span class="hljs-string">"null"</span>;<br>            Log.d(<span class="hljs-string">"zj2595"</span>, <span class="hljs-string">"åŸå§‹è¿”å›å€¼: "</span> + logMsg);<br>            XposedBridge.log(<span class="hljs-string">"åŸå§‹è¿”å›å€¼: "</span> + logMsg);<br><br>            <span class="hljs-comment">// 2. ç¯¡æ”¹è¿”å›å€¼</span><br>            param.setResult(<span class="hljs-string">"222222"</span>);<br><br>            <span class="hljs-comment">// 3. éªŒè¯ä¿®æ”¹ç»“æœ</span><br>            Log.d(<span class="hljs-string">"zj2595"</span>, <span class="hljs-string">"ä¿®æ”¹åè¿”å›å€¼: "</span> + param.getResult().toString());<br>        }<br>    });<br></code></pre></td></tr></tbody></table></figure><hr><h3 id="é€†å‘å¯¹æŠ—ä¸é˜²å¾¡"><a href="#é€†å‘å¯¹æŠ—ä¸é˜²å¾¡" class="headerlink" title="é€†å‘å¯¹æŠ—ä¸é˜²å¾¡"></a><strong>é€†å‘å¯¹æŠ—ä¸é˜²å¾¡</strong></h3><h3 id="é’ˆå¯¹è¿”å›å€¼ç¯¡æ”¹çš„é˜²æŠ¤"><a href="#é’ˆå¯¹è¿”å›å€¼ç¯¡æ”¹çš„é˜²æŠ¤" class="headerlink" title="é’ˆå¯¹è¿”å›å€¼ç¯¡æ”¹çš„é˜²æŠ¤"></a><strong>é’ˆå¯¹è¿”å›å€¼ç¯¡æ”¹çš„é˜²æŠ¤</strong></h3><ol><li><p><strong>ç­¾åæ ¡éªŒ</strong>ï¼š</p><p> åœ¨å…³é”®æ–¹æ³•ä¸­å¢åŠ å¯¹è¿”å›å€¼çš„äºŒæ¬¡æ ¡éªŒï¼ˆå¦‚å“ˆå¸Œæ ¡éªŒï¼‰ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getData</span><span class="hljs-params">()</span> {<br>    <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> fetchFromServer();<br>    <span class="hljs-keyword">if</span> (!verifyHash(data)) { <span class="hljs-comment">// æ ¡éªŒæ•°æ®å®Œæ•´æ€§</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"æ•°æ®è¢«ç¯¡æ”¹ï¼"</span>);<br>    }<br>    <span class="hljs-keyword">return</span> data;<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ··æ·†è¿”å›å€¼ç±»å‹</strong>ï¼š</p><p> ä½¿ç”¨å¤æ‚å¯¹è±¡ï¼ˆéåŸºæœ¬ç±»å‹ï¼‰ä½œä¸ºè¿”å›å€¼ï¼Œå¢åŠ ç¯¡æ”¹éš¾åº¦ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ResultBean <span class="hljs-title function_">getResult</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResultBean</span>(<span class="hljs-number">200</span>, <span class="hljs-string">"OK"</span>, encryptedData);<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ£€æµ‹Hookç¯å¢ƒ</strong>ï¼š</p><p> åœ¨æ–¹æ³•å†…éƒ¨æ£€æŸ¥è°ƒç”¨æ ˆæˆ–ç±»åŠ è½½å™¨ï¼Œè¯†åˆ«Xposedæ³¨å…¥ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (isXposedActive()) {<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"æ£€æµ‹åˆ°Hookæ¡†æ¶ï¼"</span>);<br>}<br></code></pre></td></tr></tbody></table></figure></li></ol></li></ul></li></ul><h3 id="1-Hookæ™®é€šæ–¹æ³•"><a href="#1-Hookæ™®é€šæ–¹æ³•" class="headerlink" title="1.Hookæ™®é€šæ–¹æ³•"></a><strong>1.Hookæ™®é€šæ–¹æ³•</strong></h3><p>ä¿®æ”¹è¿”å›å€¼</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, loadPackageParam.classLoader, <span class="hljs-string">"a"</span>, String.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;param.setResult(<span class="hljs-number">999</span>);<br>&nbsp; &nbsp; }<br>});<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>è¯­æ³•è¯¦è§£</p><ol><li><p><strong>XposedHelpers.findAndHookMethod(â€¦)</strong></p><p> è¿™æ˜¯Xposedæ¡†æ¶æä¾›çš„ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œç”¨äºåœ¨æŒ‡å®šç±»ä¸­æŸ¥æ‰¾æŸä¸ªæ–¹æ³•å¹¶å¯¹å…¶è¿›è¡Œhookï¼ˆæ‹¦æˆªï¼‰ã€‚</p><ul><li><strong>ç›®æ ‡ç±»</strong>ï¼šç¬¬ä¸€ä¸ªå‚æ•° <code>"com.zj.wuaipojie.Demo"</code> è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›hookçš„ç±»ã€‚</li><li><strong>ç±»åŠ è½½å™¨</strong>ï¼šç¬¬äºŒä¸ªå‚æ•° <code>loadPackageParam.classLoader</code> æŒ‡å®šäº†åŠ è½½ç›®æ ‡ç±»çš„ç±»åŠ è½½å™¨ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿæ­£ç¡®å®šä½åˆ°ç±»æ–‡ä»¶ã€‚</li><li><strong>æ–¹æ³•åç§°</strong>ï¼šç¬¬ä¸‰ä¸ªå‚æ•° <code>"a"</code> æŒ‡æ˜äº†è¦hookçš„æ–¹æ³•åã€‚å¦‚æœè¯¥ç±»ä¸­æœ‰å¤šä¸ªåŒåæ–¹æ³•ï¼Œåˆ™åç»­å‚æ•°ï¼ˆå³å‚æ•°ç±»å‹ï¼‰ä¼šå¸®åŠ©ç¡®å®šå…·ä½“å“ªä¸€ä¸ªé‡è½½ç‰ˆæœ¬ã€‚</li><li><strong>æ–¹æ³•å‚æ•°</strong>ï¼šç¬¬å››ä¸ªå‚æ•° <code>String.class</code> è¡¨ç¤ºè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªç±»å‹ä¸ºStringçš„å‚æ•°ã€‚</li><li><strong>å›è°ƒå¯¹è±¡</strong>ï¼šæœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª <code>new XC_MethodHook()</code> å®ä¾‹ï¼Œé‡Œé¢é‡å†™äº† <code>afterHookedMethod</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†åœ¨åŸæ–¹æ³•æ‰§è¡Œå®Œæ¯•åè¢«è°ƒç”¨ã€‚</li></ul></li><li><p><strong>XC_MethodHook çš„ä½œç”¨</strong></p><p> XC_MethodHook æ˜¯Xposedæ¡†æ¶æä¾›çš„ä¸€ä¸ªé’©å­å›è°ƒç±»ï¼Œå®ƒå…è®¸ä½ åœ¨åŸæ–¹æ³•è°ƒç”¨ä¹‹å‰ï¼ˆonEnterï¼‰æˆ–è€…ä¹‹åï¼ˆonLeave/afterHookedMethodï¼‰æ’å…¥è‡ªå·±çš„ä»£ç ã€‚</p><ul><li>æ­¤å¤„æˆ‘ä»¬åªé‡å†™äº† <code>afterHookedMethod</code> æ–¹æ³•ï¼Œæ„å‘³ç€åœ¨åŸæ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œæˆ‘ä»¬ä¼šæ‰§è¡Œæˆ‘ä»¬è‡ªå·±çš„ä»£ç é€»è¾‘ã€‚</li></ul></li><li><p><strong>afterHookedMethod æ–¹æ³•ä¸­çš„æ“ä½œ</strong></p><ul><li><p><strong>super.afterHookedMethod(param);</strong></p><p>  è°ƒç”¨äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¿™é€šå¸¸æ˜¯ä¸ºäº†ä¿æŒä¸€äº›å†…éƒ¨å¤„ç†æµç¨‹ã€‚å¦‚æœä¸éœ€è¦ç‰¹æ®Šé€»è¾‘ï¼Œå¯ä»¥çœç•¥è¿™è¡Œï¼Œä½†æœ‰æ—¶ä¿ç•™æœ‰åŠ©äºç¡®ä¿é»˜è®¤è¡Œä¸ºå¾—ä»¥æ‰§è¡Œã€‚</p></li><li><p><strong>param.setResult(999);</strong></p><p>  è¿™è¡Œä»£ç éå¸¸å…³é”®ï¼šå®ƒä¿®æ”¹äº†åŸæ–¹æ³•çš„è¿”å›å€¼ã€‚æ— è®ºåŸæ–¹æ³•æ‰§è¡Œåäº§ç”Ÿäº†ä»€ä¹ˆè¿”å›å€¼ï¼Œè¿™é‡Œéƒ½ä¼šå°†å…¶æ›¿æ¢ä¸ºæ•´æ•°999ã€‚</p><p>  æ¢å¥è¯è¯´ï¼Œå½“åº”ç”¨ä¸­ä»»ä½•åœ°æ–¹è°ƒç”¨ <code>com.zj.wuaipojie.Demo</code> ç±»ä¸­åä¸º <code>a</code> çš„æ–¹æ³•æ—¶ï¼ˆä¼ å…¥ä¸€ä¸ªStringå‚æ•°ï¼‰ï¼Œå³ä¾¿è¯¥æ–¹æ³•æœ¬èº«å®ç°äº†æŸç§é€»è¾‘ï¼Œæœ€ç»ˆè¿”å›çš„ç»“æœéƒ½ä¼šè¢«hookåæ”¹ä¸º999ã€‚</p></li></ul></li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><strong>ç›®çš„</strong>ï¼šé€šè¿‡Xposedæ¡†æ¶æ‹¦æˆªç›®æ ‡ç±»ä¸­æ–¹æ³•çš„æ‰§è¡Œï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œæˆåå¼ºåˆ¶ä¿®æ”¹å…¶è¿”å›å€¼ã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¸¸ç”¨äºé€†å‘å·¥ç¨‹å’ŒåŠ¨æ€è°ƒè¯•ï¼Œæ¯”å¦‚ç»•è¿‡æŸäº›å®‰å…¨æ£€æŸ¥æˆ–ä¿®æ”¹åº”ç”¨è¡Œä¸ºã€‚</li><li><strong>å…³é”®ç‚¹</strong>ï¼š<ul><li>ä½¿ç”¨ <code>findAndHookMethod</code> æ¥å®šä½å’Œhookç›®æ ‡æ–¹æ³•ï¼›</li><li>åœ¨ <code>afterHookedMethod</code> å›è°ƒä¸­ä½¿ç”¨ <code>param.setResult</code> ä¿®æ”¹è¿”å›å€¼ï¼Œä»è€Œè¦†ç›–åŸæ–¹æ³•çš„æ‰§è¡Œç»“æœã€‚</li></ul></li></ul></li></ul><p>ä¿®æ”¹å‚æ•°</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, loadPackageParam.classLoader, <span class="hljs-string">"a"</span>, String.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-string">"pt"</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;param.args[<span class="hljs-number">0</span>] = a;&nbsp; &nbsp; }<br>});<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>è¯­æ³•è¯¦è§£</p><ol><li><p><strong>XposedHelpers.findAndHookMethod(â€¦)</strong></p><p> è¿™æ˜¯ Xposed æ¡†æ¶æä¾›çš„ä¸€ä¸ªä¾¿æ·æ–¹æ³•ï¼Œç”¨äºåœ¨æŒ‡å®šçš„ç±»ä¸­æŸ¥æ‰¾å¹¶ hook æŸä¸ªæ–¹æ³•ã€‚</p><ul><li><code>"com.zj.wuaipojie.Demo"</code>ï¼šç›®æ ‡ç±»çš„å…¨é™å®šåï¼Œå³æˆ‘ä»¬è¦ hook çš„ç±»ã€‚</li><li><code>loadPackageParam.classLoader</code>ï¼šç”¨äºåŠ è½½ç›®æ ‡ç±»çš„ç±»åŠ è½½å™¨ï¼Œç¡®ä¿èƒ½æ‰¾åˆ°è¯¥ç±»ã€‚</li><li><code>"a"</code>ï¼šç›®æ ‡æ–¹æ³•çš„åç§°ï¼Œè¡¨ç¤ºè¦ hook çš„æ–¹æ³•åæ˜¯ <code>"a"</code>ã€‚</li><li><code>String.class</code>ï¼šç›®æ ‡æ–¹æ³•çš„å‚æ•°ç±»å‹ï¼Œè¿™é‡Œè¡¨ç¤ºæ–¹æ³• <code>"a"</code> æ¥æ”¶ä¸€ä¸ª <code>String</code> ç±»å‹çš„å‚æ•°ã€‚</li><li><code>new XC_MethodHook() { ... }</code>ï¼šä¼ å…¥ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œç”¨äºå®šä¹‰ hook åçš„å›è°ƒè¡Œä¸ºã€‚</li></ul></li><li><p><strong>beforeHookedMethod å›è°ƒ</strong></p><p> è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨ã€‚å…¶ä¸»è¦ä½œç”¨æ˜¯å…è®¸æˆ‘ä»¬åœ¨åŸæ–¹æ³•è¿è¡Œä¹‹å‰ä¿®æ”¹ä¼ å…¥çš„å‚æ•°æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>    <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-string">"pt"</span>;<br>    param.args[<span class="hljs-number">0</span>] = a;<br>}<br></code></pre></td></tr></tbody></table></figure><ul><li><p><strong>super.beforeHookedMethod(param);</strong></p><p>  è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯ä¸ºäº†ä¿æŒé»˜è®¤è¡Œä¸ºã€‚è¿™ä¸€è¡Œåœ¨å¾ˆå¤šåœºæ™¯ä¸­å¯ä»¥çœç•¥ï¼Œä½†æœ‰æ—¶ä¿ç•™èƒ½ç¡®ä¿æ¡†æ¶å†…éƒ¨é€»è¾‘æ­£å¸¸æ‰§è¡Œã€‚</p></li><li><p><strong>String a = â€œptâ€;</strong></p><p>  å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ <code>a</code>ï¼Œå¹¶èµ‹å€¼ä¸º <code>"pt"</code>ã€‚</p></li><li><p><strong>param.args[0] = a;</strong></p><p>  ä¿®æ”¹äº† <code>param.args</code> æ•°ç»„ä¸­ç´¢å¼•ä¸º 0 çš„å‚æ•°å€¼ï¼ˆå³ä¼ å…¥ç›®æ ‡æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ã€‚åŸæ¥ä¼ å…¥æ–¹æ³•çš„ <code>String</code> å‚æ•°å°†è¢«æ›¿æ¢ä¸º <code>"pt"</code>ã€‚</p><p>  æ¢å¥è¯è¯´ï¼Œæ¯å½“ç›®æ ‡ç±» <code>com.zj.wuaipojie.Demo</code> ä¸­åä¸º <code>"a"</code> çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ— è®ºè°ƒç”¨æ–¹ä¼ é€’çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰è¢«å¼ºåˆ¶æ”¹ä¸º <code>"pt"</code>ã€‚</p></li></ul></li></ol><hr><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><ul><li><strong>ä¿®æ”¹è¡Œä¸º</strong>ï¼šè¿™ç§ hook æŠ€æœ¯å¸¸ç”¨äºä¿®æ”¹åº”ç”¨é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œè‹¥ç›®æ ‡æ–¹æ³•ä¾æ®ä¼ å…¥çš„å­—ç¬¦ä¸²å‚æ•°æ‰§è¡Œä¸åŒæ“ä½œï¼Œæ”¹å˜å‚æ•°å€¼å¯ä»¥ç»•è¿‡æŸäº›æ£€æŸ¥æˆ–æ”¹å˜åŸæœ‰é€»è¾‘ã€‚</li><li><strong>è°ƒè¯•ä¸é€†å‘å·¥ç¨‹</strong>ï¼šåœ¨åˆ†æåº”ç”¨æ—¶ï¼Œé€šè¿‡ä¿®æ”¹æ–¹æ³•å‚æ•°ï¼Œå¯ä»¥è§‚å¯Ÿä¸åŒå‚æ•°å¯¹æ–¹æ³•æ‰§è¡Œç»“æœçš„å½±å“ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£ç¨‹åºå†…éƒ¨æµç¨‹ã€‚</li></ul><hr><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>  è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åœ¨ç›®æ ‡æ–¹æ³• <code>"a"</code> è¢«è°ƒç”¨ä¹‹å‰ï¼Œå°†å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆString ç±»å‹ï¼‰ä¿®æ”¹ä¸ºå›ºå®šå€¼ <code>"pt"</code>ã€‚è¿™ç§æ–¹å¼å…è®¸å¼€å‘è€…åŠ¨æ€æ”¹å˜åº”ç”¨è¡Œä¸ºï¼Œè€Œæ— éœ€ä¿®æ”¹åŸå§‹ä»£ç ï¼Œæ˜¯ Xposed æ¡†æ¶åœ¨é€†å‘å·¥ç¨‹å’ŒåŠ¨æ€è°ƒè¯•ä¸­çš„å¸¸è§ç”¨æ³•ã€‚</p></li></ul><h3 id="2-Hookå¤æ‚-è‡ªå®šä¹‰å‚æ•°"><a href="#2-Hookå¤æ‚-è‡ªå®šä¹‰å‚æ•°" class="headerlink" title="2.Hookå¤æ‚&amp;è‡ªå®šä¹‰å‚æ•°"></a><strong>2.Hookå¤æ‚&amp;è‡ªå®šä¹‰å‚æ•°</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> loadPackageParam.classLoader.loadClass(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>);<br>        XposedBridge.hookAllMethods(a, <span class="hljs-string">"complexParameterFunc"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() { <span class="hljs-comment">//ä¸»è¦ç”¨åˆ°è¯¥æ–¹æ³•å¯ä»¥å…å¡«å‚æ•°ï¼ˆé’ˆå¯¹è‡ªå®šä¹‰å’Œå¤æ‚æ–¹æ³•ï¼‰</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>                Log.d(<span class="hljs-string">"zj2595"</span>,param.args[<span class="hljs-number">0</span>].toString());<br>            }<br>        });<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>æŸ¥æ‰¾Hookå¤æ‚å‡½æ•°çš„ç±»åï¼Œæ–¹æ³•å</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262103920.png"></p><p>  2.ä¿®æ”¹å¥½ç›¸åº”æ•°æ®åï¼Œé€šè¿‡logæ‰“å°è§‚å¯Ÿ</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262104375.png"></p><ul><li><p>è¯­æ³•è§£æ</p><h3 id="1-loadPackageParam-classLoader-loadClass-com-zj-wuaipojie-Demo"><a href="#1-loadPackageParam-classLoader-loadClass-com-zj-wuaipojie-Demo" class="headerlink" title="1. loadPackageParam.classLoader.loadClass(&quot;com.zj.wuaipojie.Demo&quot;)"></a>1. <code>loadPackageParam.classLoader.loadClass("com.zj.wuaipojie.Demo")</code></h3><h3 id="ä½œç”¨ï¼š"><a href="#ä½œç”¨ï¼š" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h3><ul><li><strong>åŠ¨æ€åŠ è½½</strong> <code>com.zj.wuaipojie.Demo</code> ç±»ã€‚</li><li><code>loadPackageParam.classLoader</code> æ˜¯ Xposed æä¾›çš„ <code>ClassLoader</code>ï¼Œç”¨äºåœ¨ Hook ç›®æ ‡ APP æ—¶æ­£ç¡®åŠ è½½ç›®æ ‡ç±»ã€‚</li></ul><h3 id="è§£æï¼š"><a href="#è§£æï¼š" class="headerlink" title="è§£æï¼š"></a>è§£æï¼š</h3><ul><li><code>loadPackageParam</code> æ˜¯ Xposed <code>handleLoadPackage</code> æ–¹æ³•ä¸­çš„å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰ Hook ç›®æ ‡åº”ç”¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li><li><code>loadClass("com.zj.wuaipojie.Demo")</code> åŠ è½½ <code>Demo</code> ç±»ï¼Œè¿”å›ä¸€ä¸ª <code>Class&lt;?&gt;</code> å¯¹è±¡ã€‚</li></ul><hr><h3 id="2-XposedBridge-hookAllMethods-a-complexParameterFunc-new-XC-MethodHook"><a href="#2-XposedBridge-hookAllMethods-a-complexParameterFunc-new-XC-MethodHook" class="headerlink" title="2. XposedBridge.hookAllMethods(a, &quot;complexParameterFunc&quot;, new XC_MethodHook() {...})"></a>2. <code>XposedBridge.hookAllMethods(a, "complexParameterFunc", new XC_MethodHook() {...})</code></h3><h3 id="ä½œç”¨ï¼š-1"><a href="#ä½œç”¨ï¼š-1" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h3><ul><li><strong>Hook</strong> <code>a</code> ç±»ä¸­æ‰€æœ‰åä¸º <code>complexParameterFunc</code> çš„æ–¹æ³•ï¼Œæ— è®ºå…¶å‚æ•°ç±»å‹å’Œè¿”å›å€¼æ˜¯ä»€ä¹ˆã€‚</li><li><code>XC_MethodHook</code> å…è®¸æˆ‘ä»¬åœ¨æ–¹æ³• <strong>æ‰§è¡Œå‰ï¼ˆbeforeHookedMethodï¼‰æˆ–æ‰§è¡Œåï¼ˆafterHookedMethodï¼‰</strong> è¿›è¡Œæ“ä½œã€‚</li></ul><h3 id="è§£æï¼š-1"><a href="#è§£æï¼š-1" class="headerlink" title="è§£æï¼š"></a>è§£æï¼š</h3><ul><li><code>XposedBridge.hookAllMethods(Class&lt;?&gt; hookClass, String methodName, XC_MethodHook callback)</code><ul><li><strong><code>hookClass</code></strong>ï¼šéœ€è¦ Hook çš„ç±»å¯¹è±¡ï¼Œå³ <code>a</code>ã€‚</li><li><strong><code>methodName</code></strong>ï¼šè¦ Hook çš„æ–¹æ³•åï¼Œæ­¤å¤„æ˜¯ <code>"complexParameterFunc"</code>ã€‚</li><li><strong><code>callback</code></strong>ï¼šä¸€ä¸ª <code>XC_MethodHook</code> å®ä¾‹ï¼ŒåŒ…å« <code>beforeHookedMethod</code> å’Œ <code>afterHookedMethod</code> ä¸¤ä¸ªå¯é‡å†™çš„æ–¹æ³•ã€‚</li></ul></li></ul><hr><h3 id="3-beforeHookedMethod-MethodHookParam-param-throws-Throwable"><a href="#3-beforeHookedMethod-MethodHookParam-param-throws-Throwable" class="headerlink" title="3. beforeHookedMethod(MethodHookParam param) throws Throwable"></a>3. <code>beforeHookedMethod(MethodHookParam param) throws Throwable</code></h3><h3 id="ä½œç”¨ï¼š-2"><a href="#ä½œç”¨ï¼š-2" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h3><ul><li>åœ¨ <code>complexParameterFunc</code> <strong>æ‰§è¡Œä¹‹å‰</strong> æ‰§è¡Œ <code>beforeHookedMethod</code> æ–¹æ³•ã€‚</li><li>å¯ä»¥ä¿®æ”¹å‚æ•°ã€é˜»æ­¢æ–¹æ³•æ‰§è¡Œã€è·å–æ–¹æ³•çš„è¾“å…¥å‚æ•°ç­‰ã€‚</li></ul><h3 id="è§£æï¼š-2"><a href="#è§£æï¼š-2" class="headerlink" title="è§£æï¼š"></a>è§£æï¼š</h3><ul><li><strong><code>MethodHookParam param</code></strong><ul><li>ä¼ é€’ç»™ Hook æ–¹æ³•çš„ <strong>å‚æ•°ä¿¡æ¯</strong>ã€‚</li><li><code>param.args</code>ï¼šå­˜å‚¨æ–¹æ³•çš„æ‰€æœ‰å‚æ•°ï¼Œ<code>param.args[0]</code> æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li><li><code>param.thisObject</code>ï¼šå¦‚æœ Hook çš„æ˜¯å®ä¾‹æ–¹æ³•ï¼Œè¿™ä¸ªå­—æ®µè¡¨ç¤ºè¯¥æ–¹æ³•æ‰€å±çš„å¯¹è±¡ã€‚</li><li><code>param.setResult(Object obj)</code>ï¼šç›´æ¥ä¿®æ”¹æ–¹æ³•è¿”å›å€¼ï¼Œä½¿åŸæ–¹æ³•ä¸æ‰§è¡Œï¼Œè¿”å› <code>obj</code>ã€‚</li></ul></li></ul><hr><h3 id="4-Log-d-zj2595-param-args-0-toString"><a href="#4-Log-d-zj2595-param-args-0-toString" class="headerlink" title="4. Log.d(&quot;zj2595&quot;, param.args[0].toString());"></a>4. <code>Log.d("zj2595", param.args[0].toString());</code></h3><h3 id="ä½œç”¨ï¼š-3"><a href="#ä½œç”¨ï¼š-3" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h3><ul><li>é€šè¿‡ <code>Log.d</code> æ‰“å° <code>complexParameterFunc</code> æ–¹æ³•çš„ <strong>ç¬¬ä¸€ä¸ªå‚æ•°å€¼</strong>ï¼Œç”¨äºè°ƒè¯•æˆ–åˆ†æç›®æ ‡åº”ç”¨çš„è¡Œä¸ºã€‚</li></ul><h3 id="è§£æï¼š-3"><a href="#è§£æï¼š-3" class="headerlink" title="è§£æï¼š"></a>è§£æï¼š</h3><ul><li><code>param.args[0]</code>ï¼šè·å– <code>complexParameterFunc</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li><li><code>.toString()</code>ï¼šå°†å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œé¿å…ç›´æ¥æ‰“å°å¯¹è±¡å¯¼è‡´ <code>logcat</code> æ˜¾ç¤º <code>null</code> æˆ– <code>Object@hexcode</code>ã€‚</li></ul><hr><h3 id="5-super-beforeHookedMethod-param"><a href="#5-super-beforeHookedMethod-param" class="headerlink" title="5. super.beforeHookedMethod(param);"></a>5. <code>super.beforeHookedMethod(param);</code></h3><h3 id="ä½œç”¨ï¼š-4"><a href="#ä½œç”¨ï¼š-4" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h3><ul><li>è°ƒç”¨ <code>XC_MethodHook</code> çš„ <code>beforeHookedMethod</code>ï¼Œé€šå¸¸ç”¨äº <strong>ä¿æŒé»˜è®¤è¡Œä¸º</strong>ï¼Œä½†åœ¨ Xposed ä¸­ <strong>å¯ä»¥çœç•¥</strong>ï¼Œä¸ä¼šå½±å“ Hook é€»è¾‘ã€‚</li></ul><hr><h3 id="ä»£ç çš„æ ¸å¿ƒä½œç”¨"><a href="#ä»£ç çš„æ ¸å¿ƒä½œç”¨" class="headerlink" title="ä»£ç çš„æ ¸å¿ƒä½œç”¨"></a><strong>ä»£ç çš„æ ¸å¿ƒä½œç”¨</strong></h3><ol><li><strong>æ‰¾åˆ°</strong> ç›®æ ‡åº”ç”¨ <code>com.zj.wuaipojie.Demo</code> ç±»ã€‚</li><li><strong>Hook</strong> å…¶ <code>complexParameterFunc</code> æ–¹æ³•ï¼ˆå¯èƒ½æœ‰å¤šä¸ªé‡è½½ï¼‰ã€‚</li><li><strong>åœ¨æ–¹æ³•æ‰§è¡Œå‰</strong>ï¼Œæ‰“å°ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œä¾¿äºåˆ†æåº”ç”¨è¡Œä¸ºæˆ–è¿›ä¸€æ­¥ä¿®æ”¹å‚æ•°ã€‚</li></ol><h3 id="å…³é”®-Xposed-API"><a href="#å…³é”®-Xposed-API" class="headerlink" title="å…³é”® Xposed API"></a><strong>å…³é”® Xposed API</strong></h3><table><thead><tr><th>æ–¹æ³•</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>loadClass("com.xxx")</code></td><td>é€šè¿‡ <code>ClassLoader</code> åŠ è½½ç±»</td></tr><tr><td><code>hookAllMethods(Class, String, XC_MethodHook)</code></td><td>Hook ç›®æ ‡ç±»ä¸­æ‰€æœ‰æŒ‡å®šåç§°çš„æ–¹æ³•</td></tr><tr><td><code>beforeHookedMethod(MethodHookParam param)</code></td><td>åœ¨æ–¹æ³•æ‰§è¡Œå‰æ‹¦æˆªï¼Œå¯ä¿®æ”¹å‚æ•°æˆ–é˜»æ­¢æ‰§è¡Œ</td></tr><tr><td><code>param.args[n]</code></td><td>è·å–/ä¿®æ”¹æ–¹æ³•å‚æ•°</td></tr><tr><td><code>param.setResult(Object obj)</code></td><td>ä¿®æ”¹æ–¹æ³•è¿”å›å€¼å¹¶è·³è¿‡åŸæ–¹æ³•æ‰§è¡Œ</td></tr></tbody></table><h3 id="é€†å‘å¯¹æŠ—ä¸åŠ å›ºå»ºè®®"><a href="#é€†å‘å¯¹æŠ—ä¸åŠ å›ºå»ºè®®" class="headerlink" title="é€†å‘å¯¹æŠ—ä¸åŠ å›ºå»ºè®®"></a><strong>é€†å‘å¯¹æŠ—ä¸åŠ å›ºå»ºè®®</strong></h3><p>  è‹¥ä½ æ˜¯åº”ç”¨å¼€å‘è€…ï¼Œå¯é‡‡å–ä»¥ä¸‹æªæ–½é˜²æ­¢æ­¤ç±»Hookï¼š</p><ol><li><p><strong>ä»£ç æ··æ·†</strong>ï¼š</p><p> æ··æ·†æ–¹æ³•åå’Œå‚æ•°åï¼Œå¢åŠ å®šä½éš¾åº¦ã€‚</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span> { <span class="hljs-comment">// åŸå§‹ç±»å Demo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">b</span><span class="hljs-params">(String c)</span> { <span class="hljs-comment">// åŸå§‹æ–¹æ³•å complexParameterFunc</span><br>        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span><br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>å‚æ•°æ ¡éªŒé€»è¾‘</strong>ï¼š</p><p> åœ¨æ–¹æ³•å†…éƒ¨æ ¡éªŒå‚æ•°åˆæ³•æ€§ã€‚</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">complexParameterFunc</span><span class="hljs-params">(String input)</span> {<br>    <span class="hljs-keyword">if</span> (input == <span class="hljs-literal">null</span> || input.length() &lt; <span class="hljs-number">8</span>) {<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•å‚æ•°"</span>);<br>    }<br>    <span class="hljs-comment">// æ­£å¸¸é€»è¾‘</span><br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>è¿è¡Œæ—¶ç¯å¢ƒæ£€æµ‹</strong>ï¼š</p><p> æ£€æµ‹Xposedæ¡†æ¶å­˜åœ¨æ€§ã€‚</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isXposedActive</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">try</span> {<br>        Class.forName(<span class="hljs-string">"de.robv.android.xposed.XposedBridge"</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li></ol></li></ul><ol><li>æŸ¥çœ‹ä»£ç å‘ç°stringæ˜¯æˆ‘ä»¬æ‰“å°å‡ºæ¥çš„å‚æ•°å€¼ï¼ŒåŒç†å¯ä»¥ç”¨ä¸Šè¿°æ™®é€šæ–¹æ³•çš„Hookè¿›è¡Œå‚æ•°ä¿®æ”¹</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262104386.png"></p></li></ul><h3 id="3-Hookæ›¿æ¢å‡½æ•°"><a href="#3-Hookæ›¿æ¢å‡½æ•°" class="headerlink" title="3.Hookæ›¿æ¢å‡½æ•°"></a><strong>3.Hookæ›¿æ¢å‡½æ•°</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> loadPackageParam.classLoader.loadClass(<span class="hljs-string">"ç±»å"</span>);<br>        XposedBridge.hookAllMethods(a,<span class="hljs-string">"æ–¹æ³•å"</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodReplacement</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">replaceHookedMethod</span><span class="hljs-params">(MethodHookParam methodHookParam)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;<br>            }<br>        });<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><p>  1.åŒç†å¾—åˆ°æ›¿æ¢å‡½æ•°çš„åŒ…åï¼Œæ–¹æ³•å</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262104187.png"></p><p>  2.æˆ‘ä»¬å®Œå…¨æ›¿æ¢ ç›®æ ‡æ–¹æ³• <code>repleaceFunc</code> çš„å®ç°ï¼Œä½¿å…¶å§‹ç»ˆè¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸² </p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262104942.png"></p><ul><li><p>è¯­æ³•è¯¦è§£</p><h3 id="ğŸ“Œ-ä»£ç è§£æ"><a href="#ğŸ“Œ-ä»£ç è§£æ" class="headerlink" title="ğŸ“Œ ä»£ç è§£æ"></a><strong>ğŸ“Œ ä»£ç è§£æ</strong></h3><h3 id="1-åŠ è½½ç›®æ ‡ç±»"><a href="#1-åŠ è½½ç›®æ ‡ç±»" class="headerlink" title="1. åŠ è½½ç›®æ ‡ç±»"></a><strong>1. åŠ è½½ç›®æ ‡ç±»</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> loadPackageParam.classLoader.loadClass(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>);<br></code></pre></td></tr></tbody></table></figure><p>  <strong>ä½œç”¨</strong></p><ul><li>é€šè¿‡ <strong>ClassLoader</strong> åŠ¨æ€åŠ è½½ <code>com.zj.wuaipojie.Demo</code> ç±»ã€‚</li><li><code>loadPackageParam.classLoader</code> æ˜¯ Xposed æä¾›çš„ ClassLoaderï¼Œç¡®ä¿èƒ½å¤Ÿæ­£ç¡®åŠ è½½ Hook ç›®æ ‡åº”ç”¨ä¸­çš„ç±»ã€‚</li></ul><hr><h3 id="2-Hook-ç›®æ ‡æ–¹æ³•"><a href="#2-Hook-ç›®æ ‡æ–¹æ³•" class="headerlink" title="2. Hook ç›®æ ‡æ–¹æ³•"></a><strong>2. Hook ç›®æ ‡æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedBridge.hookAllMethods(a, <span class="hljs-string">"repleaceFunc"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodReplacement</span>() {...});<br></code></pre></td></tr></tbody></table></figure><p>  <strong>ä½œç”¨</strong></p><ul><li><strong>Hook <code>repleaceFunc</code> æ–¹æ³•çš„æ‰€æœ‰é‡è½½ç‰ˆæœ¬</strong>ã€‚</li><li>ä½¿ç”¨ <code>XC_MethodReplacement</code> <strong>å®Œå…¨æ›¿æ¢</strong> ç›®æ ‡æ–¹æ³•ï¼Œä½¿å…¶ä¸æ‰§è¡ŒåŸæ¥çš„é€»è¾‘ï¼Œè€Œæ˜¯æ‰§è¡Œ <code>replaceHookedMethod</code> æ–¹æ³•ã€‚</li></ul><hr><h3 id="3-æ›¿æ¢æ–¹æ³•é€»è¾‘"><a href="#3-æ›¿æ¢æ–¹æ³•é€»è¾‘" class="headerlink" title="3. æ›¿æ¢æ–¹æ³•é€»è¾‘"></a><strong>3. æ›¿æ¢æ–¹æ³•é€»è¾‘</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">replaceHookedMethod</span><span class="hljs-params">(MethodHookParam methodHookParam)</span> <span class="hljs-keyword">throws</span> Throwable {<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;<br>}<br></code></pre></td></tr></tbody></table></figure><p>  <strong>ä½œç”¨</strong></p><ul><li><code>replaceHookedMethod</code> ç›´æ¥è¿”å› <code>""</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ã€‚</li><li><strong>æ— è®º <code>repleaceFunc</code> åŸæœ¬çš„å®ç°æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šè¢«æ­¤é€»è¾‘å–ä»£</strong>ã€‚</li></ul><hr><h3 id="ğŸ”-æ·±å…¥è§£æï¼šXposed-API"><a href="#ğŸ”-æ·±å…¥è§£æï¼šXposed-API" class="headerlink" title="ğŸ” æ·±å…¥è§£æï¼šXposed API"></a><strong>ğŸ” æ·±å…¥è§£æï¼šXposed API</strong></h3><h3 id="ğŸ”¹-XposedBridge-hookAllMethods-Class-String-XC-MethodReplacement"><a href="#ğŸ”¹-XposedBridge-hookAllMethods-Class-String-XC-MethodReplacement" class="headerlink" title="ğŸ”¹ XposedBridge.hookAllMethods(Class, String, XC_MethodReplacement)"></a><strong>ğŸ”¹ <code>XposedBridge.hookAllMethods(Class, String, XC_MethodReplacement)</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šHook <strong>æ‰€æœ‰</strong> åä¸º <code>repleaceFunc</code> çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬ä¸åŒå‚æ•°çš„é‡è½½ï¼‰ã€‚</li><li><strong>åŒºåˆ«</strong>ï¼š<ul><li><code>XC_MethodHook</code> <strong>ä¸ä¼šæ”¹å˜åŸå§‹æ–¹æ³•çš„æ‰§è¡Œé€»è¾‘</strong>ï¼Œåªèƒ½åœ¨ <strong>æ‰§è¡Œå‰/å</strong> è¿›è¡Œæ‹¦æˆªã€‚</li><li><code>XC_MethodReplacement</code> <strong>å®Œå…¨æ›¿æ¢åŸå§‹æ–¹æ³•</strong>ï¼Œä½¿å…¶ä¸å†æ‰§è¡ŒåŸæœ‰ä»£ç ï¼Œè€Œæ˜¯æ‰§è¡Œ <code>replaceHookedMethod</code>ã€‚</li></ul></li></ul><hr><h3 id="ğŸ”¹-replaceHookedMethod-MethodHookParam-param"><a href="#ğŸ”¹-replaceHookedMethod-MethodHookParam-param" class="headerlink" title="ğŸ”¹ replaceHookedMethod(MethodHookParam param)"></a><strong>ğŸ”¹ <code>replaceHookedMethod(MethodHookParam param)</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šå®Œå…¨å–ä»£ç›®æ ‡æ–¹æ³•çš„å®ç°é€»è¾‘ã€‚</li><li><strong>è¿”å›å€¼</strong>ï¼šç›´æ¥ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ï¼ŒåŸæ–¹æ³• <strong>ä¸ä¼šæ‰§è¡Œ</strong>ã€‚</li></ul><p>  <strong>ç¤ºä¾‹</strong></p><p>  å‡è®¾ <code>repleaceFunc</code> æ–¹æ³•åœ¨ <code>Demo</code> ç±»ä¸­çš„åŸå§‹ä»£ç å¦‚ä¸‹ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">repleaceFunc</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, World!"</span>;<br>}<br></code></pre></td></tr></tbody></table></figure><p>  åœ¨ Hook ä¹‹åï¼Œè¯¥æ–¹æ³•ä¼šå§‹ç»ˆè¿”å› <code>""</code>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Demo</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>();<br>System.out.println(demo.repleaceFunc());  <span class="hljs-comment">// è¾“å‡ºï¼š""</span><br></code></pre></td></tr></tbody></table></figure><p>  å³ä½¿ <code>repleaceFunc</code> ä¹‹å‰å¯èƒ½åŒ…å«å¤æ‚é€»è¾‘ï¼Œä¾‹å¦‚è®¿é—®æ•°æ®åº“ã€è¿›è¡Œè®¡ç®—ã€è¿”å›åŠ¨æ€å†…å®¹ï¼Œå®ƒä»¬éƒ½ä¼šè¢« <strong>å®Œå…¨è·³è¿‡</strong>ã€‚</p><hr><h3 id="ğŸ“Œ-æ€»ç»“"><a href="#ğŸ“Œ-æ€»ç»“" class="headerlink" title="ğŸ“Œ æ€»ç»“"></a><strong>ğŸ“Œ æ€»ç»“</strong></h3><table><thead><tr><th>ä»£ç éƒ¨åˆ†</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>loadPackageParam.classLoader.loadClass("com.zj.wuaipojie.Demo")</code></td><td>åŠ è½½ç›®æ ‡ç±»</td></tr><tr><td><code>XposedBridge.hookAllMethods(Class, String, XC_MethodReplacement)</code></td><td>Hook ç›®æ ‡æ–¹æ³•å¹¶å®Œå…¨æ›¿æ¢</td></tr><tr><td><code>replaceHookedMethod(MethodHookParam param)</code></td><td>å®šä¹‰æ–°çš„æ–¹æ³•é€»è¾‘ï¼Œ<strong>ä¸æ‰§è¡ŒåŸæ–¹æ³•</strong></td></tr><tr><td><code>return ""</code></td><td>è®©æ–¹æ³•å§‹ç»ˆè¿”å› <code>""</code></td></tr></tbody></table><h3 id="ğŸ”¥-é€‚ç”¨åœºæ™¯"><a href="#ğŸ”¥-é€‚ç”¨åœºæ™¯" class="headerlink" title="ğŸ”¥ é€‚ç”¨åœºæ™¯"></a><strong>ğŸ”¥ é€‚ç”¨åœºæ™¯</strong></h3><p>  âœ… <strong>ä¿®æ”¹è¿”å›å€¼</strong>ï¼ˆä¾‹å¦‚ï¼šè®©æŸä¸ªæ–¹æ³•å§‹ç»ˆè¿”å› <code>true/false</code>ã€0 æˆ–è€…ç©ºå­—ç¬¦ä¸²ï¼‰</p><p>  âœ… <strong>è·³è¿‡æŸäº›åŠŸèƒ½</strong>ï¼ˆä¾‹å¦‚ï¼šé˜»æ­¢æœåŠ¡å™¨è¯·æ±‚ã€å»é™¤å¹¿å‘Šã€ç»•è¿‡æ ¡éªŒï¼‰</p><p>  âœ… <strong>æé«˜æ€§èƒ½</strong>ï¼ˆå¦‚æœæ–¹æ³•æ‰§è¡Œçš„æ˜¯ä¸å¿…è¦çš„å¤æ‚é€»è¾‘ï¼Œå¯ä»¥ç›´æ¥è¿”å›å›ºå®šå€¼ï¼‰</p><hr><h1 id="âš ï¸-æ³¨æ„äº‹é¡¹"><a href="#âš ï¸-æ³¨æ„äº‹é¡¹" class="headerlink" title="âš ï¸ æ³¨æ„äº‹é¡¹"></a><strong>âš ï¸ æ³¨æ„äº‹é¡¹</strong></h1><ol><li><p><strong>ç¡®ä¿ç›®æ ‡æ–¹æ³•è¿”å›ç±»å‹åŒ¹é…</strong></p><ul><li><p><code>return ""</code> é€‚ç”¨äº <strong>è¿”å› <code>String</code> ç±»å‹</strong> çš„æ–¹æ³•ã€‚</p></li><li><p>å¦‚æœæ–¹æ³•è¿”å› <code>int</code>ï¼Œéœ€è¦è¿”å› <code>0</code>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></tbody></table></figure></li><li><p>å¦‚æœè¿”å› <code>boolean</code>ï¼Œéœ€è¦è¿”å› <code>true</code> æˆ– <code>false</code>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br></code></pre></td></tr></tbody></table></figure></li></ul></li><li><p><strong>é¿å… Hook å…³é”®ç³»ç»Ÿæ–¹æ³•</strong></p><ul><li>Hook å…³é”® APIï¼ˆå¦‚ <code>System.exit()</code>ã€<code>Application.onCreate()</code>ï¼‰å¯èƒ½å¯¼è‡´ APP <strong>å´©æºƒ</strong>ã€‚</li></ul></li><li><p><strong>ç¡®ä¿ <code>repleaceFunc</code> æ–¹æ³•å­˜åœ¨</strong></p><ul><li>å¦‚æœ <code>Demo</code> ç±»ä¸­æ²¡æœ‰ <code>repleaceFunc</code>ï¼ŒHook <strong>ä¸ä¼šç”Ÿæ•ˆ</strong>ï¼Œå¯èƒ½å¯¼è‡´æ—¥å¿—æŠ¥é”™ã€‚</li></ul></li></ol><hr><h3 id="ğŸš€-å®æˆ˜æ¡ˆä¾‹"><a href="#ğŸš€-å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="ğŸš€ å®æˆ˜æ¡ˆä¾‹"></a><strong>ğŸš€ å®æˆ˜æ¡ˆä¾‹</strong></h3><h3 id="1ï¸âƒ£-ç»•è¿‡åº”ç”¨-VIP-é™åˆ¶"><a href="#1ï¸âƒ£-ç»•è¿‡åº”ç”¨-VIP-é™åˆ¶" class="headerlink" title="1ï¸âƒ£ ç»•è¿‡åº”ç”¨ VIP é™åˆ¶"></a><strong>1ï¸âƒ£ ç»•è¿‡åº”ç”¨ VIP é™åˆ¶</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedBridge.hookAllMethods(a, <span class="hljs-string">"isVipUser"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodReplacement</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">replaceHookedMethod</span><span class="hljs-params">(MethodHookParam methodHookParam)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// å¼ºåˆ¶è¿”å› trueï¼Œè®©æ‰€æœ‰ç”¨æˆ·å˜æˆ VIP</span><br>    }<br>});<br></code></pre></td></tr></tbody></table></figure><h3 id="2ï¸âƒ£-ç¦æ­¢-APP-é€€å‡º"><a href="#2ï¸âƒ£-ç¦æ­¢-APP-é€€å‡º" class="headerlink" title="2ï¸âƒ£ ç¦æ­¢ APP é€€å‡º"></a><strong>2ï¸âƒ£ ç¦æ­¢ APP é€€å‡º</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedBridge.hookAllMethods(System.class, <span class="hljs-string">"exit"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodReplacement</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">replaceHookedMethod</span><span class="hljs-params">(MethodHookParam methodHookParam)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// ç›´æ¥è·³è¿‡ System.exit()ï¼Œé˜²æ­¢ APP é€€å‡º</span><br>    }<br>});<br></code></pre></td></tr></tbody></table></figure><h3 id="é€†å‘å¯¹æŠ—ä¸é˜²æŠ¤"><a href="#é€†å‘å¯¹æŠ—ä¸é˜²æŠ¤" class="headerlink" title="é€†å‘å¯¹æŠ—ä¸é˜²æŠ¤"></a><strong>é€†å‘å¯¹æŠ—ä¸é˜²æŠ¤</strong></h3><p>  è‹¥ä½ æ˜¯åº”ç”¨å¼€å‘è€…ï¼Œå¯é‡‡å–ä»¥ä¸‹é˜²æŠ¤æªæ–½ï¼š</p><ol><li><p><strong>æ–¹æ³•ç­¾åæ··æ·†</strong></p><p> æ··æ·†æ–¹æ³•åå’Œå‚æ•°ç±»å‹ï¼Œå¢åŠ å®šä½éš¾åº¦ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span> { <span class="hljs-comment">// åŸç±»å Demo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">b</span><span class="hljs-params">()</span> { <span class="hljs-comment">// åŸæ–¹æ³•å replaceFunc</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•æ„Ÿæ•°æ®"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>è¿”å›å€¼æ ¡éªŒ</strong></p><p> åœ¨è°ƒç”¨å¤„å¢åŠ äºŒæ¬¡æ ¡éªŒé€»è¾‘ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> replaceFunc();<br><span class="hljs-keyword">if</span> (result.hashCode() != <span class="hljs-number">0x12345678</span>) { <span class="hljs-comment">// æ ¡éªŒå“ˆå¸Œå€¼</span><br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"è¿”å›å€¼è¢«ç¯¡æ”¹"</span>);<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>Nativeå±‚å®ç°</strong></p><p> å°†æ ¸å¿ƒé€»è¾‘ç§»è‡³Nativeå±‚ï¼ˆC/C++ï¼‰ï¼Œé™ä½è¢«Xposed Hookçš„æ¦‚ç‡ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> String <span class="hljs-title function_">replaceFunc</span><span class="hljs-params">()</span>; <span class="hljs-comment">// JNI å®ç°</span><br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>ç¯å¢ƒæ£€æµ‹</strong></p><p> æ£€æµ‹Xposedæ¡†æ¶å­˜åœ¨æ€§ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHooked</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">try</span> {<br>        <span class="hljs-keyword">return</span> XposedBridge.getXposedVersion() != <span class="hljs-literal">null</span>;<br>    } <span class="hljs-keyword">catch</span> (Throwable ignored) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li></ol></li></ul></li></ul><h3 id="4-HookåŠ å›ºé€šæ€"><a href="#4-HookåŠ å›ºé€šæ€" class="headerlink" title="4.HookåŠ å›ºé€šæ€"></a><strong>4.HookåŠ å›ºé€šæ€</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(Application.class, <span class="hljs-string">"attach"</span>, Context.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> (Context) param.args[<span class="hljs-number">0</span>];<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> context.getClassLoader();<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//hooké€»è¾‘åœ¨è¿™é‡Œé¢å†™</span><br>&nbsp; &nbsp; }<br>});<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>Hook <code>Application.attach()</code> æ–¹æ³•ï¼Œå¹¶åœ¨ <code>attach</code> æ‰§è¡Œå®Œæˆåæ‰§è¡Œè‡ªå®šä¹‰çš„ Hook é€»è¾‘ã€‚å®ƒé€šå¸¸ç”¨äº åœ¨ç›®æ ‡åº”ç”¨çš„ <code>attach</code> é˜¶æ®µè·å– <code>Context</code> å’Œ <code>ClassLoader</code>ï¼Œä»¥ä¾¿ Hook ç›®æ ‡åº”ç”¨çš„ç±»ã€‚å¿…é¡»è¦å°†<code>classLoader</code> ä¼ å…¥è¿›å»æ‰èƒ½é€šè¿‡<code>Application</code>è·å–<code>classLoader</code>ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262105799.png"></p><ul><li><p>ä»£ç è¯¦è§£</p><h3 id="ğŸ“Œ-ä»£ç è§£æ-1"><a href="#ğŸ“Œ-ä»£ç è§£æ-1" class="headerlink" title="ğŸ“Œ ä»£ç è§£æ"></a><strong>ğŸ“Œ ä»£ç è§£æ</strong></h3><h3 id="1ï¸âƒ£-Hook-Application-attach-æ–¹æ³•"><a href="#1ï¸âƒ£-Hook-Application-attach-æ–¹æ³•" class="headerlink" title="1ï¸âƒ£ Hook Application.attach() æ–¹æ³•"></a><strong>1ï¸âƒ£ Hook <code>Application.attach()</code> æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(Application.class, <span class="hljs-string">"attach"</span>, Context.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {...});<br></code></pre></td></tr></tbody></table></figure><p>  <strong>ä½œç”¨</strong>ï¼š</p><ul><li><code>findAndHookMethod()</code> ç”¨äº <strong>ç²¾å‡† Hook æŒ‡å®šç±»çš„ç‰¹å®šæ–¹æ³•</strong>ã€‚</li><li>è¿™é‡Œ Hook çš„æ˜¯ <code>android.app.Application</code> ç±»çš„ <code>attach(Context context)</code> æ–¹æ³•ã€‚</li><li>ç”±äº <code>attach()</code> åœ¨åº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ï¼Œå› æ­¤ <strong>å¯ä»¥åœ¨è¿™é‡Œè·å– <code>Context</code> å’Œ <code>ClassLoader</code>ï¼Œä»¥ä¾¿ Hook ç›®æ ‡åº”ç”¨çš„ç±»</strong>ã€‚</li></ul><p>  <strong>ä¸ºä»€ä¹ˆè¦ Hook <code>attach(Context context)</code>ï¼Ÿ</strong></p><ul><li>è®¸å¤šåº”ç”¨ä¼šä½¿ç”¨ <strong>è‡ªå®šä¹‰çš„ <code>ClassLoader</code></strong>ï¼Œå¦‚æœåœ¨ <code>handleLoadPackage()</code> é‡Œç›´æ¥ Hook æŸäº›ç±»ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼ˆå› ä¸ºç±»è¿˜æ²¡åŠ è½½ï¼‰ã€‚</li><li><code>attach()</code> æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œåº”ç”¨çš„ <code>Context</code> å’Œ <code>ClassLoader</code> å·²ç»åˆå§‹åŒ–ï¼ŒHook é€»è¾‘å¯ä»¥å®‰å…¨æ‰§è¡Œã€‚</li></ul><hr><h3 id="2ï¸âƒ£-afterHookedMethod-æ–¹æ³•"><a href="#2ï¸âƒ£-afterHookedMethod-æ–¹æ³•" class="headerlink" title="2ï¸âƒ£ afterHookedMethod() æ–¹æ³•"></a><strong>2ï¸âƒ£ <code>afterHookedMethod()</code> æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>    <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> (Context) param.args[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> context.getClassLoader();<br>    <span class="hljs-comment">//hooké€»è¾‘åœ¨è¿™é‡Œé¢å†™</span><br>}<br></code></pre></td></tr></tbody></table></figure><p>  <strong>è§£æ</strong>ï¼š</p><ul><li><code>afterHookedMethod()</code> ä»£è¡¨ <strong>åœ¨åŸæ–¹æ³•æ‰§è¡Œå®Œæ¯•å</strong> æ‰§è¡Œ Hook é€»è¾‘ã€‚</li><li><code>param.args[0]</code> è·å– <code>attach()</code> æ–¹æ³•çš„ <code>Context</code> å‚æ•°ï¼Œè¿™ä¸ª <code>Context</code> æ˜¯ <strong>åº”ç”¨çš„ <code>Context</code></strong>ï¼Œç”¨äºåŠ è½½èµ„æºã€è®¿é—®ç³»ç»ŸæœåŠ¡ç­‰ã€‚</li><li><code>context.getClassLoader()</code> è·å–å½“å‰åº”ç”¨çš„ <code>ClassLoader</code>ï¼Œç”¨äºåç»­ <strong>åŠ¨æ€åŠ è½½å’Œ Hook ç›®æ ‡ç±»</strong>ã€‚</li></ul><hr><h3 id="ğŸ“Œ-ä»£ç æ‰§è¡Œæµç¨‹"><a href="#ğŸ“Œ-ä»£ç æ‰§è¡Œæµç¨‹" class="headerlink" title="ğŸ“Œ ä»£ç æ‰§è¡Œæµç¨‹"></a><strong>ğŸ“Œ ä»£ç æ‰§è¡Œæµç¨‹</strong></h3><p>  1ï¸âƒ£ <code>Application.attach()</code> è¢«ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>  2ï¸âƒ£ Xposed Hook è¯¥æ–¹æ³•ï¼Œåœ¨ <strong>æ–¹æ³•æ‰§è¡Œå®Œæ¯•å</strong> è·å– <code>Context</code> å’Œ <code>ClassLoader</code>ã€‚</p><p>  3ï¸âƒ£ åœ¨ <code>afterHookedMethod()</code> é‡Œæ‰§è¡Œ Hook é€»è¾‘ï¼Œæ¯”å¦‚ Hook ç›®æ ‡ç±»çš„æ–¹æ³•ã€‚</p><hr><h3 id="ğŸ”¥-é€‚ç”¨åœºæ™¯-1"><a href="#ğŸ”¥-é€‚ç”¨åœºæ™¯-1" class="headerlink" title="ğŸ”¥ é€‚ç”¨åœºæ™¯"></a><strong>ğŸ”¥ é€‚ç”¨åœºæ™¯</strong></h3><p>  âœ… <strong>Hook ç›®æ ‡åº”ç”¨çš„ç±»</strong></p><p>  âœ… <strong>ç»•è¿‡ <code>loadClass</code> é™åˆ¶</strong>ï¼ˆæœ‰äº›åº”ç”¨ä½¿ç”¨è‡ªå®šä¹‰ <code>ClassLoader</code>ï¼Œå¦‚æœä¸ Hook <code>attach()</code> å¯èƒ½æ— æ³•æ­£ç¡®åŠ è½½ç±»ï¼‰</p><p>  âœ… <strong>åŠ¨æ€åˆ†æåº”ç”¨è¡Œä¸º</strong>ï¼ˆä¾‹å¦‚ Hook <code>WebView</code>ã€æ‹¦æˆªç½‘ç»œè¯·æ±‚ç­‰ï¼‰</p><p>  âœ… <strong>é€†å‘ç ´è§£</strong>ï¼ˆæ¯”å¦‚ Hook ç™»å½•éªŒè¯é€»è¾‘ã€ä¿®æ”¹è¿”å›å€¼ç­‰ï¼‰</p><hr><h3 id="ğŸš€-è¿›é˜¶åº”ç”¨ç¤ºä¾‹"><a href="#ğŸš€-è¿›é˜¶åº”ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸš€ è¿›é˜¶åº”ç”¨ç¤ºä¾‹"></a><strong>ğŸš€ è¿›é˜¶åº”ç”¨ç¤ºä¾‹</strong></h3><h3 id="1ï¸âƒ£-Hook-ç›®æ ‡åº”ç”¨çš„æ–¹æ³•"><a href="#1ï¸âƒ£-Hook-ç›®æ ‡åº”ç”¨çš„æ–¹æ³•" class="headerlink" title="1ï¸âƒ£ Hook ç›®æ ‡åº”ç”¨çš„æ–¹æ³•"></a><strong>1ï¸âƒ£ Hook ç›®æ ‡åº”ç”¨çš„æ–¹æ³•</strong></h3><p>  å‡è®¾è¦ Hook <code>com.zj.wuaipojie.Demo</code> ç±»çš„ <code>getData()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>attach()</code> é‡Œæ‰§è¡Œ Hook é€»è¾‘ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(Application.class, <span class="hljs-string">"attach"</span>, Context.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> (Context) param.args[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> context.getClassLoader();<br><br>        XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, classLoader, <span class="hljs-string">"getData"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                XposedBridge.log(<span class="hljs-string">"Hooked getData() before execution"</span>);<br>            }<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                XposedBridge.log(<span class="hljs-string">"Original return value: "</span> + param.getResult());<br>                param.setResult(<span class="hljs-string">"Hooked Data!"</span>); <span class="hljs-comment">// ä¿®æ”¹è¿”å›å€¼</span><br>            }<br>        });<br>    }<br>});<br><br></code></pre></td></tr></tbody></table></figure><p>  ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šHook <code>com.zj.wuaipojie.Demo.getData()</code>ï¼Œå¹¶ä¿®æ”¹è¿”å›å€¼ã€‚</p><hr><h3 id="2ï¸âƒ£-Hook-WebView-è¿›è¡Œ-JS-æ³¨å…¥"><a href="#2ï¸âƒ£-Hook-WebView-è¿›è¡Œ-JS-æ³¨å…¥" class="headerlink" title="2ï¸âƒ£ Hook WebView è¿›è¡Œ JS æ³¨å…¥"></a><strong>2ï¸âƒ£ Hook WebView è¿›è¡Œ JS æ³¨å…¥</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java">osedHelpers.findAndHookMethod(Application.class, <span class="hljs-string">"attach"</span>, Context.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> (Context) param.args[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> context.getClassLoader();<br><br>        XposedHelpers.findAndHookMethod(<span class="hljs-string">"android.webkit.WebView"</span>, classLoader, <span class="hljs-string">"loadUrl"</span>, String.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> (String) param.args[<span class="hljs-number">0</span>];<br>                XposedBridge.log(<span class="hljs-string">"WebView is loading: "</span> + url);<br>            }<br>        });<br>    }<br>});<br><br></code></pre></td></tr></tbody></table></figure><p>  ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šHook <code>WebView.loadUrl()</code> æ–¹æ³•ï¼Œæ‰“å°æ‰€æœ‰åŠ è½½çš„ URLã€‚</p><hr><h3 id="âš ï¸-æ³¨æ„äº‹é¡¹-1"><a href="#âš ï¸-æ³¨æ„äº‹é¡¹-1" class="headerlink" title="âš ï¸ æ³¨æ„äº‹é¡¹"></a><strong>âš ï¸ æ³¨æ„äº‹é¡¹</strong></h3><p>  1ï¸âƒ£ <strong>ä¸èƒ½ç›´æ¥åœ¨ <code>handleLoadPackage()</code> é‡Œ Hook ç›®æ ‡åº”ç”¨çš„ç±»</strong></p><ul><li>æœ‰äº›åº”ç”¨ä½¿ç”¨ <strong>è‡ªå®šä¹‰ ClassLoader</strong>ï¼Œå¯¼è‡´ <code>handleLoadPackage()</code> æ—¶ç›®æ ‡ç±»è¿˜æœªåŠ è½½ã€‚</li><li>è§£å†³æ–¹æ¡ˆå°±æ˜¯ <strong>å…ˆ Hook <code>Application.attach()</code>ï¼Œç­‰ <code>ClassLoader</code> åˆå§‹åŒ–åå† Hook ç›®æ ‡æ–¹æ³•</strong>ã€‚</li></ul><p>  2ï¸âƒ£ <strong><code>beforeHookedMethod()</code> vs <code>afterHookedMethod()</code></strong></p><ul><li><code>beforeHookedMethod()</code>ï¼šåœ¨æ–¹æ³• <strong>æ‰§è¡Œå‰</strong> Hookï¼Œå¯ä¿®æ”¹å‚æ•°æˆ–é˜»æ­¢æ‰§è¡Œã€‚</li><li><code>afterHookedMethod()</code>ï¼šåœ¨æ–¹æ³• <strong>æ‰§è¡Œå</strong> Hookï¼Œå¯è·å–åŸå§‹è¿”å›å€¼å¹¶ä¿®æ”¹ã€‚</li></ul><p>  3ï¸âƒ£ <strong>é€‚ç”¨äºæ‰€æœ‰ Android åº”ç”¨</strong></p><ul><li><code>Application.attach(Context)</code> æ˜¯ <strong>æ‰€æœ‰ Android åº”ç”¨éƒ½ä¼šè°ƒç”¨çš„æ–¹æ³•</strong>ï¼Œæ‰€ä»¥è¿™ä¸ª Hook æ–¹å¼é€‚ç”¨äº <strong>æ‰€æœ‰ APP</strong>ï¼Œæ— è®ºå®ƒæ˜¯å¦æ··æ·†æˆ–æœ‰å¤æ‚çš„ <code>ClassLoader</code> æœºåˆ¶ã€‚</li></ul><hr><h3 id="ğŸ’¡-æ€»ç»“"><a href="#ğŸ’¡-æ€»ç»“" class="headerlink" title="ğŸ’¡ æ€»ç»“"></a><strong>ğŸ’¡ æ€»ç»“</strong></h3><table><thead><tr><th><strong>ä»£ç éƒ¨åˆ†</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><code>findAndHookMethod(Application.class, "attach", Context.class, XC_MethodHook)</code></td><td>Hook <code>attach(Context)</code>ï¼Œåœ¨åº”ç”¨åˆå§‹åŒ–æ—¶æ‰§è¡Œ Hook</td></tr><tr><td><code>context.getClassLoader()</code></td><td>è·å– <code>ClassLoader</code>ï¼Œç”¨äºåŠ è½½ç›®æ ‡ç±»</td></tr><tr><td><code>findAndHookMethod("ç›®æ ‡ç±»", classLoader, "æ–¹æ³•å", XC_MethodHook)</code></td><td>Hook ç›®æ ‡ç±»çš„æ–¹æ³•</td></tr><tr><td><code>param.args[n]</code></td><td>è·å–æˆ–ä¿®æ”¹æ–¹æ³•å‚æ•°</td></tr><tr><td><code>param.setResult(value)</code></td><td>ä¿®æ”¹è¿”å›å€¼</td></tr><tr><td><code>beforeHookedMethod()</code></td><td>æ–¹æ³•æ‰§è¡Œå‰ Hookï¼Œå¯ä¿®æ”¹å‚æ•°æˆ–é˜»æ­¢æ‰§è¡Œ</td></tr><tr><td><code>afterHookedMethod()</code></td><td>æ–¹æ³•æ‰§è¡Œå Hookï¼Œå¯è·å–æˆ–ä¿®æ”¹è¿”å›å€¼</td></tr></tbody></table><p>  âœ… <strong>è¿™æ®µä»£ç çš„æ ¸å¿ƒæ€æƒ³æ˜¯å…ˆ Hook <code>Application.attach()</code>ï¼Œç¡®ä¿ <code>ClassLoader</code> åˆå§‹åŒ–åï¼Œå†å» Hook ç›®æ ‡åº”ç”¨çš„å…¶ä»–æ–¹æ³•ã€‚</strong></p><p>  âœ… <strong>é€‚ç”¨äºæ‰€æœ‰ Android åº”ç”¨ï¼Œå°¤å…¶æ˜¯å¸¦æœ‰è‡ªå®šä¹‰ <code>ClassLoader</code> çš„åº”ç”¨ã€‚</strong></p><h3 id="é€†å‘å¯¹æŠ—ä¸åŠ å›º"><a href="#é€†å‘å¯¹æŠ—ä¸åŠ å›º" class="headerlink" title="é€†å‘å¯¹æŠ—ä¸åŠ å›º"></a><strong>é€†å‘å¯¹æŠ—ä¸åŠ å›º</strong></h3><p>  è‹¥ä½ æ˜¯åº”ç”¨å¼€å‘è€…ï¼Œå¯é‡‡å–ä»¥ä¸‹é˜²æŠ¤æªæ–½ï¼š</p><ol><li><p><strong>æ£€æµ‹Application.attachæ˜¯å¦è¢«Hook</strong></p><p> åœ¨<code>attach()</code>æ–¹æ³•å†…æ£€æŸ¥è°ƒç”¨æ ˆï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attach</span><span class="hljs-params">(Context context)</span> {<br>    StackTraceElement[] stackTrace = Thread.currentThread().getStackTrace();<br>    <span class="hljs-keyword">for</span> (StackTraceElement element : stackTrace) {<br>        <span class="hljs-keyword">if</span> (element.getClassName().contains(<span class="hljs-string">"xposed"</span>)) {<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"Xposedæ¡†æ¶æ³¨å…¥ï¼"</span>);<br>        }<br>    }<br>    <span class="hljs-built_in">super</span>.attach(context);<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ··æ·†å…³é”®ç±»åå’Œæ–¹æ³•å</strong></p><p> å¢åŠ å®šä½éš¾åº¦ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">a</span> { <span class="hljs-comment">// åŸç±»åApplication</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">b</span><span class="hljs-params">(Context c)</span> { <span class="hljs-comment">// åŸæ–¹æ³•åattach</span><br>        <span class="hljs-comment">// åŸå§‹é€»è¾‘</span><br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>ä½¿ç”¨è‡ªå®šä¹‰ClassLoader</strong></p><p> é˜²æ­¢é€šè¿‡ç³»ç»ŸClassLoaderè·å–ç±»ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureClassLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassLoader</span> {<br>    <span class="hljs-comment">// é‡å†™loadClassæ–¹æ³•ï¼Œé˜²æ­¢å¤–éƒ¨Hook</span><br>}<br></code></pre></td></tr></tbody></table></figure></li></ol></li></ul></li></ul><h3 id="5-Hookå˜é‡"><a href="#5-Hookå˜é‡" class="headerlink" title="5.Hookå˜é‡"></a><strong>5.Hookå˜é‡</strong></h3><p>é™æ€å˜é‡ä¸å®ä¾‹å˜é‡ï¼š</p><ul><li>é™æ€å˜é‡ï¼ˆstaticï¼‰ï¼šç±»è¢«åˆå§‹åŒ–ï¼ŒåŒæ­¥è¿›è¡Œåˆå§‹åŒ–</li><li>éé™æ€å˜é‡ï¼šç±»è¢«å®ä¾‹åŒ–ï¼ˆäº§ç”Ÿä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼‰ï¼Œè¿›è¡Œåˆå§‹åŒ–</li></ul><p>é™æ€å˜é‡</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"ç±»å"</span>, classLoader);<br>XposedHelpers.setStaticIntField(clazz, <span class="hljs-string">"å˜é‡å"</span>, <span class="hljs-number">999</span>);<br></code></pre></td></tr></tbody></table></figure><p>å®ä¾‹å˜é‡</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"ç±»å"</span>, classLoader);<br>XposedBridge.hookAllConstructors(clazz, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>        <span class="hljs-comment">//param.thisObjectè·å–å½“å‰æ‰€å±çš„å¯¹è±¡</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">ob</span> <span class="hljs-operator">=</span> param.thisObject;<br>        XposedHelpers.setIntField(ob,<span class="hljs-string">"å˜é‡å"</span>,<span class="hljs-number">9999</span>);}<br>    });<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>Hooké™æ€å˜é‡ï¼Œå…ˆæ ¹æ®åŸç æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„åŒ…åï¼Œæ–¹æ³•åç­‰ä¿¡æ¯</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262106768.png"></p><ol><li>æ ¹æ®</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262106329.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="ä»£ç ä½œç”¨-1"><a href="#ä»£ç ä½œç”¨-1" class="headerlink" title="ä»£ç ä½œç”¨"></a><strong>ä»£ç ä½œç”¨</strong></h3><p>  è¿™ä¸¤è¡Œä»£ç é€šè¿‡Xposedæ¡†æ¶<strong>ä¿®æ”¹ç›®æ ‡ç±»çš„é™æ€æ•´å‹å­—æ®µå€¼</strong>ï¼Œå¸¸ç”¨äºåŠ¨æ€ç¯¡æ”¹åº”ç”¨çš„é…ç½®ã€çŠ¶æ€æ ‡å¿—æˆ–ç»•è¿‡é™åˆ¶ï¼ˆå¦‚è¯•ç”¨æ¬¡æ•°ã€æƒé™æ ¡éªŒç­‰ï¼‰ã€‚</p><hr><h3 id="é€è¡Œåˆ†æ"><a href="#é€è¡Œåˆ†æ" class="headerlink" title="é€è¡Œåˆ†æ"></a><strong>é€è¡Œåˆ†æ</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 1. åŠ è½½ç›®æ ‡ç±»</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"ç±»å"</span>, classLoader);<br><br><span class="hljs-comment">// 2. ä¿®æ”¹é™æ€æ•´å‹å­—æ®µå€¼</span><br>XposedHelpers.setStaticIntField(clazz, <span class="hljs-string">"å˜é‡å"</span>, <span class="hljs-number">999</span>);<br></code></pre></td></tr></tbody></table></figure><hr><h3 id="å…³é”®ç‚¹è§£æ"><a href="#å…³é”®ç‚¹è§£æ" class="headerlink" title="å…³é”®ç‚¹è§£æ"></a><strong>å…³é”®ç‚¹è§£æ</strong></h3><h3 id="1-XposedHelpers-findClass"><a href="#1-XposedHelpers-findClass" class="headerlink" title="1.&nbsp;XposedHelpers.findClass()"></a><strong>1.&nbsp;<code>XposedHelpers.findClass()</code></strong></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šé€šè¿‡ç±»åŠ è½½å™¨æŸ¥æ‰¾ç›®æ ‡ç±»ã€‚</li><li><strong>å‚æ•°</strong>ï¼š<ul><li><code>"ç±»å"</code>ï¼šç›®æ ‡ç±»çš„å…¨é™å®šåï¼ˆå¦‚&nbsp;<code>com.example.Config</code>ï¼‰ã€‚</li><li><code>classLoader</code>ï¼šåº”ç”¨çš„ClassLoaderï¼ˆé€šå¸¸ä»&nbsp;<code>loadPackageParam</code>&nbsp;æˆ–&nbsp;<code>Context</code>&nbsp;è·å–ï¼‰ã€‚</li></ul></li><li><strong>é£é™©</strong>ï¼šè‹¥ç±»ä¸å­˜åœ¨ï¼ŒæŠ›å‡º&nbsp;<code>ClassNotFoundException</code>ã€‚</li></ul><h3 id="2-XposedHelpers-setStaticIntField"><a href="#2-XposedHelpers-setStaticIntField" class="headerlink" title="2.&nbsp;XposedHelpers.setStaticIntField()"></a><strong>2.&nbsp;<code>XposedHelpers.setStaticIntField()</code></strong></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šå¼ºåˆ¶ä¿®æ”¹ç›®æ ‡ç±»çš„&nbsp;<strong>é™æ€intå­—æ®µ</strong>ã€‚</li><li><strong>å‚æ•°</strong>ï¼š<ul><li><code>clazz</code>ï¼šç›®æ ‡ç±»çš„Classå¯¹è±¡ã€‚</li><li><code>"å˜é‡å"</code>ï¼šé™æ€å­—æ®µåç§°ã€‚</li><li><code>999</code>ï¼šæ–°å€¼ã€‚</li></ul></li><li><strong>é™åˆ¶</strong>ï¼š<ul><li>å­—æ®µå¿…é¡»å­˜åœ¨ä¸”ç±»å‹ä¸º&nbsp;<code>int</code>ï¼ˆé&nbsp;<code>Integer</code>ï¼‰ã€‚</li><li>å­—æ®µè®¿é—®æƒé™ä¸é™ï¼ˆXposedå¯ç»•è¿‡&nbsp;<code>private</code>&nbsp;é™åˆ¶ï¼‰ã€‚</li></ul></li></ul><h3 id="æ‰©å±•æ“ä½œ"><a href="#æ‰©å±•æ“ä½œ" class="headerlink" title="æ‰©å±•æ“ä½œ"></a><strong>æ‰©å±•æ“ä½œ</strong></h3><h3 id="1-ä¿®æ”¹éintå­—æ®µ"><a href="#1-ä¿®æ”¹éintå­—æ®µ" class="headerlink" title="1. ä¿®æ”¹éintå­—æ®µ"></a><strong>1. ä¿®æ”¹éintå­—æ®µ</strong></h3><ul><li><p><strong>å­—ç¬¦ä¸²å­—æ®µ</strong>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.setStaticObjectField(clazz, <span class="hljs-string">"API_KEY"</span>, <span class="hljs-string">"hacked_key"</span>);<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>å¸ƒå°”å­—æ®µ</strong>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.setStaticBooleanField(clazz, <span class="hljs-string">"isVIP"</span>, <span class="hljs-literal">true</span>);<br></code></pre></td></tr></tbody></table></figure></li></ul><h3 id="2-åŠ¨æ€ç›‘å¬å­—æ®µå˜åŒ–"><a href="#2-åŠ¨æ€ç›‘å¬å­—æ®µå˜åŒ–" class="headerlink" title="2. åŠ¨æ€ç›‘å¬å­—æ®µå˜åŒ–"></a><strong>2. åŠ¨æ€ç›‘å¬å­—æ®µå˜åŒ–</strong></h3><p>  ç»“åˆHookå’Œåå°„ï¼Œåœ¨å­—æ®µè¢«è®¿é—®æ—¶è§¦å‘é€»è¾‘ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(clazz, <span class="hljs-string">"checkLicense"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> {<br>        <span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨checkLicenseå‰é‡ç½®è¯•ç”¨æ¬¡æ•°</span><br>        XposedHelpers.setStaticIntField(clazz, <span class="hljs-string">"TRIAL_COUNT"</span>, <span class="hljs-number">999</span>);<br>    }<br>});<br></code></pre></td></tr></tbody></table></figure><h3 id="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š-2"><a href="#é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š-2" class="headerlink" title="é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰ï¼š"></a><strong>é˜²å¾¡æªæ–½ï¼ˆé€†å‘å¯¹æŠ—ï¼‰</strong>ï¼š</h3><ol><li><p><strong>å­—æ®µæ··æ·†</strong>ï¼š</p><p> å°†å­—æ®µåæ”¹ä¸ºæ— æ„ä¹‰å­—ç¬¦ä¸²ï¼ˆå¦‚&nbsp;<code>a</code>ï¼‰ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>å€¼æ ¡éªŒé€»è¾‘</strong>ï¼š</p><p> åœ¨ä»£ç å…³é”®ä½ç½®æ ¡éªŒå­—æ®µå“ˆå¸Œå€¼ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (TRIAL_COUNT != calculateHash()) {<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"æ•°æ®ç¯¡æ”¹ï¼"</span>);<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>è¿ç§»åˆ°Nativeå±‚</strong>ï¼š</p><p> ä½¿ç”¨JNIå°†å…³é”®å­—æ®µå­˜å‚¨åœ¨C++å±‚ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTrialCount</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></tbody></table></figure></li></ol></li></ul><ol><li>Hookå®ä¾‹å˜é‡</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262106121.png"></p><ol><li>Hookæ‰€æœ‰çš„æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å‘ç°é™æ€å˜é‡ä¸åŠ¨æ€å˜é‡Hookå®Œæˆã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262106592.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="ä»£ç ä½œç”¨-2"><a href="#ä»£ç ä½œç”¨-2" class="headerlink" title="ä»£ç ä½œç”¨"></a><strong>ä»£ç ä½œç”¨</strong></h3><p>  è¯¥ä»£ç é€šè¿‡Hookç›®æ ‡ç±»çš„<strong>æ‰€æœ‰æ„é€ å‡½æ•°</strong>ï¼Œåœ¨å¯¹è±¡å®ä¾‹åŒ–å®Œæˆåï¼Œä¿®æ”¹å…¶&nbsp;<code>publicInt</code>&nbsp;å­—æ®µçš„å€¼ä¸º&nbsp;<code>2222</code>ã€‚å¸¸ç”¨äº<strong>ç¯¡æ”¹å¯¹è±¡åˆå§‹åŒ–çŠ¶æ€</strong>ï¼Œå¦‚ç»•è¿‡æ ¡éªŒã€å¼ºåˆ¶å¯ç”¨éšè—åŠŸèƒ½ç­‰ã€‚</p><h3 id="ä»£ç è§£æ"><a href="#ä»£ç è§£æ" class="headerlink" title="ä»£ç è§£æ"></a><strong>ä»£ç è§£æ</strong></h3><p>  <strong>1.&nbsp;<code>XposedBridge.hookAllConstructors(clazz, new XC_MethodHook())</code></strong></p><ul><li><strong><code>XposedBridge.hookAllConstructors</code></strong>ï¼š<ul><li>è¿™æ˜¯ Xposed æ¡†æ¶æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºé’©æŒ‚æŒ‡å®šç±»çš„æ‰€æœ‰æ„é€ å‡½æ•°ã€‚</li><li>å‚æ•°ï¼š<ul><li><code>clazz</code>ï¼šè¦é’©æŒ‚çš„ç±»ã€‚</li><li><code>new XC_MethodHook()</code>ï¼šåˆ›å»ºä¸€ä¸ª <code>XC_MethodHook</code> çš„åŒ¿åç±»å®ä¾‹ï¼Œç”¨äºå®šä¹‰é’©æŒ‚é€»è¾‘ã€‚</li></ul></li></ul></li></ul><p>  <strong>2.&nbsp;<code>@Override protected void afterHookedMethod(MethodHookParam param) throws Throwable</code></strong></p><ul><li><strong><code>afterHookedMethod</code></strong>ï¼š<ul><li>è¿™æ˜¯ <code>XC_MethodHook</code> ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåœ¨ç›®æ ‡æ–¹æ³•ï¼ˆè¿™é‡Œæ˜¯æ„é€ å‡½æ•°ï¼‰æ‰§è¡Œä¹‹åæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚</li><li>å‚æ•°ï¼š<ul><li><code>param</code>ï¼š<code>MethodHookParam</code> ç±»å‹ï¼ŒåŒ…å«é’©æŒ‚æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚å½“å‰å¯¹è±¡å®ä¾‹ã€æ–¹æ³•å‚æ•°ã€æ–¹æ³•è¿”å›å€¼ç­‰ã€‚</li></ul></li></ul></li></ul><p>  <strong>3.&nbsp;<code>super.afterHookedMethod(param);</code></strong></p><ul><li>è¿™ä¸€è¡Œè°ƒç”¨äº†çˆ¶ç±»çš„ <code>afterHookedMethod</code> æ–¹æ³•ï¼Œè™½ç„¶æ˜¯å¯é€‰çš„ï¼Œä½†ä¿æŒä»£ç å®Œæ•´æ€§ã€‚</li><li>çˆ¶ç±»çš„å®ç°æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¿™è¡Œä»£ç å¯ä»¥çœç•¥ã€‚</li></ul><p>  <strong>4.&nbsp;<code>Object ob = param.thisObject;</code></strong></p><ul><li><strong><code>param.thisObject</code></strong>ï¼š<ul><li>è·å–å½“å‰æ„é€ å‡½æ•°æ‰€åˆ›å»ºçš„å¯¹è±¡å®ä¾‹ã€‚</li><li>åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œ<code>thisObject</code> æŒ‡å‘æ­£åœ¨è¢«æ„é€ çš„å¯¹è±¡ã€‚</li></ul></li></ul><p>  <strong>5.&nbsp;<code>XposedHelpers.setIntField(ob, "publicInt", 2222);</code></strong></p><ul><li><strong><code>XposedHelpers.setIntField</code></strong>ï¼š<ul><li>è¿™æ˜¯ Xposed æ¡†æ¶æä¾›çš„ä¸€ä¸ªå·¥å…·æ–¹æ³•ï¼Œç”¨äºè®¾ç½®å¯¹è±¡çš„å­—æ®µå€¼ã€‚</li><li>å‚æ•°ï¼š<ul><li><code>ob</code>ï¼šç›®æ ‡å¯¹è±¡å®ä¾‹ã€‚</li><li><code>"publicInt"</code>ï¼šå­—æ®µåã€‚</li><li><code>2222</code>ï¼šè¦è®¾ç½®çš„å€¼ã€‚</li></ul></li><li>è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†ç›®æ ‡å¯¹è±¡çš„ <code>publicInt</code> å­—æ®µå€¼ä¿®æ”¹ä¸º <code>2222</code>ã€‚</li></ul></li></ul><h3 id="é€†å‘å¯¹æŠ—ä¸åŠ å›º-1"><a href="#é€†å‘å¯¹æŠ—ä¸åŠ å›º-1" class="headerlink" title="é€†å‘å¯¹æŠ—ä¸åŠ å›º"></a><strong>é€†å‘å¯¹æŠ—ä¸åŠ å›º</strong></h3><p>  è‹¥ä½ æ˜¯åº”ç”¨å¼€å‘è€…ï¼Œå¯é‡‡å–ä»¥ä¸‹é˜²æŠ¤æªæ–½ï¼š</p><ol><li><p><strong>å­—æ®µæ··æ·†</strong>ï¼š</p><p> å°†å…³é”®å­—æ®µåæ”¹ä¸ºæ— æ„ä¹‰å­—ç¬¦ä¸²ï¼ˆå¦‚&nbsp;<code>a</code>ï¼‰ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span> {<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// åŸå­—æ®µå publicInt</span><br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>å­—æ®µå€¼æ ¡éªŒ</strong>ï¼š</p><p> åœ¨å…³é”®æ–¹æ³•ä¸­æ ¡éªŒå­—æ®µå“ˆå¸Œå€¼ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validate</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">if</span> (publicInt != calculateHash()) {<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"å­—æ®µè¢«ç¯¡æ”¹ï¼"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ„é€ å‡½æ•°é€»è¾‘ä¿æŠ¤</strong>ï¼š</p><p> åœ¨æ„é€ åäºŒæ¬¡åŠ å¯†å­—æ®µå€¼ï¼š</p> <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureClass</span> {<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> publicInt;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SecureClass</span><span class="hljs-params">()</span> {<br>        publicInt = <span class="hljs-number">100</span>;<br>        publicInt = encrypt(publicInt); <span class="hljs-comment">// æ„é€ å‡½æ•°å†…äºŒæ¬¡å¤„ç†</span><br>    }<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">encrypt</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> {<br>        <span class="hljs-keyword">return</span> value ^ <span class="hljs-number">0x12345678</span>; <span class="hljs-comment">// ç®€å•åŠ å¯†</span><br>    }<br>}<br></code></pre></td></tr></tbody></table></figure></li></ol><hr><h3 id="æ‰©å±•æ“ä½œ-1"><a href="#æ‰©å±•æ“ä½œ-1" class="headerlink" title="æ‰©å±•æ“ä½œ"></a><strong>æ‰©å±•æ“ä½œ</strong></h3><h3 id="1-æ¡ä»¶ç¯¡æ”¹"><a href="#1-æ¡ä»¶ç¯¡æ”¹" class="headerlink" title="1. æ¡ä»¶ç¯¡æ”¹"></a><strong>1. æ¡ä»¶ç¯¡æ”¹</strong></h3><p>  ä»…åœ¨æ»¡è¶³æ¡ä»¶æ—¶ä¿®æ”¹å­—æ®µå€¼ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (XposedHelpers.getIntField(instance, <span class="hljs-string">"publicInt"</span>) &lt; <span class="hljs-number">1000</span>) {<br>    XposedHelpers.setIntField(instance, <span class="hljs-string">"publicInt"</span>, <span class="hljs-number">2222</span>);<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="2-å¤šå­—æ®µæ“ä½œ"><a href="#2-å¤šå­—æ®µæ“ä½œ" class="headerlink" title="2. å¤šå­—æ®µæ“ä½œ"></a><strong>2. å¤šå­—æ®µæ“ä½œ</strong></h3><p>  åŒæ—¶ä¿®æ”¹å¤šä¸ªå­—æ®µï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.setIntField(instance, <span class="hljs-string">"publicInt"</span>, <span class="hljs-number">2222</span>);<br>XposedHelpers.setObjectField(instance, <span class="hljs-string">"mode"</span>, <span class="hljs-string">"DEBUG"</span>);<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><h3 id="6-Hookæ„é€ å‡½æ•°"><a href="#6-Hookæ„é€ å‡½æ•°" class="headerlink" title="6.Hookæ„é€ å‡½æ•°"></a><strong>6.Hookæ„é€ å‡½æ•°</strong></h3><p>æ— å‚æ„é€ å‡½æ•°</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookConstructor(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, classLoader, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>&nbsp; &nbsp; }<br>});<br></code></pre></td></tr></tbody></table></figure><p>æœ‰å‚æ„é€ å‡½æ•°</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">posedHelpers.findAndHookConstructor(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, classLoader, String.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>            }<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>            }<br>        });<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><p>  1.Hookæœ‰å‚æ„é€ å‡½æ•°ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ä¼ å…¥çš„æ˜¯strå­—ç¬¦ä¸²</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262107135.png"></p><p>  2.æˆ‘ä»¬Hookä¼ å…¥çš„strå‚æ•°è¿›è¡Œä¿®æ”¹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262107894.png"></p><ul><li><p>ä»£ç è¯¦è§£</p><h3 id="1-XposedHelpers-findAndHookConstructor"><a href="#1-XposedHelpers-findAndHookConstructor" class="headerlink" title="1. XposedHelpers.findAndHookConstructor"></a><strong>1. XposedHelpers.findAndHookConstructor</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">XosedHelpers.findAndHookConstructor(String className, ClassLoader classLoader, Object... parameterTypesAndCallback)<br><br></code></pre></td></tr></tbody></table></figure><h3 id="findAndHookConstructoræ–¹æ³•"><a href="#findAndHookConstructoræ–¹æ³•" class="headerlink" title="findAndHookConstructoræ–¹æ³•"></a><strong><code>findAndHookConstructor</code>æ–¹æ³•</strong></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šæŸ¥æ‰¾å¹¶HookæŒ‡å®šç±»çš„æ„é€ å‡½æ•°ã€‚</li><li><strong>å‚æ•°è§£æ</strong>ï¼š<ul><li><code>"com.zj.wuaipojie.Demo"</code>ï¼šç›®æ ‡ç±»çš„å…¨é™å®šåã€‚</li><li><code>loadPackageParam.classLoader</code>ï¼šä½¿ç”¨ç›®æ ‡åº”ç”¨çš„ç±»åŠ è½½å™¨ï¼Œç¡®ä¿æ­£ç¡®åŠ è½½ç±»ï¼ˆé¿å…ClassNotFoundï¼‰ã€‚</li><li><code>String.class</code>ï¼šæ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ï¼ˆéœ€ä¸å®é™…å‚æ•°ç±»å‹ä¸¥æ ¼åŒ¹é…ï¼‰ã€‚</li><li><code>XC_MethodHook</code>ï¼šHookè¡Œä¸ºçš„å›è°ƒå®ç°ã€‚</li></ul></li></ul><h3 id="XC-MethodHookå›è°ƒ"><a href="#XC-MethodHookå›è°ƒ" class="headerlink" title="XC_MethodHookå›è°ƒ"></a><strong><code>XC_MethodHook</code>å›è°ƒ</strong></h3><ul><li><p><strong><code>beforeHookedMethod</code></strong>ï¼š</p><ul><li><strong>æ‰§è¡Œæ—¶æœº</strong>ï¼šç›®æ ‡æ–¹æ³•ï¼ˆæ„é€ å‡½æ•°ï¼‰æ‰§è¡Œå‰ã€‚</li><li><strong>æ“ä½œ</strong>ï¼šé€šè¿‡<code>param.args</code>ä¿®æ”¹ä¼ å…¥å‚æ•°ï¼ˆæ­¤å¤„å°†ç¬¬ä¸€ä¸ªå‚æ•°æ›¿æ¢ä¸º<code>"CC"</code>ï¼‰ã€‚</li></ul></li><li><p><strong><code>afterHookedMethod</code></strong>ï¼š</p><ul><li><strong>æ‰§è¡Œæ—¶æœº</strong>ï¼šç›®æ ‡æ–¹æ³•æ‰§è¡Œåã€‚</li><li><strong>æ“ä½œ</strong>ï¼šå¯è®¿é—®è¿”å›å€¼ï¼ˆ<code>param.getResult()</code>ï¼‰æˆ–å¼‚å¸¸ï¼ˆ<code>param.getThrowable()</code>ï¼‰ã€‚</li></ul></li><li><p><code>className</code>: è¦ Hook çš„ç±»åï¼ˆè¿™é‡Œæ˜¯ <code>"com.zj.wuaipojie.Demo"</code>ï¼‰ã€‚</p></li><li><p><code>classLoader</code>: ç›®æ ‡åº”ç”¨çš„ç±»åŠ è½½å™¨ï¼ˆè¿™é‡Œ <code>loadPackageParam.classLoader</code> æä¾›äº† <code>APK</code> çš„ <code>ClassLoader</code>ï¼‰ã€‚</p></li><li><p><code>parameterTypesAndCallback</code>: å…ˆåˆ—å‡ºæ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ï¼ˆè¿™é‡Œæ˜¯ <code>String.class</code>ï¼‰ï¼Œç„¶åæ˜¯ Hook å›è°ƒå¯¹è±¡ï¼ˆ<code>XC_MethodHook</code>ï¼‰ã€‚</p></li></ul><p>  <strong>ä½œç”¨</strong>ï¼šæ‰¾åˆ° <code>com.zj.wuaipojie.Demo</code> ç±»ä¸­ <strong>å½¢å‚ä¸º <code>String</code> çš„æ„é€ æ–¹æ³•</strong>ï¼Œç„¶å Hook è¯¥æ„é€ æ–¹æ³•ã€‚</p><hr><h3 id="2-beforeHookedMethod"><a href="#2-beforeHookedMethod" class="headerlink" title="2. beforeHookedMethod"></a><strong>2. beforeHookedMethod</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>    <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>    param.args[<span class="hljs-number">0</span>] = <span class="hljs-string">"CC"</span>;  <span class="hljs-comment">// ä¿®æ”¹æ„é€ å‡½æ•°çš„å‚æ•°</span><br>}<br><br></code></pre></td></tr></tbody></table></figure><ul><li><code>param.args[0]</code> ä»£è¡¨æ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li><li><code>param.args[0] = "CC";</code> å°†ä¼ å…¥ <code>Demo</code> ç±»æ„é€ å‡½æ•°çš„ <code>String</code> å‚æ•°ä¿®æ”¹ä¸º <code>"CC"</code>ã€‚</li></ul><p>  <strong>ä½œç”¨</strong>ï¼šåœ¨ <code>Demo</code> ç±»æ„é€ æ–¹æ³•æ‰§è¡Œå‰ï¼Œä¿®æ”¹å®ƒçš„å‚æ•°ï¼Œä½¿å¾—ä¼ å…¥çš„å­—ç¬¦ä¸²æ— è®ºåŸæ¥æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå˜æˆ <code>"CC"</code>ã€‚</p><hr><h3 id="3-afterHookedMethod"><a href="#3-afterHookedMethod" class="headerlink" title="3. afterHookedMethod"></a><strong>3. afterHookedMethod</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>    <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>}<br><br></code></pre></td></tr></tbody></table></figure><ul><li><code>afterHookedMethod</code> å‘ç”Ÿåœ¨æ„é€ å‡½æ•° <strong>æ‰§è¡Œå</strong>ï¼Œä½†æœ¬ä»£ç æ²¡æœ‰åšé¢å¤–æ“ä½œï¼Œä»…è°ƒç”¨ <code>super.afterHookedMethod(param)</code>ã€‚</li></ul><p>  <strong>ä½œç”¨</strong>ï¼šåœ¨ <code>Demo</code> å¯¹è±¡åˆ›å»ºåå¯ä»¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚ä¿®æ”¹ <code>this</code> æŒ‡å‘çš„å¯¹è±¡ï¼Œä½†æœ¬ä»£ç æœªåšé¢å¤–æ“ä½œã€‚</p><h3 id="4-Android-ç±»åŠ è½½æœºåˆ¶"><a href="#4-Android-ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="4. Android ç±»åŠ è½½æœºåˆ¶"></a><strong>4. Android ç±»åŠ è½½æœºåˆ¶</strong></h3><p>  <code>loadPackageParam.classLoader</code> æä¾›çš„æ˜¯ç›®æ ‡åº”ç”¨çš„ <code>ClassLoader</code>ï¼Œå¸¸è§çš„ç±»åŠ è½½å™¨æœ‰ï¼š</p><ul><li><code>PathClassLoader</code>ï¼šç”¨äºåŠ è½½ <code>APK</code> å†…çš„ <code>dex</code> æ–‡ä»¶ã€‚</li><li><code>DexClassLoader</code>ï¼šå¯ä»¥åŠ¨æ€åŠ è½½å¤–éƒ¨ <code>dex</code> æ–‡ä»¶ã€‚</li></ul><p>  <strong>ä¸ºä»€ä¹ˆéœ€è¦æä¾› <code>classLoader</code>ï¼Ÿ</strong><br>  å› ä¸º <code>Xposed</code> è¿è¡Œåœ¨å®¿ä¸»åº”ç”¨ç¯å¢ƒï¼ˆå¦‚ <code>Zygote</code>ï¼‰ï¼Œè€Œ <code>Demo</code> è¿™ä¸ªç±»å±äºç›®æ ‡åº”ç”¨ï¼Œå› æ­¤ <strong>éœ€è¦ä½¿ç”¨ç›®æ ‡åº”ç”¨çš„ <code>ClassLoader</code> åŠ è½½å®ƒ</strong>ï¼Œå¦åˆ™æ‰¾ä¸åˆ°ç±»ã€‚</p><p>  è¿™æ®µä»£ç é€‚åˆç”¨äºåˆ†æ <code>Demo</code> ç±»çš„å®ä¾‹åˆ›å»ºæƒ…å†µï¼Œæˆ–è€…ç»•è¿‡ <code>Demo</code> å¯èƒ½å­˜åœ¨çš„å‚æ•°æ£€æŸ¥é€»è¾‘ã€‚</p></li></ul><p>  3.å¯¹äºæ— å‚æ„é€ å‡½æ•°å¯ä»¥ä½¿ç”¨æ›¿æ¢å‡½æ•°å°†å†…å®¹æ›¿æ¢ã€‚</p></li></ul><h3 id="7-Hook-multiDexæ–¹æ³•"><a href="#7-Hook-multiDexæ–¹æ³•" class="headerlink" title="7.Hook multiDexæ–¹æ³•"></a><strong>7.Hook multiDexæ–¹æ³•</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">osedHelpers.findAndHookMethod(Application.class, <span class="hljs-string">"attach"</span>, Context.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ClassLoader cl= ((Context)param.args[<span class="hljs-number">0</span>]).getClassLoader();<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Class&lt;?&gt; hookclass=<span class="hljs-literal">null</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">try</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;hookclass=cl.loadClass(<span class="hljs-string">"ç±»å"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<span class="hljs-keyword">catch</span> (Exception e){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Log.e(<span class="hljs-string">"zj2595"</span>,<span class="hljs-string">"æœªæ‰¾åˆ°ç±»"</span>,e);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">return</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;XposedHelpers.findAndHookMethod(hookclass, <span class="hljs-string">"æ–¹æ³•å"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-meta">@Override</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;});<br>&nbsp; &nbsp; }<br>}<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><p>  1.æ•™ç¨‹Demoä¸­åªæœ‰ä¸€ä¸ªDexæ–‡ä»¶ï¼Œä½†åœ¨å¹³å¸¸Hookä¸­ä¼šæœ‰å¤šä¸ªç”šè‡³å‡ åä¸ªè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸åœ¨ç¬¬ä¸€ä¸ªDexæ–‡ä»¶å¤¹é‡Œé¢ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰¾åˆ°ç›¸å…³çš„ç±»ï¼Œç„¶åå°†ç±»ä¼ è¿›å»å†è¿›è¡Œæ™®é€šæ–¹æ³•çš„Hookã€‚</p><p>  2.åœ¨Dexæ–‡ä»¶ä¸­æœ€å¤šåªèƒ½å­˜åœ¨65535ä¸ªæ–¹æ³•</p><ul><li><p>ä»£ç è¯¦è§£</p><h3 id="1-Hook-Application-attach-çš„æ„å›¾"><a href="#1-Hook-Application-attach-çš„æ„å›¾" class="headerlink" title="1.&nbsp;Hook&nbsp;Application.attach&nbsp;çš„æ„å›¾"></a>1.&nbsp;<strong>Hook&nbsp;<code>Application.attach</code>&nbsp;çš„æ„å›¾</strong></h3><ul><li><p><strong>æ—¶æœºæ§åˆ¶</strong>ï¼š</p><p>  <code>Application.attach(Context)</code>&nbsp;æ˜¯åº”ç”¨åˆå§‹åŒ–æ—¶è¾ƒæ—©è°ƒç”¨çš„æ–¹æ³•ï¼Œé€šè¿‡åœ¨æ­¤å¤„è·å–&nbsp;<code>ClassLoader</code>ï¼Œç¡®ä¿ç›®æ ‡ç±»å·²åŠ è½½åˆ°å†…å­˜ã€‚</p></li><li><p><strong>è§£å†³ç±»éš”ç¦»é—®é¢˜</strong>ï¼š</p><p>  æŸäº›åº”ç”¨å¯èƒ½ä½¿ç”¨å¤š&nbsp;<code>ClassLoader</code>ï¼ˆå¦‚æ’ä»¶åŒ–æ¡†æ¶ï¼‰ï¼Œç›´æ¥ä½¿ç”¨ç³»ç»Ÿ&nbsp;<code>ClassLoader</code>&nbsp;å¯èƒ½æ— æ³•åŠ è½½ç›®æ ‡ç±»ã€‚</p></li></ul><h3 id="2-å»¶è¿ŸHookï¼ˆLazy-Hookï¼‰"><a href="#2-å»¶è¿ŸHookï¼ˆLazy-Hookï¼‰" class="headerlink" title="2.&nbsp;å»¶è¿ŸHookï¼ˆLazy Hookï¼‰"></a>2.&nbsp;<strong>å»¶è¿ŸHookï¼ˆLazy Hookï¼‰</strong></h3><ul><li><p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼š</p><p>  è‹¥ç›´æ¥Hookç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œå¯èƒ½å› ç±»å°šæœªè¢«åŠ è½½å¯¼è‡´&nbsp;<code>ClassNotFoundException</code>ã€‚</p></li><li><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><p>  å…ˆHook&nbsp;<code>Application.attach</code>ï¼Œåœ¨å…¶æ‰§è¡Œåé€šè¿‡ç›®æ ‡åº”ç”¨çš„&nbsp;<code>ClassLoader</code>&nbsp;åŠ è½½ç±»ï¼Œç¡®ä¿ç±»å·²åˆå§‹åŒ–ã€‚</p></li></ul><h3 id="3-ClassLoader-çš„å…³é”®ä½œç”¨"><a href="#3-ClassLoader-çš„å…³é”®ä½œç”¨" class="headerlink" title="3.&nbsp;ClassLoader&nbsp;çš„å…³é”®ä½œç”¨"></a>3.&nbsp;<strong><code>ClassLoader</code>&nbsp;çš„å…³é”®ä½œç”¨</strong></h3><ul><li><p><strong>ä¸Šä¸‹æ–‡éš”ç¦»</strong>ï¼š</p><p>  Androidä¸­ä¸åŒåº”ç”¨ï¼ˆæˆ–æ¨¡å—ï¼‰ä½¿ç”¨ç‹¬ç«‹çš„&nbsp;<code>ClassLoader</code>ï¼Œéœ€é€šè¿‡ç›®æ ‡Contextè·å–å…¶&nbsp;<code>ClassLoader</code>&nbsp;æ‰èƒ½æ­£ç¡®åŠ è½½ç±»ã€‚</p></li><li><p><strong>ç¤ºä¾‹æ¥æº</strong>ï¼š</p><p>  <code>param.args[0]</code>&nbsp;æ˜¯&nbsp;<code>attach</code>&nbsp;æ–¹æ³•çš„&nbsp;<code>Context</code>&nbsp;å‚æ•°ï¼Œä»£è¡¨å½“å‰åº”ç”¨çš„ä¸Šä¸‹æ–‡ã€‚</p></li></ul><h3 id="4-åŠ¨æ€æ–¹æ³•Hook"><a href="#4-åŠ¨æ€æ–¹æ³•Hook" class="headerlink" title="4.&nbsp;åŠ¨æ€æ–¹æ³•Hook"></a>4.&nbsp;<strong>åŠ¨æ€æ–¹æ³•Hook</strong></h3><ul><li><p><strong>çµæ´»æ€§ä¸éšè”½æ€§</strong>ï¼š</p><p>  é€šè¿‡è¿è¡Œæ—¶åŠ è½½ç±»å¹¶Hookæ–¹æ³•ï¼Œæ— éœ€æå‰çŸ¥é“ç›®æ ‡ç±»çš„å…·ä½“å®ç°ï¼Œé€‚ç”¨äºå¯¹æŠ—æ··æ·†æˆ–åŠ¨æ€ä»£ç åŠ è½½ï¼ˆå¦‚DexClassLoaderï¼‰ã€‚</p></li></ul><p>  <strong>å»¶è¿ŸHookæŠ€æœ¯</strong>&nbsp;çš„å…¸å‹å®ç°ï¼Œé€šè¿‡Hook&nbsp;<code>Application.attach</code>&nbsp;æ–¹æ³•è·å–ç›®æ ‡&nbsp;<code>ClassLoader</code>ï¼Œå†åŠ¨æ€åŠ è½½å¹¶Hookç›®æ ‡ç±»çš„æ–¹æ³•ã€‚åœ¨å®‰å“é€†å‘ä¸­ï¼Œè¿™ç§æŠ€æœ¯å¸¸ç”¨äºï¼š</p><ol><li>å¤„ç†æ··æ·†åçš„ç±»å’Œæ–¹æ³•ã€‚</li><li>åº”å¯¹åŠ¨æ€ä»£ç åŠ è½½ï¼ˆå¦‚çƒ­ä¿®å¤ã€æ’ä»¶åŒ–ï¼‰ã€‚</li><li>ç»•è¿‡ç±»åˆå§‹åŒ–é¡ºåºå¯¼è‡´çš„Hookå¤±è´¥é—®é¢˜ã€‚</li></ol></li></ul></li></ul><h3 id="8-ä¸»åŠ¨è°ƒç”¨"><a href="#8-ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="8.ä¸»åŠ¨è°ƒç”¨"></a><strong>8.ä¸»åŠ¨è°ƒç”¨</strong></h3><p>é™æ€æ–¹æ³•:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">clazz</span> = XposedHelpers.findClass(<span class="hljs-string">"ç±»å"</span>,lpparam.classLoader);<br>XposedHelpers.callStaticMethod(clazz,<span class="hljs-string">"æ–¹æ³•å"</span>,å‚æ•°(éå¿…é¡»));<br></code></pre></td></tr></tbody></table></figure><p>å®ä¾‹æ–¹æ³•:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"ç±»å"</span>,lpparam.classLoader);<br>XposedHelpers.callMethod(clazz.newInstance(),<span class="hljs-string">"æ–¹æ³•å"</span>,å‚æ•°(éå¿…é¡»));<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>ä¸»åŠ¨è°ƒç”¨æ–¹æ³•ï¼ŒåŒæ ·åˆ†ä¸ºé™æ€æ–¹æ³•å’ŒåŠ¨æ€æ–¹æ³•ä¸¤ç§ã€‚ä¸»è¦çœ‹æ˜¯å¦æœ‰staticä¿®é¥°ç¬¦ã€‚åœ¨ Java ä¸­ï¼Œ<code>static</code> å…³é”®å­—ç”¨äºä¿®é¥° <strong>å˜é‡ã€æ–¹æ³•ã€ä»£ç å—å’Œå†…éƒ¨ç±»</strong>ï¼Œè¡¨ç¤ºå®ƒä»¬å±äº <strong>ç±»</strong> è€Œä¸æ˜¯ç±»çš„å®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ã€‚è¿™æ„å‘³ç€ <code>static</code> æˆå‘˜å¯ä»¥åœ¨ä¸åˆ›å»ºå¯¹è±¡çš„æƒ…å†µä¸‹è¢«ç›´æ¥è®¿é—®ã€‚</li><li>è¿™æ˜¯æ•™ç¨‹Demoä¸­æœªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°è¯•ä¸»åŠ¨è°ƒç”¨è¯¥å‡½æ•°</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262107874.png"></p><ol><li>æˆ‘ä»¬å‘ç°æ—¥å¿—é€šè¿‡ä¸»åŠ¨è°ƒç”¨è¾“å‡º</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262107778.png"></p><ul><li><p>ä»£ç è¯¦è§£</p><h3 id="1-XposedHelpers-callMethod-æ–¹æ³•"><a href="#1-XposedHelpers-callMethod-æ–¹æ³•" class="headerlink" title="1. XposedHelpers.callMethod æ–¹æ³•"></a><strong>1. XposedHelpers.callMethod æ–¹æ³•</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šç®€åŒ–åå°„è°ƒç”¨æµç¨‹ï¼Œæ— éœ€æ‰‹åŠ¨è·å–&nbsp;<code>Method</code>&nbsp;å¯¹è±¡ã€‚</li><li><strong>å‚æ•°</strong>ï¼š<ul><li><strong>å¯¹è±¡å®ä¾‹</strong>ï¼šéœ€å…ˆåˆ›å»ºç›®æ ‡ç±»çš„å®ä¾‹ã€‚</li><li><strong>æ–¹æ³•å</strong>ï¼šè¦è°ƒç”¨çš„æ–¹æ³•åç§°ã€‚</li><li><strong>å¯å˜å‚æ•°</strong>ï¼šæ–¹æ³•çš„å‚æ•°å€¼ï¼ˆå¯é€‰ï¼‰ã€‚</li></ul></li><li><strong>åº•å±‚å®ç°</strong>ï¼šå†…éƒ¨é€šè¿‡åå°„è°ƒç”¨&nbsp;<code>Method.invoke()</code>ã€‚</li></ul><h3 id="2-clazz-newInstance-çš„é™åˆ¶"><a href="#2-clazz-newInstance-çš„é™åˆ¶" class="headerlink" title="2. clazz.newInstance() çš„é™åˆ¶"></a><strong>2. clazz.newInstance() çš„é™åˆ¶</strong></h3><ul><li><strong>æ— å‚æ„é€ è¦æ±‚</strong>ï¼šç›®æ ‡ç±»å¿…é¡»å­˜åœ¨&nbsp;<strong>public æ— å‚æ„é€ å‡½æ•°</strong>ã€‚</li><li><strong>æ½œåœ¨é—®é¢˜</strong>ï¼š<ul><li>è‹¥æ„é€ å‡½æ•°ä¸ºç§æœ‰ï¼ˆå¸¸è§å•ä¾‹æ¨¡å¼ï¼‰ï¼ŒæŠ›å‡º&nbsp;<code>InstantiationException</code>ã€‚</li><li>è‹¥æ„é€ å‡½æ•°éœ€å‚æ•°ï¼ŒæŠ›å‡º&nbsp;<code>IllegalArgumentException</code>ã€‚</li></ul></li></ul><h3 id="3-æ–¹æ³•è°ƒç”¨çš„æ¡ä»¶"><a href="#3-æ–¹æ³•è°ƒç”¨çš„æ¡ä»¶" class="headerlink" title="3. æ–¹æ³•è°ƒç”¨çš„æ¡ä»¶"></a><strong>3. æ–¹æ³•è°ƒç”¨çš„æ¡ä»¶</strong></h3><ul><li><strong>æ–¹æ³•å­˜åœ¨æ€§</strong>ï¼šç›®æ ‡ç±»éœ€å­˜åœ¨åä¸º&nbsp;<code>refl</code>&nbsp;çš„æ–¹æ³•ã€‚</li><li><strong>æ–¹æ³•ç­¾ååŒ¹é…</strong>ï¼šéœ€åŒ¹é…å‚æ•°ç±»å‹å’Œæ•°é‡ï¼ˆæ­¤å¤„æœªä¼ å‚ï¼Œé»˜è®¤è°ƒç”¨æ— å‚æ–¹æ³•ï¼‰ã€‚</li><li><strong>è®¿é—®æƒé™</strong>ï¼šè‹¥æ–¹æ³•ä¸º&nbsp;<code>private</code>ï¼Œéœ€é€šè¿‡&nbsp;<code>setAccessible(true)</code>&nbsp;çªç ´é™åˆ¶ã€‚</li></ul><table><thead><tr><th><strong>ä»£ç </strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><code>findClass("ç±»å", classLoader)</code></td><td>æŸ¥æ‰¾ç›®æ ‡ç±»</td></tr><tr><td><code>callStaticMethod(clazz, "æ–¹æ³•å", å‚æ•°...)</code></td><td>è°ƒç”¨é™æ€æ–¹æ³•</td></tr><tr><td><code>callMethod(clazz.newInstance(), "æ–¹æ³•å", å‚æ•°...)</code></td><td>åˆ›å»ºå¯¹è±¡å¹¶è°ƒç”¨å®ä¾‹æ–¹æ³•</td></tr></tbody></table><p>  è¿™äº› API åœ¨ <strong>Android é€†å‘ã€Xposed Hookã€Frida Hook</strong> ä¸­éå¸¸å¸¸ç”¨ï¼Œä¸»è¦ç”¨äºï¼š</p><ul><li><strong>è°ƒç”¨æœªå…¬å¼€çš„ç±»å’Œæ–¹æ³•</strong>ã€‚</li><li><strong>ç»•è¿‡å®‰å…¨æ£€æµ‹ï¼ˆå¦‚ <code>isRooted()</code>ã€<code>isSecureMode()</code>ï¼‰</strong>ã€‚</li><li><strong>ä¼ªé€  API è¿”å›å€¼ï¼ˆå¦‚ <code>getDeviceID()</code>ã€<code>getToken()</code>ï¼‰</strong>ã€‚</li></ul></li></ul></li></ul><h3 id="9-Hookå†…éƒ¨ç±»"><a href="#9-Hookå†…éƒ¨ç±»" class="headerlink" title="9.Hookå†…éƒ¨ç±»"></a><strong>9.Hookå†…éƒ¨ç±»</strong></h3><p>å†…éƒ¨ç±»:ç±»é‡Œè¿˜æœ‰ä¸€ä¸ªç±»class</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo$InnerClass"</span>, loadPackageParam.classLoader, <span class="hljs-string">"innerFunc"</span>,String.class,<span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>                param.args[<span class="hljs-number">0</span>] = <span class="hljs-string">"CCå†…éƒ¨ç±»"</span> ;<br>            }<br>        });<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>Hookç±»é‡Œé¢è¿˜æœ‰ä¸€ä¸ªclass</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262107682.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262108404.png"></p><ol><li>ç”¨$ç¬¦æ‹¼æ¥å†…éƒ¨ç±»å</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262108310.png"></p><p>  3.è§¦å‘å†…éƒ¨ç±»çš„æ–¹æ³•</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262108618.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="1-å†…éƒ¨ç±»çš„Hookæ–¹å¼"><a href="#1-å†…éƒ¨ç±»çš„Hookæ–¹å¼" class="headerlink" title="1. å†…éƒ¨ç±»çš„Hookæ–¹å¼"></a><strong>1. å†…éƒ¨ç±»çš„Hookæ–¹å¼</strong></h3><ul><li><p><strong>ç±»åæ ¼å¼</strong>ï¼š</p><p>  å†…éƒ¨ç±»çš„å…¨é™å®šåæ ¼å¼ä¸º&nbsp;<strong><code>å¤–éƒ¨ç±»å$å†…éƒ¨ç±»å</code></strong>ï¼Œä¾‹å¦‚&nbsp;<code>Demo$InnerClass</code>ã€‚</p><ul><li>åŒ¿åå†…éƒ¨ç±»å‘½åé€šå¸¸ä¸º&nbsp;<code>å¤–éƒ¨ç±»å$ç¼–å·</code>ï¼ˆå¦‚&nbsp;<code>Demo$1</code>ï¼‰ã€‚</li></ul></li><li><p><strong>è®¿é—®æƒé™</strong>ï¼š</p><p>  è‹¥å†…éƒ¨ç±»ä¸º&nbsp;<code>private</code>ï¼ŒXposedä»å¯ç›´æ¥Hookï¼Œæ— éœ€é¢å¤–å¤„ç†è®¿é—®æƒé™ã€‚</p></li></ul><h3 id="2-æ–¹æ³•ç­¾ååŒ¹é…"><a href="#2-æ–¹æ³•ç­¾ååŒ¹é…" class="headerlink" title="2. æ–¹æ³•ç­¾ååŒ¹é…"></a><strong>2. æ–¹æ³•ç­¾ååŒ¹é…</strong></h3><ul><li><p><strong>å‚æ•°ç±»å‹</strong>ï¼š</p><p>  éœ€ä¸¥æ ¼åŒ¹é…ç›®æ ‡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ã€‚æ­¤å¤„ç›®æ ‡æ–¹æ³•&nbsp;<code>innerFunc</code>&nbsp;çš„ç­¾åä¸º&nbsp;<code>void innerFunc(String)</code>ã€‚</p></li><li><p><strong>å‚æ•°ç´¢å¼•</strong>ï¼š</p><p>  <code>param.args[0]</code>&nbsp;å¯¹åº”æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆéé™æ€æ–¹æ³•éšå«çš„&nbsp;<code>this</code>&nbsp;å¯¹è±¡ä¸è®¡å…¥å‚æ•°ç´¢å¼•ï¼‰ã€‚</p></li></ul><table><thead><tr><th><strong>ä»£ç </strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><code>findAndHookMethod("ç±»å", classLoader, "æ–¹æ³•å", å‚æ•°ç±»å‹, new XC_MethodHook())</code></td><td>Hook ç›®æ ‡ç±»çš„æ–¹æ³•</td></tr><tr><td><code>param.args[0] = "æ–°å‚æ•°";</code></td><td>ä¿®æ”¹æ–¹æ³•å‚æ•°</td></tr><tr><td><code>param.setResult("æ–°è¿”å›å€¼");</code></td><td>ä¿®æ”¹æ–¹æ³•è¿”å›å€¼</td></tr><tr><td><code>XC_MethodReplacement</code></td><td>ç›´æ¥æ›¿æ¢æ–¹æ³•å®ç°</td></tr><tr><td><code>findClass("å¤–éƒ¨ç±»$å†…éƒ¨ç±»")</code></td><td>è·å–å†…éƒ¨ç±»çš„ <code>Class</code></td></tr></tbody></table><h3 id="åº”ç”¨åœºæ™¯-1"><a href="#åº”ç”¨åœºæ™¯-1" class="headerlink" title="åº”ç”¨åœºæ™¯"></a><strong>åº”ç”¨åœºæ™¯</strong></h3><ul><li>Hook <strong>åŠ å¯†è§£å¯†æ–¹æ³•</strong>ï¼Œä¿®æ”¹å‚æ•°/è¿”å›å€¼ã€‚</li><li>Hook <strong>æ—¥å¿—æ‰“å°æ–¹æ³•</strong>ï¼Œæˆªè·æ•æ„Ÿä¿¡æ¯ã€‚</li><li>Hook <strong>æ£€æµ‹æ–¹æ³•ï¼ˆå¦‚ <code>isRooted()</code>ï¼‰</strong>ï¼Œç»•è¿‡å®‰å…¨æ ¡éªŒã€‚</li></ul><h3 id="1-åŒ¿åå†…éƒ¨ç±»çš„Hook"><a href="#1-åŒ¿åå†…éƒ¨ç±»çš„Hook" class="headerlink" title="1. åŒ¿åå†…éƒ¨ç±»çš„Hook"></a><strong>1. åŒ¿åå†…éƒ¨ç±»çš„Hook</strong></h3><ul><li><p><strong>å®šä½åŒ¿åå†…éƒ¨ç±»</strong>ï¼š</p><p>  é€šè¿‡åç¼–è¯‘å·¥å…·æŸ¥æ‰¾ç±»åï¼ˆå¦‚&nbsp;<code>Demo$1</code>ï¼‰ï¼Œæˆ–é€šè¿‡ä»£ç è¡Œä¸ºåˆ†æç¡®å®šç›®æ ‡æ–¹æ³•ã€‚</p></li><li><p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// HookåŒ¿åå†…éƒ¨ç±»Demo$1çš„æŸä¸ªæ–¹æ³•</span><br>XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo$1"</span>, classLoader, <span class="hljs-string">"run"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> {<br>        <span class="hljs-comment">// ä¿®æ”¹é€»è¾‘</span><br>    }<br>});<br></code></pre></td></tr></tbody></table></figure></li></ul><h3 id="2-é™æ€å†…éƒ¨ç±»çš„å¤„ç†"><a href="#2-é™æ€å†…éƒ¨ç±»çš„å¤„ç†" class="headerlink" title="2. é™æ€å†…éƒ¨ç±»çš„å¤„ç†"></a><strong>2. é™æ€å†…éƒ¨ç±»çš„å¤„ç†</strong></h3><ul><li><p><strong>ç±»åæ ¼å¼</strong>ï¼š</p><p>  é™æ€å†…éƒ¨ç±»åä¸º&nbsp;<code>å¤–éƒ¨ç±»å$é™æ€å†…éƒ¨ç±»å</code>ï¼ŒHookæ–¹å¼ä¸éé™æ€å†…éƒ¨ç±»ä¸€è‡´ã€‚</p></li><li><p><strong>è®¿é—®æƒé™</strong>ï¼š</p><p>  é™æ€å†…éƒ¨ç±»æ— éœ€å¤–éƒ¨ç±»å®ä¾‹å³å¯è®¿é—®ï¼Œå¯ç›´æ¥å®ä¾‹åŒ–ã€‚</p></li></ul><h3 id="3-ä¿®æ”¹éStringç±»å‹å‚æ•°"><a href="#3-ä¿®æ”¹éStringç±»å‹å‚æ•°" class="headerlink" title="3. ä¿®æ”¹éStringç±»å‹å‚æ•°"></a><strong>3. ä¿®æ”¹éStringç±»å‹å‚æ•°</strong></h3><ul><li><p><strong>æ‰©å±•åº”ç”¨</strong>ï¼š</p><p>  æ”¯æŒä»»æ„ç±»å‹å‚æ•°ä¿®æ”¹ï¼ˆéœ€åŒ¹é…ç›®æ ‡æ–¹æ³•ç­¾åï¼‰ã€‚</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¿®æ”¹intç±»å‹å‚æ•°</span><br>param.args[<span class="hljs-number">0</span>] = <span class="hljs-number">123</span>;<br><br><span class="hljs-comment">// ä¿®æ”¹å¯¹è±¡ç±»å‹å‚æ•°</span><br>param.args[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomObject</span>();<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul></li></ul><h3 id="10-åå°„å¤§æ³•"><a href="#10-åå°„å¤§æ³•" class="headerlink" title="10.åå°„å¤§æ³•"></a><strong>10.åå°„å¤§æ³•</strong></h3><ul><li><p>åå°„åŸºæœ¬äº†è§£</p><p>  <strong>åå°„ï¼ˆReflectionï¼‰</strong> æ˜¯ Java æä¾›çš„ä¸€ç§ <strong>åœ¨è¿è¡Œæ—¶åŠ¨æ€æ“ä½œç±»ã€æ–¹æ³•ã€å­—æ®µã€æ„é€ æ–¹æ³•</strong> çš„æœºåˆ¶ã€‚</p><p>  åœ¨å®‰å“é€†å‘ï¼ˆå¦‚ Xposed Hookã€Fridaã€è„±å£³ã€åŠ¨æ€è°ƒè¯•ï¼‰ä¸­ï¼Œåå°„æ˜¯å¸¸ç”¨æŠ€æœ¯ï¼Œå°¤å…¶æ˜¯ï¼š</p><ul><li><strong>ç»•è¿‡éšè— API é™åˆ¶</strong></li><li><strong>è°ƒç”¨ç§æœ‰/æœªå…¬å¼€æ–¹æ³•</strong></li><li><strong>åŠ¨æ€ä¿®æ”¹/è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜</strong></li><li><strong>ç»•è¿‡ <code>ProGuard</code> æ··æ·†</strong></li></ul><h3 id="1-åå°„çš„åŸºæœ¬åŸç†"><a href="#1-åå°„çš„åŸºæœ¬åŸç†" class="headerlink" title="1. åå°„çš„åŸºæœ¬åŸç†"></a><strong>1. åå°„çš„åŸºæœ¬åŸç†</strong></h3><p>  Java åå°„ä¸»è¦ä¾èµ– <code>java.lang.reflect</code> åŒ…ï¼ŒåŒ…å«ï¼š</p><table><thead><tr><th>ç±»</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>Class</code></td><td>è·å–ç±»çš„ä¿¡æ¯ï¼ˆå¦‚æ–¹æ³•ã€å­—æ®µã€æ„é€ å™¨ï¼‰</td></tr><tr><td><code>Method</code></td><td>ä»£è¡¨ç±»çš„æ–¹æ³•ï¼Œå¯ç”¨äºè°ƒç”¨</td></tr><tr><td><code>Field</code></td><td>ä»£è¡¨ç±»çš„å­—æ®µï¼ˆå˜é‡ï¼‰ï¼Œå¯ç”¨äºè¯»å†™</td></tr><tr><td><code>Constructor</code></td><td>ä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¯ç”¨äºå®ä¾‹åŒ–å¯¹è±¡</td></tr></tbody></table><ul><li><strong>åå°„å…è®¸åŠ¨æ€è®¿é—® &amp; ä¿®æ”¹ç±»çš„æˆå‘˜ï¼ˆæ–¹æ³•ã€å˜é‡ï¼‰</strong></li><li><strong>å¯ä»¥ç»•è¿‡ Java è®¿é—®æƒé™ï¼ˆç§æœ‰æ–¹æ³• &amp; å˜é‡ï¼‰</strong></li><li><strong>å¸¸ç”¨äºç»•è¿‡æ£€æµ‹ï¼ˆå¦‚ <code>isRooted()</code>ã€<code>getDeviceID()</code>ï¼‰</strong></li><li><strong>é…åˆ Xposed / Frida è¿›è¡Œé€†å‘åˆ†æ</strong></li><li><strong>Hook <code>Class.forName()</code>ã€<code>Method.invoke()</code> å¯ä»¥æ‹¦æˆªæ‰€æœ‰åå°„è°ƒç”¨</strong></li></ul><h3 id="2-åå°„çš„æ ¸å¿ƒAPI"><a href="#2-åå°„çš„æ ¸å¿ƒAPI" class="headerlink" title="2. åå°„çš„æ ¸å¿ƒAPI"></a><strong>2. åå°„çš„æ ¸å¿ƒAPI</strong></h3><table><thead><tr><th><strong>API</strong></th><th><strong>ç”¨é€”</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><code>Class.forName(String)</code></td><td>åŠ¨æ€åŠ è½½ç±»</td><td><code>Class&lt;?&gt; clazz = Class.forName("com.example.Target");</code></td></tr><tr><td><code>clazz.getDeclaredMethod()</code></td><td>è·å–æ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰ï¼‰</td><td><code>Method method = clazz.getDeclaredMethod("methodName", paramTypes);</code></td></tr><tr><td><code>method.setAccessible(true)</code></td><td>çªç ´è®¿é—®æƒé™é™åˆ¶</td><td><code>method.setAccessible(true);</code></td></tr><tr><td><code>method.invoke(Object,args)</code></td><td>è°ƒç”¨æ–¹æ³•</td><td><code>method.invoke(instance, arg1, arg2);</code></td></tr><tr><td><code>clazz.getDeclaredField()</code></td><td>è·å–å­—æ®µï¼ˆåŒ…æ‹¬ç§æœ‰ï¼‰</td><td><code>Field field = clazz.getDeclaredField("fieldName");</code></td></tr><tr><td><code>field.set(Object, value)</code></td><td>ä¿®æ”¹å­—æ®µå€¼</td><td><code>field.set(instance, newValue);</code></td></tr></tbody></table></li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, lpparam.classLoader);<br>XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.Demo$InnerClass"</span>, lpparam.classLoader, <span class="hljs-string">"innerFunc"</span>,String.class,&nbsp;&nbsp;<span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//ç¬¬ä¸€æ­¥æ‰¾åˆ°ç±»</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//æ‰¾åˆ°æ–¹æ³•ï¼Œå¦‚æœæ˜¯ç§æœ‰æ–¹æ³•å°±è¦setAccessibleè®¾ç½®è®¿é—®æƒé™</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//invokeä¸»åŠ¨è°ƒç”¨æˆ–è€…setä¿®æ”¹å€¼(å˜é‡)</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<span class="hljs-type">Class</span> <span class="hljs-variable">democlass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>,<span class="hljs-literal">false</span>,lpparam.classLoader);<br>                <span class="hljs-type">Method</span> <span class="hljs-variable">demomethod</span> <span class="hljs-operator">=</span> democlass.getDeclaredMethod(<span class="hljs-string">"refl"</span>);<br>                demomethod.setAccessible(<span class="hljs-literal">true</span>);<br>                demomethod.invoke(clazz.newInstance());<br>&nbsp; &nbsp; }<br>});<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>æŸ¥æ‰¾ç›®æ ‡ç±»ï¼ŒHookå†…éƒ¨ç±»æ–¹æ³•å¹¶åœ¨å›è°ƒä¸­åå°„è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•</li><li>æœ‰ä¿®é¥°ç¬¦ï¼Œè¯´æ˜å®ƒæ˜¯ä¸€ä¸ªç§æœ‰çš„æ–¹æ³•ï¼Œéœ€è¦å…ˆå°†æƒé™è®¾ç½®ä¸ºtrueï¼Œç„¶åå†é€šè¿‡invokeæ¥å®ç°ä¸»åŠ¨è°ƒç”¨</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262108154.png"></p><ol><li>å®ä¾‹éœ€è¦å…ˆé€šè¿‡APIæ‰¾åˆ°å½“å‰ç±»åçš„å­—èŠ‚ç ï¼Œä¼ <code>clazz.newInstance()</code>æ¥ä½œä¸ºä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡åå°„æ¥è¿›è¡Œä¸»åŠ¨è°ƒç”¨ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262108773.png"></p><p>  4.å¦‚æœä¸é€šè¿‡ä¸»åŠ¨è°ƒç”¨ï¼Œè€Œæ˜¯setå€¼æ¥è¿›è¡Œä¸€ä¸ªä¿®æ”¹</p><ul><li><p>ä»£ç è§£æ</p><h3 id="1-XposedHelpersçš„ä½œç”¨"><a href="#1-XposedHelpersçš„ä½œç”¨" class="headerlink" title="1. XposedHelpersçš„ä½œç”¨"></a><strong>1. XposedHelpersçš„ä½œç”¨</strong></h3><ul><li><strong>ç®€åŒ–Hookæµç¨‹</strong>ï¼šå°è£…åå°„APIï¼Œç›´æ¥é€šè¿‡ç±»åå’Œæ–¹æ³•åè¿›è¡ŒHookã€‚</li><li><strong>è‡ªåŠ¨å¤„ç†ClassLoader</strong>ï¼šä½¿ç”¨ç›®æ ‡åº”ç”¨çš„&nbsp;<code>lpparam.classLoader</code>ï¼Œé¿å…ç±»åŠ è½½éš”ç¦»é—®é¢˜ã€‚</li></ul><h3 id="2-å†…éƒ¨ç±»çš„Hook"><a href="#2-å†…éƒ¨ç±»çš„Hook" class="headerlink" title="2. å†…éƒ¨ç±»çš„Hook"></a><strong>2. å†…éƒ¨ç±»çš„Hook</strong></h3><ul><li><strong>å‘½åè§„åˆ™</strong>ï¼šå†…éƒ¨ç±»çš„å…¨é™å®šåä¸º&nbsp;<code>å¤–éƒ¨ç±»å$å†…éƒ¨ç±»å</code>ï¼Œå¦‚&nbsp;<code>Demo$InnerClass</code>ã€‚</li><li><strong>é€†å‘æ„ä¹‰</strong>ï¼šå†…éƒ¨ç±»å¸¸åŒ…å«å…³é”®ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚åŠ å¯†ã€æ ¡éªŒï¼‰ï¼ŒHookåå¯å¹²é¢„æ‰§è¡Œæµç¨‹ã€‚</li></ul><h3 id="3-åå°„è°ƒç”¨ç§æœ‰æ–¹æ³•"><a href="#3-åå°„è°ƒç”¨ç§æœ‰æ–¹æ³•" class="headerlink" title="3. åå°„è°ƒç”¨ç§æœ‰æ–¹æ³•"></a><strong>3. åå°„è°ƒç”¨ç§æœ‰æ–¹æ³•</strong></h3><ul><li><strong>æ ¸å¿ƒæ­¥éª¤</strong>ï¼š<ol><li><strong>åŠ è½½ç›®æ ‡ç±»</strong>ï¼š<code>Class.forName()</code>&nbsp;æˆ–&nbsp;<code>XposedHelpers.findClass</code>ã€‚</li><li><strong>è·å–æ–¹æ³•å¯¹è±¡</strong>ï¼š<code>getDeclaredMethod("refl")</code>ï¼ˆå‡è®¾æ— å‚ï¼‰ã€‚</li><li><strong>çªç ´è®¿é—®é™åˆ¶</strong>ï¼š<code>setAccessible(true)</code>ã€‚</li><li><strong>åˆ›å»ºå®ä¾‹å¹¶è°ƒç”¨</strong>ï¼š<code>invoke(clazz.newInstance())</code>ã€‚</li></ol></li><li><strong>é€†å‘åº”ç”¨</strong>ï¼šä¸»åŠ¨è°ƒç”¨ç§æœ‰æ–¹æ³•å¯ç»•è¿‡æ­£å¸¸é€»è¾‘è§¦å‘æ•æ„Ÿæ“ä½œï¼ˆå¦‚ç”Ÿæˆå¯†é’¥ã€è§£é”åŠŸèƒ½ï¼‰ã€‚</li></ul><h3 id="4-åŠ¨æ€å®ä¾‹åŒ–å¯¹è±¡"><a href="#4-åŠ¨æ€å®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="4. åŠ¨æ€å®ä¾‹åŒ–å¯¹è±¡"></a><strong>4. åŠ¨æ€å®ä¾‹åŒ–å¯¹è±¡</strong></h3><ul><li><strong><code>clazz.newInstance()</code>&nbsp;çš„é™åˆ¶</strong>ï¼š<ul><li><p>è¦æ±‚ç›®æ ‡ç±»æœ‰&nbsp;<strong>publicæ— å‚æ„é€ å‡½æ•°</strong>ï¼Œå¦åˆ™æŠ›å‡º&nbsp;<code>InstantiationException</code>ã€‚</p></li><li><p>è‹¥æ„é€ å‡½æ•°ä¸ºç§æœ‰ï¼Œéœ€ä½¿ç”¨&nbsp;<code>XposedHelpers.newInstance()</code>&nbsp;æ›¿ä»£ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¤ºä¾‹ï¼šå¼ºåˆ¶è°ƒç”¨ç§æœ‰æ„é€ æ–¹æ³•</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> XposedHelpers.newInstance(clazz);<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><h2 id="2-Xposed-Hook-æœºåˆ¶"><a href="#2-Xposed-Hook-æœºåˆ¶" class="headerlink" title="2. Xposed Hook æœºåˆ¶"></a><strong>2. Xposed Hook æœºåˆ¶</strong></h2><h3 id="â‘ -findClass-ï¼šæŸ¥æ‰¾ç±»"><a href="#â‘ -findClass-ï¼šæŸ¥æ‰¾ç±»" class="headerlink" title="â‘  findClass()ï¼šæŸ¥æ‰¾ç±»"></a><strong>â‘  <code>findClass()</code>ï¼šæŸ¥æ‰¾ç±»</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, lpparam.classLoader);<br></code></pre></td></tr></tbody></table></figure><h3 id="ç›¸å…³çŸ¥è¯†ç‚¹"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a><strong>ç›¸å…³çŸ¥è¯†ç‚¹</strong></h3><ul><li><code>XposedHelpers.findClass(className, classLoader)</code>ï¼š<ul><li><p>ä½œç”¨ï¼šåœ¨ç›®æ ‡åº”ç”¨çš„ <code>ClassLoader</code> é‡ŒæŸ¥æ‰¾ <code>com.zj.wuaipojie.Demo</code> ç±»ã€‚</p></li><li><p><code>lpparam.classLoader</code>ï¼šç”± <code>Xposed</code> æä¾›ï¼Œç¡®ä¿åŠ è½½çš„æ˜¯ç›®æ ‡åº”ç”¨çš„ç±»ã€‚</p></li><li><p><strong>ç­‰æ•ˆçš„ Java ä»£ç ï¼š</strong></p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Class&lt;?&gt; clazz = Class.forName(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, <span class="hljs-literal">false</span>, lpparam.classLoader);<br><br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><hr><h3 id="â‘¡-findAndHookMethod-ï¼šHook-å†…éƒ¨ç±»çš„æ–¹æ³•"><a href="#â‘¡-findAndHookMethod-ï¼šHook-å†…éƒ¨ç±»çš„æ–¹æ³•" class="headerlink" title="â‘¡ findAndHookMethod()ï¼šHook å†…éƒ¨ç±»çš„æ–¹æ³•"></a><strong>â‘¡ <code>findAndHookMethod()</code>ï¼šHook å†…éƒ¨ç±»çš„æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<br>    <span class="hljs-string">"com.zj.wuaipojie.Demo$InnerClass"</span>,<br>    lpparam.classLoader,<br>    <span class="hljs-string">"innerFunc"</span>,<br>    String.class,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>            <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br></code></pre></td></tr></tbody></table></figure><h3 id="ç›¸å…³çŸ¥è¯†ç‚¹-1"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹-1" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a><strong>ç›¸å…³çŸ¥è¯†ç‚¹</strong></h3><ul><li><code>findAndHookMethod(className, classLoader, methodName, paramTypes..., XC_MethodHook)</code>ï¼š<ul><li>ä½œç”¨ï¼šHook ç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œä¿®æ”¹ <code>innerFunc(String)</code> çš„æ‰§è¡Œè¡Œä¸ºã€‚</li><li><strong><code>com.zj.wuaipojie.Demo$InnerClass</code></strong>ï¼š<ul><li><code>$</code> è¡¨ç¤º <strong>å†…éƒ¨ç±»</strong>ï¼Œå³ <code>InnerClass</code> æ˜¯ <code>Demo</code> ç±»çš„ <strong>æˆå‘˜å†…éƒ¨ç±»</strong>ã€‚</li><li><code>InnerClass</code> å¿…é¡»æ˜¯ <strong>éé™æ€ï¼ˆé staticï¼‰</strong>ï¼Œå¦åˆ™å®ƒçš„ <code>this</code> éœ€è¦ <code>Demo</code> å®ä¾‹ã€‚</li></ul></li><li><code>beforeHookedMethod()</code>ï¼š<ul><li><strong>åœ¨åŸæ–¹æ³•æ‰§è¡Œå‰</strong> è¿è¡Œï¼Œå¯ä»¥ <strong>ä¿®æ”¹å‚æ•°ã€æ‹¦æˆªæ‰§è¡Œ</strong>ã€‚</li></ul></li></ul></li></ul><hr><h2 id="3-Java-åå°„è°ƒç”¨-Demo-refl"><a href="#3-Java-åå°„è°ƒç”¨-Demo-refl" class="headerlink" title="3. Java åå°„è°ƒç”¨ Demo.refl()"></a><strong>3. Java åå°„è°ƒç”¨ <code>Demo.refl()</code></strong></h2><h3 id="â‘¢-Class-forName-ï¼šé€šè¿‡åå°„æŸ¥æ‰¾ç±»"><a href="#â‘¢-Class-forName-ï¼šé€šè¿‡åå°„æŸ¥æ‰¾ç±»" class="headerlink" title="â‘¢ Class.forName()ï¼šé€šè¿‡åå°„æŸ¥æ‰¾ç±»"></a><strong>â‘¢ <code>Class.forName()</code>ï¼šé€šè¿‡åå°„æŸ¥æ‰¾ç±»</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">democlass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, <span class="hljs-literal">false</span>, lpparam.classLoader);<br><br></code></pre></td></tr></tbody></table></figure><h3 id="ç›¸å…³çŸ¥è¯†ç‚¹-2"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹-2" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a><strong>ç›¸å…³çŸ¥è¯†ç‚¹</strong></h3><ul><li><code>Class.forName(className, initialize, classLoader)</code>ï¼š<ul><li><p><strong>ä½œç”¨</strong>ï¼šåŠ¨æ€åŠ è½½ <code>Demo</code> ç±»ï¼Œ<code>false</code> ä»£è¡¨ <strong>ä¸è§¦å‘é™æ€åˆå§‹åŒ–</strong>ã€‚</p></li><li><p><strong>ç­‰æ•ˆçš„ Xposed æ–¹æ³•</strong>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Class&lt;?&gt; clazz = XposedHelpers.findClass(<span class="hljs-string">"com.zj.wuaipojie.Demo"</span>, lpparam.classLoader);<br><br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul><hr><h3 id="â‘£-getDeclaredMethod-ï¼šè·å–ç§æœ‰æ–¹æ³•"><a href="#â‘£-getDeclaredMethod-ï¼šè·å–ç§æœ‰æ–¹æ³•" class="headerlink" title="â‘£ getDeclaredMethod()ï¼šè·å–ç§æœ‰æ–¹æ³•"></a><strong>â‘£ <code>getDeclaredMethod()</code>ï¼šè·å–ç§æœ‰æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Method</span> <span class="hljs-variable">demomethod</span> <span class="hljs-operator">=</span> democlass.getDeclaredMethod(<span class="hljs-string">"refl"</span>);<br>demomethod.setAccessible(<span class="hljs-literal">true</span>);<br><br></code></pre></td></tr></tbody></table></figure><h3 id="ç›¸å…³çŸ¥è¯†ç‚¹-3"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹-3" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a><strong>ç›¸å…³çŸ¥è¯†ç‚¹</strong></h3><ul><li><strong><code>getDeclaredMethod(methodName, å‚æ•°ç±»å‹...)</code></strong><ul><li><strong>ä½œç”¨</strong>ï¼šæŸ¥æ‰¾ <code>refl()</code> æ–¹æ³•ï¼ˆåŒ…æ‹¬ <code>private</code>ï¼‰ã€‚</li><li><strong>åŒºåˆ«</strong>ï¼š<ul><li><code>getMethod()</code>ï¼šåªèƒ½è·å– <code>public</code> æ–¹æ³•ã€‚</li><li><code>getDeclaredMethod()</code>ï¼šå¯è·å– <code>private</code> / <code>protected</code> æ–¹æ³•ã€‚</li></ul></li></ul></li><li><strong><code>setAccessible(true)</code></strong><ul><li>è§£é™¤ Java è®¿é—®æƒé™ï¼Œå…è®¸è°ƒç”¨ <code>private</code> æ–¹æ³•ã€‚</li><li><strong>ç»•è¿‡ ProGuard æ··æ·†</strong>ï¼š<ul><li>å³ä½¿ <code>refl()</code> è¢«æ··æ·†æˆ <code>a()</code>ï¼Œä»å¯é€šè¿‡åå°„è°ƒç”¨ã€‚</li></ul></li></ul></li></ul><hr><h3 id="â‘¤-invoke-ï¼šåå°„è°ƒç”¨-refl-æ–¹æ³•"><a href="#â‘¤-invoke-ï¼šåå°„è°ƒç”¨-refl-æ–¹æ³•" class="headerlink" title="â‘¤ invoke()ï¼šåå°„è°ƒç”¨ refl() æ–¹æ³•"></a><strong>â‘¤ <code>invoke()</code>ï¼šåå°„è°ƒç”¨ <code>refl()</code> æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">demomethod.invoke(clazz.newInstance());<br><br></code></pre></td></tr></tbody></table></figure><h3 id="ç›¸å…³çŸ¥è¯†ç‚¹-4"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹-4" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a><strong>ç›¸å…³çŸ¥è¯†ç‚¹</strong></h3><ul><li><strong><code>invoke(å¯¹è±¡, å‚æ•°...)</code></strong><ul><li><p>ä½œç”¨ï¼šåœ¨ <code>clazz.newInstance()</code> å¯¹è±¡ä¸Šè°ƒç”¨ <code>refl()</code> æ–¹æ³•ã€‚</p></li><li><p><code>clazz.newInstance()</code> ç­‰ä»·äºï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">demoInstance</span> <span class="hljs-operator">=</span> democlass.getConstructor().newInstance();<br>demomethod.invoke(demoInstance);<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>æ³¨æ„ï¼š</strong></p><ul><li><p><code>newInstance()</code> åªèƒ½ç”¨äº <strong>æ— å‚æ„é€ æ–¹æ³•</strong>ã€‚</p></li><li><p>å¦‚æœ <code>Demo</code> æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œåº”ä½¿ç”¨ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Constructor&lt;?&gt; constructor = democlass.getDeclaredConstructor(String.class);<br>constructor.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-type">Object</span> <span class="hljs-variable">demoInstance</span> <span class="hljs-operator">=</span> constructor.newInstance(<span class="hljs-string">"å‚æ•°"</span>);<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul></li></ul></li></ul></li></ul><h3 id="11-éå†æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•"><a href="#11-éå†æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•" class="headerlink" title="11.éå†æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•"></a><strong>11.éå†æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(ClassLoader.class, <span class="hljs-string">"loadClass"</span>, String.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>                <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> (Class) param.getResult();<br>                <span class="hljs-type">String</span> <span class="hljs-variable">clazzName</span> <span class="hljs-operator">=</span> clazz.getName();<br>                <span class="hljs-comment">//æ’é™¤éåŒ…åçš„ç±»</span><br>                <span class="hljs-keyword">if</span>(clazzName.contains(<span class="hljs-string">"com.zj.wuaipojie"</span>)){<br>                    Method[] mds = clazz.getDeclaredMethods();<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i&lt;mds.length; i++){<br>                        <span class="hljs-keyword">final</span> <span class="hljs-type">Method</span> <span class="hljs-variable">md</span> <span class="hljs-operator">=</span> mds[i];<br>                        <span class="hljs-type">int</span> <span class="hljs-variable">mod</span> <span class="hljs-operator">=</span> mds[i].getModifiers();<br>                    <span class="hljs-comment">//å»é™¤æŠ½è±¡ã€nativeã€æ¥å£æ–¹æ³•</span><br>                        <span class="hljs-keyword">if</span>(!Modifier.isAbstract(mod)<br>                            &amp;&amp; !Modifier.isNative(mod)<br>                            &amp;&amp; !Modifier.isInterface(mod)){<br>                            XposedBridge.hookMethod(mds[i], <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>                                <span class="hljs-meta">@Override</span><br>                                <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                                    <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>                                    Log.d(<span class="hljs-string">"zj2595"</span>,md.toString());<br>                                }<br>                            });<br>                        }<br>                    }<br>                }<br>            }<br>        });<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>å°†åŠ è½½è¯¥ç•Œé¢æ—¶æ‰€ç”¨çš„æ–¹æ³•åŠ è½½éå†äº†å‡ºæ¥</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262109554.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="1-Hook-ClassLoader-loadClass-çš„æ„å›¾"><a href="#1-Hook-ClassLoader-loadClass-çš„æ„å›¾" class="headerlink" title="1. Hook&nbsp;ClassLoader.loadClass&nbsp;çš„æ„å›¾"></a><strong>1. Hook&nbsp;<code>ClassLoader.loadClass</code>&nbsp;çš„æ„å›¾</strong></h3><ul><li><strong>åŠ¨æ€ç›‘æ§ç±»åŠ è½½</strong>ï¼šåœ¨ç±»è¢«åŠ è½½åˆ°å†…å­˜æ—¶è§¦å‘å›è°ƒï¼Œå®æ—¶æ•è·ç›®æ ‡ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚</li><li><strong>é€†å‘ä»·å€¼</strong>ï¼š<ul><li>æ‰¹é‡Hookæ··æ·†åçš„ç±»å’Œæ–¹æ³•ï¼ˆæ— éœ€æå‰çŸ¥é“å…·ä½“åç§°ï¼‰ã€‚</li><li>è·Ÿè¸ªåº”ç”¨åˆå§‹åŒ–æµç¨‹ï¼Œå®šä½å…³é”®é€»è¾‘ï¼ˆå¦‚åŠ å¯†ã€ç½‘ç»œè¯·æ±‚ï¼‰ã€‚</li></ul></li></ul><h3 id="2-æ–¹æ³•è¿‡æ»¤é€»"><a href="#2-æ–¹æ³•è¿‡æ»¤é€»" class="headerlink" title="2. æ–¹æ³•è¿‡æ»¤é€»"></a><strong>2. æ–¹æ³•è¿‡æ»¤é€»</strong></h3><ul><li><strong>æ’é™¤æŠ½è±¡æ–¹æ³•</strong>ï¼šæŠ½è±¡æ–¹æ³•æ— å®é™…ä»£ç ï¼ŒHookæ— æ„ä¹‰ã€‚</li><li><strong>æ’é™¤Nativeæ–¹æ³•</strong>ï¼šNativeæ–¹æ³•ï¼ˆJNIå®ç°ï¼‰æ— æ³•é€šè¿‡Javaå±‚Hookã€‚</li><li><strong>æ’é™¤æ¥å£æ–¹æ³•</strong>ï¼šæ¥å£æ–¹æ³•ç”±å®ç°ç±»å…·ä½“å®šä¹‰ï¼Œç›´æ¥Hookæ¥å£å¯èƒ½å¯¼è‡´é‡å¤æ‹¦æˆªã€‚</li></ul><h3 id="3-åŠ¨æ€æ’æ¡©ï¼ˆInstrumentationï¼‰"><a href="#3-åŠ¨æ€æ’æ¡©ï¼ˆInstrumentationï¼‰" class="headerlink" title="3. åŠ¨æ€æ’æ¡©ï¼ˆInstrumentationï¼‰"></a><strong>3. åŠ¨æ€æ’æ¡©ï¼ˆInstrumentationï¼‰</strong></h3><ul><li><strong>æŠ€æœ¯æœ¬è´¨</strong>ï¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰/åæ’å…¥è‡ªå®šä¹‰ä»£ç ï¼ˆå¦‚æ—¥å¿—ã€å‚æ•°ä¿®æ”¹ï¼‰ã€‚</li><li><strong>é€†å‘åº”ç”¨</strong>ï¼š<ul><li>ç›‘æ§æ–¹æ³•è°ƒç”¨é¡ºåºï¼Œåˆ†æä»£ç æ‰§è¡Œæµç¨‹</li><li>åŠ¨æ€ä¿®æ”¹æ–¹æ³•å‚æ•°æˆ–è¿”å›å€¼ï¼ˆéœ€åœ¨<code>beforeHookedMethod</code>ä¸­æ“ä½œï¼‰ã€‚</li></ul></li></ul><h3 id="1-Hook-ClassLoader-loadClass"><a href="#1-Hook-ClassLoader-loadClass" class="headerlink" title="(1) Hook ClassLoader.loadClass()"></a><strong>(1) Hook <code>ClassLoader.loadClass()</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<br>    ClassLoader.class,<br>    <span class="hljs-string">"loadClass"</span>,<br>    String.class,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>            <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨"><a href="#ğŸ”¹-ä½œç”¨" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p><strong>Hook <code>ClassLoader.loadClass(String)</code> æ–¹æ³•</strong>ï¼Œåœ¨ç±»è¢«åŠ è½½åæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚</p></li><li><p><strong>ç­‰æ•ˆ Java ä»£ç ï¼š</strong></p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> getClass().getClassLoader();<br>Class&lt;?&gt; clazz = classLoader.loadClass(<span class="hljs-string">"com.example.MyClass"</span>);<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>Xposed Hook æ–¹å¼ï¼š</strong></p><ul><li><code>afterHookedMethod()</code> ç¡®ä¿ <code>loadClass()</code> æ–¹æ³•æ‰§è¡Œåï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°è¢«åŠ è½½çš„ <code>Class&lt;?&gt;</code> å¯¹è±¡ã€‚</li></ul></li></ul><hr><h3 id="2-è·å–-loadClass-ç»“æœï¼ˆå³æ–°åŠ è½½çš„ç±»ï¼‰"><a href="#2-è·å–-loadClass-ç»“æœï¼ˆå³æ–°åŠ è½½çš„ç±»ï¼‰" class="headerlink" title="(2) è·å– loadClass() ç»“æœï¼ˆå³æ–°åŠ è½½çš„ç±»ï¼‰"></a><strong>(2) è·å– <code>loadClass()</code> ç»“æœï¼ˆå³æ–°åŠ è½½çš„ç±»ï¼‰</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> (Class) param.getResult();<br><span class="hljs-type">String</span> <span class="hljs-variable">clazzName</span> <span class="hljs-operator">=</span> clazz.getName();<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-1"><a href="#ğŸ”¹-ä½œç”¨-1" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><code>param.getResult()</code>ï¼šè·å– <code>loadClass(String)</code> çš„è¿”å›å€¼ï¼Œå³ <code>Class&lt;?&gt;</code> å¯¹è±¡ã€‚</li><li><code>clazz.getName()</code>ï¼šè·å–ç±»åï¼Œä¾‹å¦‚ <code>"com.zj.wuaipojie.Demo"</code>ã€‚</li></ul><hr><h3 id="3-è¿‡æ»¤ç›®æ ‡åŒ…å"><a href="#3-è¿‡æ»¤ç›®æ ‡åŒ…å" class="headerlink" title="(3) è¿‡æ»¤ç›®æ ‡åŒ…å"></a><strong>(3) è¿‡æ»¤ç›®æ ‡åŒ…å</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(clazzName.contains(<span class="hljs-string">"com.zj.wuaipojie"</span>)) {<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-2"><a href="#ğŸ”¹-ä½œç”¨-2" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>åª Hook ç›®æ ‡åº”ç”¨çš„ç±»ï¼Œé¿å… Hook ç³»ç»Ÿç±»ï¼ˆå¦‚ <code>android.*</code>ï¼‰ã€‚</p></li><li><p>è¿™é‡Œä½¿ç”¨äº† <code>contains()</code>ï¼Œå¯ä»¥ä¼˜åŒ–ä¸ºï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(clazzName.startsWith(<span class="hljs-string">"com.zj.wuaipojie"</span>))<br></code></pre></td></tr></tbody></table></figure><p>  è¿™æ ·èƒ½ <strong>ç²¾ç¡®åŒ¹é…åŒ…åå¼€å¤´</strong>ï¼Œå‡å°‘è¯¯åˆ¤ã€‚</p></li></ul><hr><h3 id="4-è·å–-clazz-çš„æ‰€æœ‰æ–¹æ³•"><a href="#4-è·å–-clazz-çš„æ‰€æœ‰æ–¹æ³•" class="headerlink" title="(4) è·å– clazz çš„æ‰€æœ‰æ–¹æ³•"></a><strong>(4) è·å– <code>clazz</code> çš„æ‰€æœ‰æ–¹æ³•</strong></h3><h3 id="ğŸ”¹-ä½œç”¨-3"><a href="#ğŸ”¹-ä½œç”¨-3" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>è·å– <strong>æ‰€æœ‰</strong> æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>private</code>ã€<code>protected</code> å’Œ <code>public</code> æ–¹æ³•ã€‚</p></li><li><p><strong>ç­‰æ•ˆ Java ä»£ç ï¼š</strong></p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Method[] methods = clazz.getDeclaredMethods();<br></code></pre></td></tr></tbody></table></figure></li></ul><hr><h3 id="5-éå†æ–¹æ³•ï¼Œç­›é€‰å¯-Hook-æ–¹æ³•"><a href="#5-éå†æ–¹æ³•ï¼Œç­›é€‰å¯-Hook-æ–¹æ³•" class="headerlink" title="(5) éå†æ–¹æ³•ï¼Œç­›é€‰å¯ Hook æ–¹æ³•"></a><strong>(5) éå†æ–¹æ³•ï¼Œç­›é€‰å¯ Hook æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mds.length; i++) {<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">Method</span> <span class="hljs-variable">md</span> <span class="hljs-operator">=</span> mds[i];<br>    <span class="hljs-type">int</span> <span class="hljs-variable">mod</span> <span class="hljs-operator">=</span> mds[i].getModifiers();<br>    <span class="hljs-comment">// å»é™¤æŠ½è±¡ã€nativeã€æ¥å£æ–¹æ³•</span><br>    <span class="hljs-keyword">if</span> (!Modifier.isAbstract(mod)<br>        &amp;&amp; !Modifier.isNative(mod)<br>        &amp;&amp; !Modifier.isInterface(mod)) { <br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-4"><a href="#ğŸ”¹-ä½œç”¨-4" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li>è¿‡æ»¤æ‰æ— æ³•ç›´æ¥ Hook çš„æ–¹æ³•ï¼š<ul><li><code>Modifier.isAbstract(mod)</code>ï¼šæŠ½è±¡æ–¹æ³•ä¸èƒ½ç›´æ¥ Hookã€‚</li><li><code>Modifier.isNative(mod)</code>ï¼š<code>native</code> æ–¹æ³•éœ€è¦ Frida æˆ– JNI Hookã€‚</li><li><code>Modifier.isInterface(mod)</code>ï¼šæ¥å£æ–¹æ³•ä¸èƒ½ Hookã€‚</li></ul></li></ul><hr><h3 id="6-Hook-é€‰å®šçš„æ–¹æ³•"><a href="#6-Hook-é€‰å®šçš„æ–¹æ³•" class="headerlink" title="(6) Hook é€‰å®šçš„æ–¹æ³•"></a><strong>(6) Hook é€‰å®šçš„æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedBridge.hookMethod(mds[i], <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>        <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>        Log.d(<span class="hljs-string">"zj2595"</span>, md.toString());<br>    }<br>});<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-5"><a href="#ğŸ”¹-ä½œç”¨-5" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p><strong>Hook ç›®æ ‡æ–¹æ³•</strong>ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰æ‰“å°æ–¹æ³•ç­¾åï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Log.d(<span class="hljs-string">"zj2595"</span>, md.toString());<br></code></pre></td></tr></tbody></table></figure><p>  è¿™å°†åœ¨ Logcat é‡Œè¾“å‡ºï¼š</p>  <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">D/zj2595: public void com<span class="hljs-selector-class">.zj</span><span class="hljs-selector-class">.wuaipojie</span><span class="hljs-selector-class">.Demo</span><span class="hljs-selector-class">.testMethod</span>()<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul></li></ul><h3 id="12-Xposedå¦™ç”¨"><a href="#12-Xposedå¦™ç”¨" class="headerlink" title="12.Xposedå¦™ç”¨"></a><strong>12.Xposedå¦™ç”¨</strong></h3><p>å­—ç¬¦ä¸²èµ‹å€¼å®šä½:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"android.widget.TextView"</span>, loadPackageParam.classLoader, <span class="hljs-string">"setText"</span>, CharSequence.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br>                Log.d(<span class="hljs-string">"zj2595"</span>, param.args[<span class="hljs-number">0</span>].toString());<br>                <span class="hljs-keyword">if</span> (param.args[<span class="hljs-number">0</span>].equals(<span class="hljs-string">"å·²è¿‡æœŸ"</span>)) {<br>                    printStackTrace();<br>                }<br>            }<br>        });<br>    }<br>    <span class="hljs-comment">//å †æ ˆè°ƒç”¨</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printStackTrace</span><span class="hljs-params">()</span> {<br>            <span class="hljs-type">Throwable</span> <span class="hljs-variable">ex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Throwable</span>();<br>            StackTraceElement[] stackElements = ex.getStackTrace();<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; stackElements.length; i++) {<br>                <span class="hljs-type">StackTraceElement</span> <span class="hljs-variable">element</span> <span class="hljs-operator">=</span> stackElements[i];<br>                Log.d(<span class="hljs-string">"zj2595"</span>,<span class="hljs-string">"at "</span> + element.getClassName() + <span class="hljs-string">"."</span> + element.getMethodName() + <span class="hljs-string">"("</span> + element.getFileName() + <span class="hljs-string">":"</span> + element.getLineNumber() + <span class="hljs-string">")"</span>);<br>            }<br>        }<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>æ‰¾åˆ°æ–¹æ³•åï¼Œå…ˆè¾“å‡ºä¸€ä¸‹ï¼ŒæŸ¥çœ‹æ˜¯ä»€ä¹ˆå­—ç¬¦ä¸²è¿›è¡Œçš„settext</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262109236.png"></p><ol><li>å¯¹å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ï¼Œè¾“å‡ºå †æ ˆï¼Œæˆ‘ä»¬å‘ç°è°ƒç”¨settextçš„æ˜¯oncreateæ–¹æ³•ï¼Œå¦‚æœè¦ä¿®æ”¹å­—ç¬¦ä¸²é€šè¿‡å †æ ˆè°ƒç”¨æ‰¾åˆ°è¯¥æ–¹æ³•ï¼Œå¯¹å­—ç¬¦ä¸²åŠè¿›è¡Œä¿®æ”¹ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262109960.png"></p><ul><li><p>ä»£ç è¯¦è§£</p><h3 id="1-Hook-TextView-setText"><a href="#1-Hook-TextView-setText" class="headerlink" title="(1) Hook TextView.setText()"></a><strong>(1) Hook <code>TextView.setText()</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<br>    <span class="hljs-string">"android.widget.TextView"</span>,<br>    lpparam.classLoader,<br>    <span class="hljs-string">"setText"</span>,<br>    CharSequence.class,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>            <span class="hljs-built_in">super</span>.beforeHookedMethod(param);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-6"><a href="#ğŸ”¹-ä½œç”¨-6" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><strong>æ‹¦æˆª <code>TextView.setText(CharSequence)</code> æ–¹æ³•</strong>ï¼Œç”¨äºç›‘æ§ App å†…çš„ <strong>æ‰€æœ‰ UI æ–‡æœ¬æ›´æ–°</strong>ã€‚</li><li><code>param.args[0]</code> ä»£è¡¨ <code>setText()</code> ä¼ å…¥çš„æ–‡æœ¬å†…å®¹ã€‚</li></ul><hr><h3 id="2-è®°å½•-setText-çš„å†…å®¹"><a href="#2-è®°å½•-setText-çš„å†…å®¹" class="headerlink" title="(2) è®°å½• setText() çš„å†…å®¹"></a><strong>(2) è®°å½• <code>setText()</code> çš„å†…å®¹</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Log.d(<span class="hljs-string">"zj2595"</span>, param.args[<span class="hljs-number">0</span>].toString());<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-7"><a href="#ğŸ”¹-ä½œç”¨-7" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>æ‰“å° <code>TextView</code> è®¾ç½®çš„æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š</p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">D/zj2595: è¯•ç”¨æœŸå·²è¿‡<br>D/zj2595: è¯·æ›´æ–°åˆ°æœ€æ–°ç‰ˆ<br></code></pre></td></tr></tbody></table></figure></li></ul><hr><h3 id="3-æ£€æµ‹ç›®æ ‡æ–‡æœ¬-å·²è¿‡æœŸ"><a href="#3-æ£€æµ‹ç›®æ ‡æ–‡æœ¬-å·²è¿‡æœŸ" class="headerlink" title="(3) æ£€æµ‹ç›®æ ‡æ–‡æœ¬ &quot;å·²è¿‡æœŸ&quot;"></a><strong>(3) æ£€æµ‹ç›®æ ‡æ–‡æœ¬ <code>"å·²è¿‡æœŸ"</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (param.args[<span class="hljs-number">0</span>].equals(<span class="hljs-string">"å·²è¿‡æœŸ"</span>)) {<br>    printStackTrace();<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-8"><a href="#ğŸ”¹-ä½œç”¨-8" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><strong>å¦‚æœæ–‡æœ¬æ˜¯ <code>"å·²è¿‡æœŸ"</code>ï¼Œè°ƒç”¨ <code>printStackTrace()</code> æ‰“å°è°ƒç”¨æ ˆ</strong>ï¼Œå¸®åŠ©åˆ†ææ˜¯è°è°ƒç”¨äº† <code>setText()</code> æ–¹æ³•ã€‚</li></ul><hr><h3 id="4-æ‰“å°è°ƒç”¨æ ˆ"><a href="#4-æ‰“å°è°ƒç”¨æ ˆ" class="headerlink" title="(4) æ‰“å°è°ƒç”¨æ ˆ"></a><strong>(4) æ‰“å°è°ƒç”¨æ ˆ</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printStackTrace</span><span class="hljs-params">()</span> {<br>    <span class="hljs-type">Throwable</span> <span class="hljs-variable">ex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Throwable</span>();<br>    StackTraceElement[] stackElements = ex.getStackTrace();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; stackElements.length; i++) {<br>        <span class="hljs-type">StackTraceElement</span> <span class="hljs-variable">element</span> <span class="hljs-operator">=</span> stackElements[i];<br>        Log.d(<span class="hljs-string">"zj2595"</span>, <span class="hljs-string">"at "</span> + element.getClassName() + <span class="hljs-string">"."</span> + element.getMethodName() + <span class="hljs-string">"("</span> + element.getFileName() + <span class="hljs-string">":"</span> + element.getLineNumber() + <span class="hljs-string">")"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-9"><a href="#ğŸ”¹-ä½œç”¨-9" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>åˆ›å»º <code>Throwable</code> å¯¹è±¡ï¼Œè·å–å½“å‰æ–¹æ³•çš„ <strong>è°ƒç”¨å †æ ˆ</strong>ï¼ˆStack Traceï¼‰ã€‚</p></li><li><p>éå† <code>StackTraceElement[]</code>ï¼Œæ‰“å°æ–¹æ³•è°ƒç”¨è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p>  <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">D/zj2595: at com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.MainActivity</span><span class="hljs-selector-class">.onCreate</span>(MainActivity<span class="hljs-selector-class">.java</span>:<span class="hljs-number">42</span>)<br>D/zj2595: at android<span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.Activity</span><span class="hljs-selector-class">.performCreate</span>(Activity<span class="hljs-selector-class">.java</span>:<span class="hljs-number">789</span>)<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>å¸®åŠ©åˆ†ææ˜¯è°åœ¨ <code>setText("å·²è¿‡æœŸ")</code>ï¼Œè¿›è€Œæ‰¾åˆ°ä¸šåŠ¡é€»è¾‘ï¼</strong></p></li></ul><h3 id="å…³é”®APIè¯´æ˜"><a href="#å…³é”®APIè¯´æ˜" class="headerlink" title="å…³é”®APIè¯´æ˜"></a><strong>å…³é”®APIè¯´æ˜</strong></h3><ul><li><p><strong><code>param.args[0]</code></strong>ï¼š</p><p>  <code>setText</code>&nbsp;æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆ<code>CharSequence</code>&nbsp;ç±»å‹ï¼‰ï¼Œå³è¦æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ã€‚</p></li><li><p><strong><code>Throwable.getStackTrace()</code></strong>ï¼š</p><p>  è·å–å½“å‰çº¿ç¨‹çš„è°ƒç”¨å †æ ˆï¼Œç”¨äºè¿½è¸ªæ–¹æ³•è°ƒç”¨å±‚çº§ã€‚</p></li></ul></li></ul></li></ul><p>ç‚¹å‡»äº‹ä»¶ç›‘å¬:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">claz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"android.view.View"</span>, loadPackageParam.classLoader);<br>        XposedBridge.hookAllMethods(clazz, <span class="hljs-string">"performClick"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>                <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>                <span class="hljs-type">Object</span> <span class="hljs-variable">listenerInfoObject</span> <span class="hljs-operator">=</span> XposedHelpers.getObjectField(param.thisObject, <span class="hljs-string">"mListenerInfo"</span>);<br>                <span class="hljs-type">Object</span> <span class="hljs-variable">mOnClickListenerObject</span> <span class="hljs-operator">=</span> XposedHelpers.getObjectField(listenerInfoObject, <span class="hljs-string">"mOnClickListener"</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">callbackType</span> <span class="hljs-operator">=</span> mOnClickListenerObject.getClass().getName();Log.d(<span class="hljs-string">"zj2595"</span>,callbackType);<br>            }<br>        });<br><br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>æˆ‘ä»¬å¯ä»¥å‘ç°ç‚¹å‡»æŒ‰é’®åçš„æ–¹æ³•è¢«æ‰“å°å‡ºæ¥</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262109835.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="1-Hook-View-performClick"><a href="#1-Hook-View-performClick" class="headerlink" title="(1) Hook View.performClick()"></a><strong>(1) Hook <code>View.performClick()</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> XposedHelpers.findClass(<span class="hljs-string">"android.view.View"</span>, lpparam.classLoader);<br>XposedBridge.hookAllMethods(clazz, <span class="hljs-string">"performClick"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹ä½œç”¨"><a href="#ğŸ”¹ä½œç”¨" class="headerlink" title="ğŸ”¹ä½œç”¨"></a><strong>ğŸ”¹ä½œç”¨</strong></h3><ul><li><code>performClick()</code> æ˜¯ <strong>æ‰€æœ‰ç‚¹å‡»äº‹ä»¶çš„æ ¸å¿ƒæ–¹æ³•</strong>ï¼Œæœ€ç»ˆä¼šè§¦å‘ <code>OnClickListener.onClick(View v)</code> æ–¹æ³•ã€‚</li><li><strong>é€šè¿‡ Hook <code>performClick()</code>ï¼Œå¯ä»¥æ‹¦æˆªæ‰€æœ‰ <code>View</code> çš„ç‚¹å‡»äº‹ä»¶ï¼Œè·å–å…·ä½“çš„ <code>OnClickListener</code> ç›‘å¬å™¨</strong>ã€‚</li></ul><hr><h3 id="2-è·å–-View-çš„-mListenerInfo"><a href="#2-è·å–-View-çš„-mListenerInfo" class="headerlink" title="(2) è·å– View çš„ mListenerInfo"></a><strong>(2) è·å– <code>View</code> çš„ <code>mListenerInfo</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">listenerInfoObject</span> <span class="hljs-operator">=</span> XposedHelpers.getObjectField(param.thisObject, <span class="hljs-string">"mListenerInfo"</span>);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-10"><a href="#ğŸ”¹-ä½œç”¨-10" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><strong><code>View</code> å¹¶ä¸ä¼šç›´æ¥å­˜å‚¨ <code>OnClickListener</code>ï¼Œè€Œæ˜¯æ”¾åœ¨ <code>mListenerInfo</code> è¿™ä¸ªå†…éƒ¨å¯¹è±¡ä¸­</strong>ã€‚</li><li>è¿™é‡Œ <strong>é€šè¿‡ Xposed åå°„ <code>getObjectField()</code> è¯»å– <code>mListenerInfo</code> å¯¹è±¡</strong>ï¼Œå®ƒæ˜¯ <code>View.ListenerInfo</code> ç±»çš„å®ä¾‹ï¼ŒåŒ…å« <code>mOnClickListener</code> å­—æ®µã€‚</li></ul><hr><h3 id="3-è·å–-mOnClickListener"><a href="#3-è·å–-mOnClickListener" class="headerlink" title="(3) è·å– mOnClickListener"></a><strong>(3) è·å– <code>mOnClickListener</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">mOnClickListenerObject</span> <span class="hljs-operator">=</span> XposedHelpers.getObjectField(listenerInfoObject, <span class="hljs-string">"mOnClickListener"</span>);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-11"><a href="#ğŸ”¹-ä½œç”¨-11" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><strong>ä» <code>mListenerInfo</code> ä¸­è·å– <code>mOnClickListener</code> å­—æ®µ</strong>ï¼Œå³å®é™…å¤„ç†ç‚¹å‡»äº‹ä»¶çš„ <code>OnClickListener</code> å®ä¾‹ã€‚</li><li>è¿™ä¸ª <code>mOnClickListenerObject</code> <strong>å°±æ˜¯ <code>View.setOnClickListener()</code> ç»‘å®šçš„ <code>OnClickListener</code> å®ç°ç±»</strong>ã€‚</li></ul><hr><h3 id="4-æ‰“å°-OnClickListener-çš„å®ç°ç±»"><a href="#4-æ‰“å°-OnClickListener-çš„å®ç°ç±»" class="headerlink" title="(4) æ‰“å° OnClickListener çš„å®ç°ç±»"></a><strong>(4) æ‰“å° <code>OnClickListener</code> çš„å®ç°ç±»</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">callbackType</span> <span class="hljs-operator">=</span> mOnClickListenerObject.getClass().getName();<br>Log.d(<span class="hljs-string">"zj2595"</span>, callbackType);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-12"><a href="#ğŸ”¹-ä½œç”¨-12" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>é€šè¿‡ <code>mOnClickListenerObject.getClass().getName()</code> è·å– <strong><code>OnClickListener</code> çš„çœŸå®ç±»å</strong>ã€‚</p></li><li><p><strong>ç”¨äºåˆ†æ <code>View</code> ç‚¹å‡»äº‹ä»¶çš„å…·ä½“å¤„ç†é€»è¾‘</strong>ï¼Œä¾‹å¦‚ï¼š</p>  <figure class="highlight avrasm"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">D/zj2595: <span class="hljs-keyword">com</span>.example.MainActivity<span class="hljs-number">$1</span><br></code></pre></td></tr></tbody></table></figure><p>  è¿™é‡Œçš„ <code>com.example.MainActivity$1</code> è¡¨ç¤º <code>OnClickListener</code> æ˜¯ <code>MainActivity</code> çš„åŒ¿åå†…éƒ¨ç±»ã€‚</p></li></ul><h3 id="1-Hook-View-performClick-çš„æ„å›¾"><a href="#1-Hook-View-performClick-çš„æ„å›¾" class="headerlink" title="1. Hook&nbsp;View.performClick&nbsp;çš„æ„å›¾"></a><strong>1. Hook&nbsp;<code>View.performClick</code>&nbsp;çš„æ„å›¾</strong></h3><ul><li><strong>ç›‘æ§ç‚¹å‡»äº‹ä»¶</strong>ï¼šæ•è·æ‰€æœ‰Viewçš„ç‚¹å‡»æ“ä½œï¼ˆæŒ‰é’®ã€åˆ—è¡¨é¡¹ç­‰ï¼‰ï¼Œåˆ†æç”¨æˆ·äº¤äº’è¡Œä¸ºã€‚</li><li><strong>å®šä½ç‚¹å‡»å¤„ç†é€»è¾‘</strong>ï¼šé€šè¿‡ç›‘å¬å™¨ç±»å‹è¿½è¸ªåˆ°å…·ä½“å®ç°ç±»ï¼ˆå¦‚Activityã€åŒ¿åå†…éƒ¨ç±»ï¼‰ï¼Œè¾…åŠ©é€†å‘å·¥ç¨‹å¸ˆå¿«é€Ÿå®šä½å…³é”®ä»£ç ã€‚</li></ul><h3 id="2-åå°„è·å–ç§æœ‰å­—æ®µ"><a href="#2-åå°„è·å–ç§æœ‰å­—æ®µ" class="headerlink" title="2. åå°„è·å–ç§æœ‰å­—æ®µ"></a><strong>2. åå°„è·å–ç§æœ‰å­—æ®µ</strong></h3><ul><li><p><strong>å­—æ®µè®¿é—®</strong>ï¼š</p><p>  <code>mListenerInfo</code>&nbsp;å’Œ&nbsp;<code>mOnClickListener</code>&nbsp;å‡ä¸ºViewçš„ç§æœ‰å­—æ®µï¼Œé€šè¿‡&nbsp;<code>XposedHelpers.getObjectField</code>&nbsp;çªç ´è®¿é—®é™åˆ¶ã€‚</p></li><li><p><strong>é€†å‘æ„ä¹‰</strong>ï¼š</p><p>  ç›´æ¥è®¿é—®ç§æœ‰å­—æ®µå¯ç»•è¿‡å¸¸è§„æ–¹æ³•ï¼ˆå¦‚<code>View.getListenerInfo()</code>ï¼‰ï¼Œé¿å…è§¦å‘æ½œåœ¨çš„åè°ƒè¯•æ£€æµ‹ã€‚</p></li></ul><h3 id="3-ç›‘å¬å™¨ç±»å‹åˆ†æ"><a href="#3-ç›‘å¬å™¨ç±»å‹åˆ†æ" class="headerlink" title="3. ç›‘å¬å™¨ç±»å‹åˆ†æ"></a><strong>3. ç›‘å¬å™¨ç±»å‹åˆ†æ</strong></h3><ul><li><strong>å¸¸è§ç±»å‹</strong>ï¼š<ul><li><strong>åŒ¿åå†…éƒ¨ç±»</strong>ï¼š<code>MainActivity$1</code>ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ç±»åï¼‰ã€‚</li><li><strong>Lambdaè¡¨è¾¾å¼</strong>ï¼š<code>$$Lambda$MainActivity$Xo4wq...</code>ï¼ˆProGuardæ··æ·†ååç§°ï¼‰ã€‚</li><li><strong>Activityè‡ªèº«å®ç°</strong>ï¼š<code>com.example.MainActivity</code>ï¼ˆå®ç°&nbsp;<code>View.OnClickListener</code>&nbsp;æ¥å£ï¼‰ã€‚</li></ul></li></ul></li></ul></li></ul><p>æ”¹å†™å¸ƒå±€:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeSixth"</span>, lpparam.classLoader,<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-string">"onCreate"</span>, Bundle.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br>&nbsp; &nbsp; <span class="hljs-meta">@Override</span><br>&nbsp; &nbsp; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">View</span> <span class="hljs-variable">img</span> <span class="hljs-operator">=</span> (View)XposedHelpers.callMethod(param.thisObject,<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-string">"findViewById"</span>, <span class="hljs-number">0x7f0800de</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;img.setVisibility(View.GONE);<br><br>&nbsp; &nbsp; }<br>});<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><ol><li>åœ¨onCreateæ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€äº›å¸ƒå±€çš„ç»‘å®šï¼Œå¦‚buttonæ§ä»¶ç­‰å†…å®¹éƒ½æ˜¯åœ¨onCreateæ–¹æ³•ä¸­å®ä¾‹ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262110935.png"></p><ol><li>ä¼ å…¥æ§ä»¶16è¿›åˆ¶çš„å€¼</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262110214.png"></p><ol><li>æˆ‘ä»¬ä¼šå‘ç°åŸæ¥è¿™éƒ¨åˆ†çš„å›¾ç‰‡å·²ç»è¢«éšè—èµ·æ¥</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262110524.png"></p><ul><li><p>ä»£ç è§£æ</p><h3 id="1-Hook-Activity-onCreateçš„æ„å›¾"><a href="#1-Hook-Activity-onCreateçš„æ„å›¾" class="headerlink" title="1. Hook Activity.onCreateçš„æ„å›¾"></a><strong>1. Hook Activity.onCreateçš„æ„å›¾</strong></h3><ul><li><strong>ç¯¡æ”¹UIåˆå§‹åŒ–</strong>ï¼šåœ¨Activityåˆ›å»ºæ—¶ä¿®æ”¹ç•Œé¢å¸ƒå±€ï¼Œéšè—æˆ–æ›¿æ¢å…³é”®å…ƒç´ ï¼ˆå¦‚éªŒè¯æç¤ºã€å¹¿å‘Šï¼‰ã€‚</li><li><strong>ç»•è¿‡ç•Œé¢é™åˆ¶</strong>ï¼šä¾‹å¦‚éšè—â€œæœªæˆæƒâ€æç¤ºï¼Œç›´æ¥å±•ç¤ºåŠŸèƒ½ç•Œé¢ã€‚</li></ul><h3 id="2-èµ„æºIDçš„é€†å‘å®šä½"><a href="#2-èµ„æºIDçš„é€†å‘å®šä½" class="headerlink" title="2. èµ„æºIDçš„é€†å‘å®šä½"></a><strong>2. èµ„æºIDçš„é€†å‘å®šä½</strong></h3><ul><li><strong>èµ„æºIDæ ¼å¼</strong>ï¼š<code>0x7f0800de</code>&nbsp;è¡¨ç¤ºAPKèµ„æºIDï¼Œé€šå¸¸å¯¹åº”&nbsp;<code>R.id.xxx</code>ã€‚</li><li><strong>é€†å‘å®šä½æ–¹æ³•</strong>ï¼š<ol><li><strong>åç¼–è¯‘å·¥å…·</strong>ï¼šä½¿ç”¨ Jadx/Ghidra æŸ¥æ‰¾&nbsp;<code>R.java</code>&nbsp;æˆ–èµ„æºæ˜ å°„è¡¨ï¼Œå°†IDè½¬æ¢ä¸ºå…·ä½“åç§°ï¼ˆå¦‚&nbsp;<code>R.id.btn_submit</code>ï¼‰ã€‚</li><li><strong>åŠ¨æ€è°ƒè¯•</strong>ï¼šé€šè¿‡Android Studioçš„Layout Inspectorå®æ—¶æŸ¥çœ‹ç•Œé¢å…ƒç´ IDã€‚</li></ol></li></ul><h3 id="3-åŠ¨æ€è°ƒç”¨findViewById"><a href="#3-åŠ¨æ€è°ƒç”¨findViewById" class="headerlink" title="3. åŠ¨æ€è°ƒç”¨findViewById"></a><strong>3. åŠ¨æ€è°ƒç”¨findViewById</strong></h3><ul><li><p><strong>åå°„è°ƒç”¨</strong>ï¼šé€šè¿‡&nbsp;<code>XposedHelpers.callMethod</code>&nbsp;ç›´æ¥è°ƒç”¨Activityçš„&nbsp;<code>findViewById</code>&nbsp;æ–¹æ³•ï¼Œç­‰ä»·äºï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">View</span> <span class="hljs-variable">img</span> <span class="hljs-operator">=</span> ((Activity) param.thisObject).findViewById(<span class="hljs-number">0x7f0800de</span>);<br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>é€†å‘æ„ä¹‰</strong>ï¼šæ— éœ€ä¿®æ”¹APKä»£ç ï¼ŒåŠ¨æ€æ“æ§UIå…ƒç´ ã€‚</p></li></ul><h3 id="1-Hook-onCreate-æ–¹æ³•"><a href="#1-Hook-onCreate-æ–¹æ³•" class="headerlink" title="(1) Hook onCreate() æ–¹æ³•"></a><strong>(1) Hook <code>onCreate()</code> æ–¹æ³•</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">XposedHelpers.findAndHookMethod(<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeSixth"</span>, lpparam.classLoader,<br>&nbsp; &nbsp; <span class="hljs-string">"onCreate"</span>, Bundle.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() {<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-13"><a href="#ğŸ”¹-ä½œç”¨-13" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><strong>ç›®æ ‡ç±»ï¼š</strong> <code>com.zj.wuaipojie.ui.ChallengeSixth</code></li><li><strong>ç›®æ ‡æ–¹æ³•ï¼š</strong> <code>onCreate(Bundle savedInstanceState)</code></li><li><strong>Hook <code>onCreate()</code> çš„åŸå› ï¼š</strong><ul><li><code>onCreate()</code> æ˜¯ <code>Activity</code> ç”Ÿå‘½å‘¨æœŸçš„å…¥å£ï¼Œé€šå¸¸åœ¨è¿™é‡Œè¿›è¡Œ UI åˆå§‹åŒ–ã€‚</li><li><strong>Hook è¯¥æ–¹æ³•å¯ä»¥æ‹¦æˆª UI åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå¹¶ä¿®æ”¹ <code>View</code> çš„å±æ€§</strong>ã€‚</li></ul></li></ul><hr><h3 id="2-è·å–-View"><a href="#2-è·å–-View" class="headerlink" title="(2) è·å– View"></a><strong>(2) è·å– <code>View</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">View</span> <span class="hljs-variable">img</span> <span class="hljs-operator">=</span> (View) XposedHelpers.callMethod(param.thisObject,<br>&nbsp; &nbsp; <span class="hljs-string">"findViewById"</span>, <span class="hljs-number">0x7f0800de</span>);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-14"><a href="#ğŸ”¹-ä½œç”¨-14" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p><strong>é€šè¿‡ <code>findViewById()</code> è·å– ID ä¸º <code>0x7f0800de</code> çš„ <code>View</code> å¯¹è±¡</strong>ã€‚</p></li><li><p><code>param.thisObject</code> ä»£è¡¨ <code>ChallengeSixth</code> å®ä¾‹ï¼Œç›¸å½“äºï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">View</span> <span class="hljs-variable">img</span> <span class="hljs-operator">=</span> ((Activity) param.thisObject).findViewById(<span class="hljs-number">0x7f0800de</span>);<br></code></pre></td></tr></tbody></table></figure></li><li><p><code>0x7f0800de</code> æ˜¯ä¸€ä¸ª <code>View ID</code>ï¼Œå¯ä»¥é€šè¿‡ <code>R.id.xxx</code> è§£æï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">viewId</span> <span class="hljs-operator">=</span> R.id.targetView;  <span class="hljs-comment">// ä¾‹å¦‚ï¼šR.id.imageView</span><br></code></pre></td></tr></tbody></table></figure><p>  åœ¨ Xposed Hook ä»£ç ä¸­é€šå¸¸åªèƒ½ä½¿ç”¨ <code>ID å€¼</code>ï¼ˆ<code>0x7fxxxxxx</code>ï¼‰ï¼Œè€Œä¸èƒ½ç”¨ <code>R.id.xxx</code>ã€‚</p></li></ul><hr><h3 id="3-éšè—-View"><a href="#3-éšè—-View" class="headerlink" title="(3) éšè— View"></a><strong>(3) éšè— <code>View</code></strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">img.setVisibility(View.GONE);<br></code></pre></td></tr></tbody></table></figure><h3 id="ğŸ”¹-ä½œç”¨-15"><a href="#ğŸ”¹-ä½œç”¨-15" class="headerlink" title="ğŸ”¹ ä½œç”¨"></a><strong>ğŸ”¹ ä½œç”¨</strong></h3><ul><li><p>å°†ç›®æ ‡ <code>View</code> <strong>è®¾ç½®ä¸º <code>GONE</code>ï¼ˆå®Œå…¨éšè—ï¼Œä¸å ç©ºé—´ï¼‰</strong>ã€‚</p></li><li><p><code>View</code> çš„å¯è§æ€§çŠ¶æ€ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">View.VISIBLE   <span class="hljs-comment">// å¯è§</span><br>View.INVISIBLE <span class="hljs-comment">// éšè—ä½†ä»å ç©ºé—´</span><br>View.GONE      <span class="hljs-comment">// å®Œå…¨éšè—ï¼Œä¸å ç©ºé—´</span><br></code></pre></td></tr></tbody></table></figure></li><li><p><strong>ç­‰æ•ˆ Java ä»£ç ï¼š</strong></p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ImageView</span> <span class="hljs-variable">img</span> <span class="hljs-operator">=</span> findViewById(R.id.targetView);<br>img.setVisibility(View.GONE);<br></code></pre></td></tr></tbody></table></figure></li></ul></li></ul></li></ul><h2 id="Xposedæ¨¡å—patch"><a href="#Xposedæ¨¡å—patch" class="headerlink" title="Xposedæ¨¡å—patch"></a><strong>Xposedæ¨¡å—patch</strong></h2><p><a href="https://github.com/LSPosed/LSPatch">LSPatch</a></p><p>PS:æœ€ä½æ”¯æŒå®‰å“9</p><ul><li><p>å°†é¡¹ç›®ç¼–è¯‘ä¸ºapkè¿‡ç¨‹ç¤ºä¾‹</p><ol><li>ç‚¹å‡»buildé€‰æ‹©apk</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262110526.png"></p><ol><li>å…ˆæ–°å»ºä¸€ä¸ªç­¾åä¿¡æ¯æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ª.jksæ–‡ä»¶</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262110007.png"></p><ol><li>é…ç½®åè®©åº”ç”¨å¯ä»¥å‘å¸ƒé€‰æ‹©releaseå»ºç«‹</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111278.png"></p><ol><li>å»ºç«‹å¥½åæˆ‘ä»¬å‘ç°ç›®å½•ä¸­å¯ä»¥æŸ¥çœ‹åˆ°releaseæ–‡ä»¶å’Œç”Ÿæˆçš„apk</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111409.png"></p><ol><li>æˆ‘ä»¬åœ¨è·¯å¾„ä¸‹æ‰¾åˆ°æˆ‘ä»¬æ–°ç”Ÿæˆçš„apk</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111522.png"></p><ol><li>åœ¨LSPatchä¸­é€‰æ‹©æˆ‘ä»¬æ•™ç¨‹Demoè¿›è¡Œä¿®è¡¥</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111688.png"></p><ol><li>æˆ‘ä»¬ä½¿ç”¨ä¾¿æºæ¨¡å¼åµŒå…¥æ¨¡å—ï¼ˆåœ¨æ²¡æœ‰rootçš„æ‰‹æœºä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼‰</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111531.png"></p><ol><li>ä¿®è¡¥åå› ä¸ºæš‚æ—¶ç¼ºå°‘æ¨¡å—æˆ‘ä»¬æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹è¯¥æ¨¡å—</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111017.png"></p><ol><li>æˆ‘ä»¬å‘ç°å›¾æ ‡æ¶ˆå¤±ï¼Œè¯´æ˜å®ƒåœ¨è¿è¡Œæ—¶å·²ç»åŠ è½½äº†ç›¸å…³æ¨¡å—</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262111492.png"></p></li></ul><h3 id="Xposedå¿«é€ŸHook"><a href="#Xposedå¿«é€ŸHook" class="headerlink" title="Xposedå¿«é€ŸHook"></a><strong>Xposedå¿«é€ŸHook</strong></h3><p><a href="https://github.com/littleWhiteDuck/SimpleHook">SimpleHook</a></p><ul><li><p>ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹</p><ol><li>å®‰è£…å¥½<a href="https://github.com/littleWhiteDuck/SimpleHook%E5%AF%B9%E6%83%B3%E8%A6%81%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%9A%84%E7%9B%AE%E6%A0%87%E8%BF%9B%E8%A1%8C%E5%8B%BE%E9%80%89%E8%AE%BE%E7%BD%AE">https://github.com/littleWhiteDuck/SimpleHookå¯¹æƒ³è¦è¿›è¡Œæ“ä½œçš„ç›®æ ‡è¿›è¡Œå‹¾é€‰è®¾ç½®</a></li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262112026.png"></p><ol><li>åœ¨è®¾ç½®ä¸­å°†smailè½¬åŒ–ä¸ºé…ç½®æ‰“å¼€ï¼Œç„¶åå›åˆ°é¦–é¡µè¿›è¡Œæ·»åŠ é…ç½®ã€‚åœ¨MTç®¡ç†å™¨ä¸­æ‰¾åˆ°æ–¹æ³•ç­¾åè¿›è¡Œå¤åˆ¶ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262112037.png"></p><ol><li>smailè‡ªåŠ¨å¡«å……ä¹‹åï¼Œæˆ‘ä»¬è¿›è¡Œå‚è¿”å®è·µã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262112296.png"></p><ol><li>ä¿å­˜åŒæ„rootæƒé™åï¼Œå°†é…ç½®æ‰“å¼€ï¼Œæˆ‘ä»¬æ‰“å¼€apkåå¯ä»¥åœ¨è®°å½•å¤„å¾—åˆ°å‚è¿”ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262112559.png"></p><ol><li>åŒç†æˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡ŒHookå‚æ•°å€¼å¹¶è¿›è¡Œä¿®æ”¹ç­‰æ“ä½œã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262113404.png">  </p></li><li><p>Hookå˜é‡ç¤ºä¾‹</p><ol><li>Hookå®ä¾‹å˜é‡ï¼ŒåŒä¸Šå…ˆå¤åˆ¶ç­¾åè¿›è¡Œç›¸å…³é…ç½®</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503262113351.png"></p><ol><li>å¯ä»¥å‘ç°æ²¡æœ‰ä¿®æ”¹å‰æ˜¯300</li></ol></li></ul><p><a href="https://github.com/Xposed-Modules-Repo/me.jsonet.jshook">jshook</a></p><h3 id="Xpsoedæºç "><a href="#Xpsoedæºç " class="headerlink" title="Xpsoedæºç "></a><strong>Xpsoedæºç </strong></h3><p><a href="https://www.52pojie.cn/thread-1149210-1-1.html">XPOSEDé­”æ”¹ä¸€ï¼šè·å–ç‰¹å¾</a></p><p><a href="https://www.52pojie.cn/thread-1694093-1-1.html">Lsposed æŠ€æœ¯åŸç†æ¢è®¨ &amp;&amp; åŸºæœ¬å®‰è£…ä½¿ç”¨</a></p><p><a href="https://bbs.kanxue.com/thread-269616.htm#msg_header_h2_0">[åŸåˆ›]æºç ç¼–è¯‘ï¼ˆ2ï¼‰â€”â€”Xopsedæºç ç¼–è¯‘è¯¦è§£</a></p>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Xposd</tag>
      
      <tag>API</tag>
      
      <tag>Frida</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç­¾åæ ¡éªŒ</title>
    <link href="/2025/03/23/ZJ6/%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%201b2a6f4b4daf80b3891ddef3c55cac14/"/>
    <url>/2025/03/23/ZJ6/%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%201b2a6f4b4daf80b3891ddef3c55cac14/</url>
    
    <content type="html"><![CDATA[<h1 id="ç­¾åæ ¡éªŒ"><a href="#ç­¾åæ ¡éªŒ" class="headerlink" title="ç­¾åæ ¡éªŒ"></a>ç­¾åæ ¡éªŒ</h1><p><a href="https://www.52pojie.cn/home.php?mod=space&amp;uid=874154&amp;do=thread&amp;view=me&amp;from=space">èŠ½è¡£çš„å¸–å­ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><h2 id="1-ä»€ä¹ˆæ˜¯æ ¡éªŒ"><a href="#1-ä»€ä¹ˆæ˜¯æ ¡éªŒ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯æ ¡éªŒ"></a><strong>1.ä»€ä¹ˆæ˜¯æ ¡éªŒ</strong></h2><p>åœ¨å®‰å“é€†å‘ä¸­ï¼Œ<strong>æ ¡éªŒ</strong>é€šå¸¸æŒ‡å¼€å‘è€…é€šè¿‡ä»£ç é€»è¾‘å¯¹åº”ç”¨çš„å…³é”®ä¿¡æ¯ï¼ˆå¦‚ç­¾åã€æ–‡ä»¶å®Œæ•´æ€§ã€è¿è¡Œç¯å¢ƒç­‰ï¼‰è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿åº”ç”¨æœªè¢«ç¯¡æ”¹æˆ–ç ´è§£ã€‚</p><ul><li>å¸¸è§çš„æ ¡éªŒæœ‰<ol><li><p><strong>ç­¾åæ ¡éªŒï¼ˆSignature Checkï¼‰</strong></p><ul><li><p><strong>ç›®çš„</strong>ï¼šéªŒè¯APKçš„ç­¾åæ˜¯å¦ä¸å¼€å‘è€…é¢„æœŸä¸€è‡´ï¼Œé˜²æ­¢åº”ç”¨è¢«é‡æ–°æ‰“åŒ…æˆ–ç¯¡æ”¹ã€‚</p></li><li><p><strong>å®ç°æ–¹å¼</strong>ï¼š</p><ul><li>ä»£ç ä¸­é€šè¿‡<code>PackageManager</code>è·å–ç­¾åä¿¡æ¯ï¼Œä¸é¢„è®¾çš„ç­¾åå“ˆå¸Œå€¼å¯¹æ¯”ã€‚</li><li>è‹¥ç­¾åä¸åŒ¹é…ï¼Œè§¦å‘é€€å‡ºæˆ–é™åˆ¶åŠŸèƒ½ï¼ˆå¦‚ä»˜è´¹éªŒè¯å¤±æ•ˆï¼‰ã€‚</li></ul></li><li><p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è·å–å½“å‰APKçš„ç­¾åä¿¡æ¯</span><br>Signature[] signatures = getPackageManager().getPackageInfo(getPackageName(), PackageManager.GET_SIGNATURES).signatures;<br><span class="hljs-type">String</span> <span class="hljs-variable">currentSignature</span> <span class="hljs-operator">=</span> signatures[<span class="hljs-number">0</span>].toCharsString();<br><span class="hljs-comment">// å¯¹æ¯”é¢„è®¾çš„åˆæ³•ç­¾å</span><br><span class="hljs-keyword">if</span> (!currentSignature.equals(<span class="hljs-string">"é¢„è®¾çš„ç­¾åå“ˆå¸Œå€¼"</span>)) {<br>    exit();<br>}<br></code></pre></td></tr></tbody></table></figure></li></ul></li><li><p><strong>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒ</strong></p><ul><li><strong>ç›®çš„</strong>ï¼šéªŒè¯APKæˆ–èµ„æºæ–‡ä»¶ï¼ˆå¦‚DEXã€SOåº“ï¼‰æ˜¯å¦è¢«ä¿®æ”¹ã€‚</li><li><strong>å®ç°æ–¹å¼</strong>ï¼š<ul><li>è®¡ç®—æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼ˆå¦‚MD5ã€SHA-1ï¼‰å¹¶ä¸é¢„è®¾å€¼å¯¹æ¯”ã€‚</li><li>æ£€æµ‹å…³é”®æ–‡ä»¶çš„å¤§å°æˆ–ä¿®æ”¹æ—¶é—´æ˜¯å¦å¼‚å¸¸ã€‚</li></ul></li></ul></li><li><p><strong>ç¯å¢ƒæ ¡éªŒ</strong></p><ul><li><strong>ç›®çš„</strong>ï¼šæ£€æµ‹æ˜¯å¦è¿è¡Œåœ¨æ¨¡æ‹Ÿå™¨ã€Rootç¯å¢ƒæˆ–è°ƒè¯•æ¨¡å¼ã€‚</li><li><strong>å®ç°æ–¹å¼</strong>ï¼š<ul><li>æ£€æŸ¥ç³»ç»Ÿå±æ€§ï¼ˆå¦‚<code>ro.build.tags</code>æ˜¯å¦åŒ…å«<code>test-keys</code>ï¼‰ã€‚</li><li>æ£€æµ‹<code>su</code>æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆRootç¯å¢ƒï¼‰ã€‚</li><li>ä½¿ç”¨<code>android.os.Debug.isDebuggerConnected()</code>æ£€æµ‹è°ƒè¯•çŠ¶æ€ã€‚</li></ul></li></ul></li><li><p><strong>é€»è¾‘æ ¡éªŒ</strong></p><ul><li><strong>ç›®çš„</strong>ï¼šéªŒè¯å…³é”®ä¸šåŠ¡é€»è¾‘æ˜¯å¦è¢«ç¯¡æ”¹ï¼ˆå¦‚ä»˜è´¹éªŒè¯ã€åŠ å¯†ç®—æ³•ï¼‰ã€‚</li><li><strong>å®ç°æ–¹å¼</strong>ï¼š<ul><li>æ ¡éªŒå…³é”®å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li><li>ä½¿ç”¨ä»£ç æ··æ·†æˆ–Nativeä»£ç ï¼ˆC/C++ï¼‰éšè—æ ¡éªŒé€»è¾‘ã€‚</li></ul></li></ul></li><li><p><strong>JNI/Native å±‚æ ¡éªŒ</strong></p></li></ol><ul><li>è®¸å¤šåº”ç”¨ä¼šåœ¨ C/C++ å±‚è¿›è¡Œå®Œæ•´æ€§æ£€æŸ¥ï¼Œæ£€æµ‹ <code>lib.so</code> æ˜¯å¦è¢«ä¿®æ”¹ï¼Œæˆ–è€…æ£€æŸ¥ Java æ–¹æ³•çš„è¡Œä¸ºæ˜¯å¦è¢« Hookã€‚</li><li>ä¾‹å¦‚ï¼ŒæŸäº›åè°ƒè¯•æŠ€æœ¯ä¼šåœ¨ <code>lib.so</code> ä¸­å®ç° <code>ptrace</code> æ£€æµ‹æˆ– <code>frida</code> æ£€æµ‹ã€‚</li></ul></li></ul><p>ç­¾åæ ¡éªŒ(æœ€å¸¸è§)ã€dexcrcæ ¡éªŒã€apkå®Œæ•´æ€§æ ¡éªŒã€è·¯å¾„æ–‡ä»¶æ ¡éªŒç­‰</p><h2 id="2-ä»€ä¹ˆæ˜¯APKç­¾å"><a href="#2-ä»€ä¹ˆæ˜¯APKç­¾å" class="headerlink" title="2.ä»€ä¹ˆæ˜¯APKç­¾å"></a><strong>2.ä»€ä¹ˆæ˜¯APKç­¾å</strong></h2><p>APKç­¾åæ˜¯Androidç³»ç»Ÿçš„å®‰å…¨æœºåˆ¶ï¼Œç”¨äºéªŒè¯åº”ç”¨æ¥æºå’Œå®Œæ•´æ€§ã€‚</p><p>é€šè¿‡å¯¹ Apk è¿›è¡Œç­¾åï¼Œå¼€å‘è€…å¯ä»¥è¯æ˜å¯¹ Apk çš„æ‰€æœ‰æƒå’Œæ§åˆ¶æƒï¼Œå¯ç”¨äºå®‰è£…å’Œæ›´æ–°å…¶åº”ç”¨ã€‚è€Œåœ¨ Android è®¾å¤‡ä¸Šçš„å®‰è£… Apk ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ²¡æœ‰è¢«ç­¾åçš„ Apkï¼Œåˆ™ä¼šè¢«æ‹’ç»å®‰è£…ã€‚åœ¨å®‰è£… Apk çš„æ—¶å€™ï¼Œè½¯ä»¶åŒ…ç®¡ç†å™¨ä¹Ÿä¼šéªŒè¯ Apk æ˜¯å¦å·²ç»è¢«æ­£ç¡®ç­¾åï¼Œå¹¶ä¸”é€šè¿‡ç­¾åè¯ä¹¦å’Œæ•°æ®æ‘˜è¦éªŒè¯æ˜¯å¦åˆæ³•æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚åªæœ‰ç¡®è®¤å®‰å…¨æ— ç¯¡æ”¹çš„æƒ…å†µä¸‹ï¼Œæ‰å…è®¸å®‰è£…åœ¨è®¾å¤‡ä¸Šã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒAPK çš„ç­¾åä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªï¼š </p><ol><li>è¯æ˜ APK çš„æ‰€æœ‰è€…ã€‚</li><li>å…è®¸ Android å¸‚åœºå’Œè®¾å¤‡æ ¡éªŒ APK çš„æ­£ç¡®æ€§ã€‚</li></ol><h3 id="ï¼ˆ1ï¼‰ç­¾åæœºåˆ¶"><a href="#ï¼ˆ1ï¼‰ç­¾åæœºåˆ¶" class="headerlink" title="ï¼ˆ1ï¼‰ç­¾åæœºåˆ¶"></a><strong>ï¼ˆ1ï¼‰ç­¾åæœºåˆ¶</strong></h3><p>æ¯ä¸ªå®‰å“åº”ç”¨åœ¨æ‰“åŒ…æ—¶éƒ½ä¼šä½¿ç”¨å¼€å‘è€…çš„ç§é’¥è¿›è¡Œç­¾åï¼Œç­¾åä¿¡æ¯å­˜å‚¨åœ¨ <code>META-INF</code> ç›®å½•ä¸‹ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><code>CERT.RSA</code>ï¼ˆå…¬é’¥è¯ä¹¦ï¼‰</li><li><code>CERT.SF</code>ï¼ˆæ‘˜è¦ä¿¡æ¯ï¼‰</li><li><code>MANIFEST.MF</code>ï¼ˆæ–‡ä»¶å“ˆå¸Œå€¼ï¼‰</li></ul><p>å½“ç”¨æˆ·å®‰è£… APK æ—¶ï¼ŒAndroid ç³»ç»Ÿä¼šï¼š</p><ol><li>ä½¿ç”¨ <code>CERT.RSA</code> å†…çš„å…¬é’¥éªŒè¯ <code>CERT.SF</code> çš„çœŸå®æ€§ã€‚</li><li>é€šè¿‡ <code>CERT.SF</code> çš„å“ˆå¸Œå€¼æ£€æŸ¥ <code>MANIFEST.MF</code>ï¼Œç¡®è®¤æ–‡ä»¶æœªè¢«ä¿®æ”¹ã€‚</li><li>é€šè¿‡ <code>MANIFEST.MF</code> ä¸­è®°å½•çš„å“ˆå¸Œå€¼ï¼Œæ ¡éªŒ APK å†…æ‰€æœ‰æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹ã€‚</li></ol><p>å¦‚æœç­¾åæ ¡éªŒå¤±è´¥ï¼ŒAPK å°†æ— æ³•å®‰è£…ã€‚</p><h3 id="ï¼ˆ2ï¼‰-Android-ç›®å‰æ”¯æŒä»¥ä¸‹å››ç§åº”ç”¨ç­¾åæ–¹æ¡ˆï¼š"><a href="#ï¼ˆ2ï¼‰-Android-ç›®å‰æ”¯æŒä»¥ä¸‹å››ç§åº”ç”¨ç­¾åæ–¹æ¡ˆï¼š" class="headerlink" title="**ï¼ˆ2ï¼‰**Android ç›®å‰æ”¯æŒä»¥ä¸‹å››ç§åº”ç”¨ç­¾åæ–¹æ¡ˆï¼š"></a>**ï¼ˆ2ï¼‰**Android ç›®å‰æ”¯æŒä»¥ä¸‹å››ç§åº”ç”¨ç­¾åæ–¹æ¡ˆï¼š</h3><ul><li><p><strong>V1 ç­¾åï¼ˆJAR ç­¾åï¼ŒAndroid 1.6+ï¼‰</strong></p><ul><li><p>åªæ ¡éªŒ <code>META-INF</code> ç›®å½•ä¸‹çš„ç­¾åæ–‡ä»¶ï¼Œå¯¹ <code>APK</code> æœ¬èº«çš„å®Œæ•´æ€§ä¿æŠ¤è¾ƒå¼±ï¼Œå¯é€šè¿‡ Zip æ–¹å¼ä¿®æ”¹ <code>APK</code> è€Œä¸å½±å“ç­¾åã€‚</p></li><li><p>V1 ç­¾åçš„æœºåˆ¶ä¸»è¦å°±åœ¨ META-INF ç›®å½•ä¸‹çš„ä¸‰ä¸ªæ–‡ä»¶ï¼ŒMANIFEST.MFï¼ŒANDROID.SFï¼ŒANDROID.RSAï¼Œä»–ä»¬éƒ½æ˜¯ V1 ç­¾åçš„äº§ç‰©ã€‚</p><p>  ï¼ˆ1ï¼‰MANIFEST.MFï¼šè¿™æ˜¯æ‘˜è¦æ–‡ä»¶ã€‚ç¨‹åºéå†ApkåŒ…ä¸­çš„æ‰€æœ‰æ–‡ä»¶(entry)ï¼Œå¯¹éæ–‡ä»¶å¤¹éç­¾åæ–‡ä»¶çš„æ–‡ä»¶ï¼Œé€ä¸ªç”¨SHA1(å®‰å…¨å“ˆå¸Œç®—æ³•)ç”Ÿæˆæ‘˜è¦ä¿¡æ¯ï¼Œå†ç”¨Base64è¿›è¡Œç¼–ç ã€‚å¦‚æœä½ æ”¹å˜äº†apkåŒ…ä¸­çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨apkå®‰è£…æ ¡éªŒæ—¶ï¼Œæ”¹å˜åçš„æ–‡ä»¶æ‘˜è¦ä¿¡æ¯ä¸MANIFEST.MFçš„æ£€éªŒä¿¡æ¯ä¸åŒï¼Œäºæ˜¯ç¨‹åºå°±ä¸èƒ½æˆåŠŸå®‰è£…ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232134148.png"></p><p>  ï¼ˆ2ï¼‰ANDROID.SFï¼šè¿™æ˜¯å¯¹æ‘˜è¦çš„ç­¾åæ–‡ä»¶ã€‚å¯¹å‰ä¸€æ­¥ç”Ÿæˆçš„MANIFEST.MFï¼Œä½¿ç”¨SHA1-RSAç®—æ³•ï¼Œç”¨å¼€å‘è€…çš„ç§é’¥è¿›è¡Œç­¾åã€‚åœ¨å®‰è£…æ—¶åªèƒ½ä½¿ç”¨å…¬é’¥æ‰èƒ½è§£å¯†å®ƒã€‚è§£å¯†ä¹‹åï¼Œå°†å®ƒä¸æœªåŠ å¯†çš„æ‘˜è¦ä¿¡æ¯ï¼ˆå³ï¼ŒMANIFEST.MFæ–‡ä»¶ï¼‰è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç›¸ç¬¦ï¼Œåˆ™è¡¨æ˜å†…å®¹æ²¡æœ‰è¢«å¼‚å¸¸ä¿®æ”¹ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232134186.png"></p><p>  ï¼ˆ3ï¼‰ANDROID.RSAæ–‡ä»¶ä¸­ä¿å­˜äº†å…¬é’¥ã€æ‰€é‡‡ç”¨çš„åŠ å¯†ç®—æ³•ç­‰ä¿¡æ¯ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232135216.png"></p></li></ul></li><li><p><strong>V2 ç­¾åï¼ˆAPK Signature Scheme v2ï¼ŒAndroid 7.0+ï¼‰</strong></p><ul><li>ç›´æ¥å¯¹æ•´ä¸ª APK æ–‡ä»¶è¿›è¡Œç­¾åï¼Œæé«˜äº†å®‰å…¨æ€§ï¼Œé˜²æ­¢å¯¹ APK è¿›è¡Œ Zip ä¿®æ”¹åä»èƒ½é€šè¿‡ç­¾åæ ¡éªŒã€‚</li><li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›´æ¥å¯¹apkè¿›è¡Œv1ç­¾åå¯ä»¥ç»•è¿‡apkçš„ç­¾åæ ¡éªŒ</li></ul><p>  v2æ–¹æ¡ˆä¼šå°† APK æ–‡ä»¶è§†ä¸º blobï¼Œå¹¶å¯¹æ•´ä¸ªæ–‡ä»¶è¿›è¡Œç­¾åæ£€æŸ¥ã€‚å¯¹ APK è¿›è¡Œçš„ä»»ä½•ä¿®æ”¹ï¼ˆåŒ…æ‹¬å¯¹ ZIP å…ƒæ•°æ®è¿›è¡Œçš„ä¿®æ”¹ï¼‰éƒ½ä¼šä½¿ APK ç­¾åä½œåºŸã€‚è¿™ç§å½¢å¼çš„ APK éªŒè¯ä¸ä»…é€Ÿåº¦è¦å¿«å¾—å¤šï¼Œè€Œä¸”èƒ½å¤Ÿå‘ç°æ›´å¤šç§æœªç»æˆæƒçš„ä¿®æ”¹ã€‚  </p></li><li><p><strong>V3 ç­¾åï¼ˆAPK Signature Scheme v3ï¼ŒAndroid 9.0+ï¼‰</strong></p><ul><li>å¢åŠ äº†å¯¹ Key Rotationï¼ˆå¯†é’¥è½®æ¢ï¼‰çš„æ”¯æŒï¼Œå…è®¸å¼€å‘è€…æ›´æ¢ç§é’¥åä»èƒ½ä¿æŒåº”ç”¨æ›´æ–°ã€‚</li></ul></li><li><p><strong>V4 ç­¾åï¼ˆAPK Signature Scheme v4ï¼ŒAndroid 11+ï¼‰</strong></p><ul><li>ç”¨äºåŠ é€Ÿ APK å®‰è£…ï¼Œä½†ä¸ä¼šå½±å“å®Œæ•´æ€§æ ¡éªŒã€‚</li></ul></li></ul><h2 id="3-ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒ"><a href="#3-ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒ" class="headerlink" title="3.ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒ"></a><strong>3.ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒ</strong></h2><ul><li><p>åŸºæœ¬æ¦‚å¿µ</p><h3 id="1-ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒï¼Ÿ"></a><strong>1. ä»€ä¹ˆæ˜¯ç­¾åæ ¡éªŒï¼Ÿ</strong></h3><p>  ç­¾åæ ¡éªŒæ˜¯ Android åº”ç”¨å¸¸è§çš„å®‰å…¨æœºåˆ¶ï¼Œ<strong>ç”¨äºæ£€æµ‹åº”ç”¨æ˜¯å¦è¢«ç¯¡æ”¹æˆ–é‡æ–°ç­¾å</strong>ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯é˜²æ­¢äºŒæ¬¡æ‰“åŒ…å’Œæ¶æ„ç¯¡æ”¹ã€‚</p><p>  å½“å¼€å‘è€…ç¼–è¯‘å’Œæ‰“åŒ… APK æ—¶ï¼ŒAPK ä¼šä½¿ç”¨å¼€å‘è€…çš„ç§é’¥è¿›è¡Œç­¾åã€‚Android ç³»ç»Ÿåœ¨å®‰è£…åº”ç”¨æ—¶ä¼šéªŒè¯ç­¾åï¼Œå¦‚æœ APK è¢«ç¯¡æ”¹ï¼Œç­¾åå°±ä¼šå¤±æ•ˆï¼Œå¯¼è‡´æ— æ³•å®‰è£…ã€‚</p><p>  ä½†åœ¨ <strong>é€†å‘åˆ†æ</strong> ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹ APK å¹¶é‡æ–°ç­¾åï¼Œå› æ­¤åº”ç”¨é€šå¸¸ä¼šåœ¨è¿è¡Œæ—¶ <strong>è‡ªæ£€ç­¾å</strong>ï¼Œå¦‚æœç­¾åä¸åŒ¹é…ï¼Œåº”ç”¨å¯èƒ½ä¼šç»ˆæ­¢è¿è¡Œæˆ–æ‰§è¡Œåè°ƒè¯•é€»è¾‘ã€‚</p><hr><h3 id="2-ç­¾åæ ¡éªŒçš„å·¥ä½œåŸç†"><a href="#2-ç­¾åæ ¡éªŒçš„å·¥ä½œåŸç†" class="headerlink" title="2. ç­¾åæ ¡éªŒçš„å·¥ä½œåŸç†"></a><strong>2. ç­¾åæ ¡éªŒçš„å·¥ä½œåŸç†</strong></h3><p>  ç­¾åæ ¡éªŒé€šå¸¸åˆ†ä¸º <strong>ç³»ç»Ÿçº§æ ¡éªŒ</strong> å’Œ <strong>åº”ç”¨è‡ªæ ¡éªŒ</strong>ï¼š</p><h3 id="ï¼ˆ1ï¼‰ç³»ç»Ÿçº§ç­¾åæ ¡éªŒ"><a href="#ï¼ˆ1ï¼‰ç³»ç»Ÿçº§ç­¾åæ ¡éªŒ" class="headerlink" title="ï¼ˆ1ï¼‰ç³»ç»Ÿçº§ç­¾åæ ¡éªŒ"></a><strong>ï¼ˆ1ï¼‰ç³»ç»Ÿçº§ç­¾åæ ¡éªŒ</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šå½“ç”¨æˆ·å®‰è£… APK æ—¶ï¼ŒAndroid ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æŸ¥ APK çš„ç­¾åã€‚</li><li><strong>æµç¨‹</strong>ï¼š<ol><li>æå– APK çš„ <code>CERT.RSA</code> è¯ä¹¦ã€‚</li><li>ä½¿ç”¨è¯¥è¯ä¹¦çš„å…¬é’¥éªŒè¯ <code>CERT.SF</code> å’Œ <code>MANIFEST.MF</code> æ–‡ä»¶ï¼Œç¡®ä¿ APK æœªè¢«ç¯¡æ”¹ã€‚</li><li>å¦‚æœ APK ç­¾åæ— æ•ˆï¼ˆå¦‚ç¯¡æ”¹äº† <code>classes.dex</code> æˆ– <code>AndroidManifest.xml</code>ï¼‰ï¼Œåˆ™å®‰è£…å¤±è´¥ã€‚</li></ol></li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>ç”± Android ç³»ç»Ÿæ‰§è¡Œï¼Œä¸å¯ç»•è¿‡ã€‚</li><li>åªæœ‰ç›¸åŒç­¾åçš„åº”ç”¨æ‰èƒ½ç›¸äº’æ›´æ–°ï¼ˆåº”ç”¨å‡çº§å¿…é¡»ä½¿ç”¨ç›¸åŒçš„å¼€å‘è€…ç­¾åï¼‰ã€‚</li></ul></li></ul><h3 id="ï¼ˆ2ï¼‰åº”ç”¨è‡ªæ ¡éªŒï¼ˆè¿è¡Œæ—¶ç­¾åæ ¡éªŒï¼‰"><a href="#ï¼ˆ2ï¼‰åº”ç”¨è‡ªæ ¡éªŒï¼ˆè¿è¡Œæ—¶ç­¾åæ ¡éªŒï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰åº”ç”¨è‡ªæ ¡éªŒï¼ˆè¿è¡Œæ—¶ç­¾åæ ¡éªŒï¼‰"></a><strong>ï¼ˆ2ï¼‰åº”ç”¨è‡ªæ ¡éªŒï¼ˆè¿è¡Œæ—¶ç­¾åæ ¡éªŒï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šåœ¨åº”ç”¨è¿è¡Œæ—¶æ£€æŸ¥è‡ªèº«ç­¾åï¼Œé˜²æ­¢è¢«äºŒæ¬¡æ‰“åŒ…æˆ–ç¯¡æ”¹åè¿è¡Œã€‚</li><li><strong>å®ç°æ–¹å¼</strong>ï¼š<ul><li>è·å–åº”ç”¨çš„ç­¾åä¿¡æ¯ï¼Œå¹¶ä¸é¢„å­˜çš„åˆæ³•ç­¾åè¿›è¡Œæ¯”å¯¹ã€‚</li><li>å¦‚æœç­¾åä¸åŒ¹é…ï¼Œåˆ™ç»ˆæ­¢åº”ç”¨è¿è¡Œæˆ–æ‰§è¡Œåè°ƒè¯•é€»è¾‘ã€‚</li></ul></li></ul><hr><h3 id="3-ç­¾åæ ¡éªŒçš„å®ç°æ–¹å¼"><a href="#3-ç­¾åæ ¡éªŒçš„å®ç°æ–¹å¼" class="headerlink" title="3. ç­¾åæ ¡éªŒçš„å®ç°æ–¹å¼"></a><strong>3. ç­¾åæ ¡éªŒçš„å®ç°æ–¹å¼</strong></h3><p>  åœ¨ Android ä»£ç ä¸­ï¼Œç­¾åæ ¡éªŒé€šå¸¸é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š</p><h3 id="ï¼ˆ1ï¼‰è·å–ç­¾åï¼ˆå…¼å®¹-Android-7-0-ï¼‰"><a href="#ï¼ˆ1ï¼‰è·å–ç­¾åï¼ˆå…¼å®¹-Android-7-0-ï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰è·å–ç­¾åï¼ˆå…¼å®¹ Android 7.0+ï¼‰"></a><strong>ï¼ˆ1ï¼‰è·å–ç­¾åï¼ˆå…¼å®¹ Android 7.0+ï¼‰</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java">java<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-keyword">import</span> android.content.pm.PackageInfo;<br><span class="hljs-keyword">import</span> android.content.pm.PackageManager;<br><span class="hljs-keyword">import</span> android.content.pm.Signature;<br><span class="hljs-keyword">import</span> java.security.MessageDigest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getSignature</span><span class="hljs-params">(Context context)</span> {<br>    <span class="hljs-keyword">try</span> {<br>        <span class="hljs-type">PackageManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> context.getPackageManager();<br>        <span class="hljs-type">PackageInfo</span> <span class="hljs-variable">packageInfo</span> <span class="hljs-operator">=</span> pm.getPackageInfo(context.getPackageName(), PackageManager.GET_SIGNING_CERTIFICATES);<br>        Signature[] signatures = packageInfo.signingInfo.getApkContentsSigners();<br><br>        <span class="hljs-type">MessageDigest</span> <span class="hljs-variable">md</span> <span class="hljs-operator">=</span> MessageDigest.getInstance(<span class="hljs-string">"SHA-256"</span>);<br>        md.update(signatures[<span class="hljs-number">0</span>].toByteArray());<br>        <span class="hljs-keyword">return</span> bytesToHex(md.digest()); <span class="hljs-comment">// è®¡ç®—ç­¾åå“ˆå¸Œå€¼</span><br>    } <span class="hljs-keyword">catch</span> (Exception e) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    }<br>}<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">bytesToHex</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] bytes)</span> {<br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">hexString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">byte</span> b : bytes) {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">hex</span> <span class="hljs-operator">=</span> Integer.toHexString(<span class="hljs-number">0xff</span> &amp; b);<br>        <span class="hljs-keyword">if</span> (hex.length() == <span class="hljs-number">1</span>) {<br>            hexString.append(<span class="hljs-string">'0'</span>);<br>        }<br>        hexString.append(hex);<br>    }<br>    <span class="hljs-keyword">return</span> hexString.toString();<br>}<br><br></code></pre></td></tr></tbody></table></figure><ul><li>è¯¥ä»£ç è®¡ç®—åº”ç”¨çš„ SHA-256 ç­¾åå“ˆå¸Œå€¼ï¼Œå¹¶ä¸é¢„å­˜çš„å€¼æ¯”å¯¹ï¼Œé˜²æ­¢ç¯¡æ”¹ã€‚</li></ul><h3 id="ï¼ˆ2ï¼‰æ¯”å¯¹ç­¾å"><a href="#ï¼ˆ2ï¼‰æ¯”å¯¹ç­¾å" class="headerlink" title="ï¼ˆ2ï¼‰æ¯”å¯¹ç­¾å"></a><strong>ï¼ˆ2ï¼‰æ¯”å¯¹ç­¾å</strong></h3>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">java<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-type">String</span> <span class="hljs-variable">expectedSignature</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ABC123DEF456..."</span>; <span class="hljs-comment">// é¢„å­˜çš„ç­¾åå“ˆå¸Œ</span><br><span class="hljs-type">String</span> <span class="hljs-variable">currentSignature</span> <span class="hljs-operator">=</span> getSignature(context);<br><span class="hljs-keyword">if</span> (!expectedSignature.equals(currentSignature)) {<br>    System.exit(<span class="hljs-number">0</span>); <span class="hljs-comment">// ç­¾åä¸åŒ¹é…ï¼Œé€€å‡ºåº”ç”¨</span><br>}<br><br></code></pre></td></tr></tbody></table></figure><hr><h3 id="4-ç­¾åæ ¡éªŒçš„å¸¸è§ç»•è¿‡æ–¹æ³•"><a href="#4-ç­¾åæ ¡éªŒçš„å¸¸è§ç»•è¿‡æ–¹æ³•" class="headerlink" title="4. ç­¾åæ ¡éªŒçš„å¸¸è§ç»•è¿‡æ–¹æ³•"></a><strong>4. ç­¾åæ ¡éªŒçš„å¸¸è§ç»•è¿‡æ–¹æ³•</strong></h3><p>  åœ¨é€†å‘å·¥ç¨‹ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä¿®æ”¹ APK å¹¶é‡æ–°ç­¾åï¼Œä½¿å…¶èƒ½å¤Ÿå®‰è£…å¹¶è¿è¡Œã€‚ä½†å¦‚æœåº”ç”¨è¿›è¡Œäº†è¿è¡Œæ—¶ç­¾åæ ¡éªŒï¼Œåˆ™éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ç»•è¿‡ï¼š</p><h3 id="ï¼ˆ1ï¼‰Hook-ç»•è¿‡"><a href="#ï¼ˆ1ï¼‰Hook-ç»•è¿‡" class="headerlink" title="ï¼ˆ1ï¼‰Hook ç»•è¿‡"></a><strong>ï¼ˆ1ï¼‰Hook ç»•è¿‡</strong></h3><p>  ä½¿ç”¨ Frida/Xposed Hook <code>getPackageInfo()</code> æ–¹æ³•ï¼Œä¼ªé€ ç­¾åè¿”å›å€¼ï¼š</p>  <figure class="highlight jsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs jsx">javascript<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {<br>    <span class="hljs-keyword">var</span> pm = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"android.app.ApplicationPackageManager"</span>);<br>    pm.<span class="hljs-property">getPackageInfo</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">"java.lang.String"</span>, <span class="hljs-string">"int"</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">pkg, flags</span>) {<br>        <span class="hljs-keyword">var</span> info = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPackageInfo</span>(pkg, flags);<br>        <span class="hljs-keyword">var</span> fakeSignature = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"android.content.pm.Signature"</span>).$new(<span class="hljs-string">"ABC123DEF456..."</span>); <span class="hljs-comment">// ä¼ªé€ ç­¾å</span><br>        info.<span class="hljs-property">signatures</span>.<span class="hljs-property">value</span> = [fakeSignature];<br>        <span class="hljs-keyword">return</span> info;<br>    };<br>});<br><br></code></pre></td></tr></tbody></table></figure><ul><li>è¯¥ä»£ç  Hook äº† <code>getPackageInfo()</code> æ–¹æ³•ï¼Œä½¿å…¶å§‹ç»ˆè¿”å›åˆæ³•çš„ç­¾åã€‚</li></ul><h3 id="ï¼ˆ2ï¼‰ä¿®æ”¹-Smali-ä»£ç "><a href="#ï¼ˆ2ï¼‰ä¿®æ”¹-Smali-ä»£ç " class="headerlink" title="ï¼ˆ2ï¼‰ä¿®æ”¹ Smali ä»£ç "></a><strong>ï¼ˆ2ï¼‰ä¿®æ”¹ Smali ä»£ç </strong></h3><ol><li><p>åç¼–è¯‘ APKï¼š</p> <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>apktool d app.apk -o app_smali<br></code></pre></td></tr></tbody></table></figure></li><li><p>æ‰¾åˆ° <code>getSignature()</code> æ–¹æ³•ï¼Œå°†ç­¾åæ¯”å¯¹é€»è¾‘æ”¹ä¸º <code>return true</code>ï¼š</p> <figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs smali">smali<br>å¤åˆ¶ç¼–è¾‘<span class="hljs-built_in"></span><br><span class="hljs-built_in">const-string </span>v0, <span class="hljs-string">"ABC123DEF456..."</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">return </span>v0<br><br>//ä½¿æ ¡éªŒå‡½æ•°ç›´æ¥è¿”å›trueæˆ–è·³è¿‡æ ¡éªŒæ­¥éª¤<br></code></pre></td></tr></tbody></table></figure></li><li><p>é‡æ–°æ‰“åŒ…å¹¶ç­¾åï¼š</p> <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>apktool b app_smali -o new_app.apk<br>zipalign -p 4 new_app.apk new_app_aligned.apk<br>apksigner sign --ks mykeystore.jks --out new_app_signed.apk new_app_aligned.apk<br></code></pre></td></tr></tbody></table></figure></li></ol><h3 id="ï¼ˆ3ï¼‰ç›´æ¥ä¿®æ”¹-APK-ç­¾å"><a href="#ï¼ˆ3ï¼‰ç›´æ¥ä¿®æ”¹-APK-ç­¾å" class="headerlink" title="ï¼ˆ3ï¼‰ç›´æ¥ä¿®æ”¹ APK ç­¾å"></a><strong>ï¼ˆ3ï¼‰ç›´æ¥ä¿®æ”¹ APK ç­¾å</strong></h3><ul><li><p>ä½¿ç”¨ <code>zipalign</code> å’Œ <code>apksigner</code> é‡æ–°ç­¾å APKï¼š</p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>zipalign -p 4 modded.apk modded_aligned.apk<br>apksigner sign --ks mykeystore.jks --out modded_signed.apk modded_aligned.apk<br></code></pre></td></tr></tbody></table></figure></li><li><p>ä½†æ˜¯å¦‚æœåº”ç”¨å†…ç½®äº†ç­¾åæ ¡éªŒä»£ç ï¼Œä»ç„¶éœ€è¦ Hook ç›¸å…³æ–¹æ³•ç»•è¿‡ã€‚</p></li></ul><hr><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a><strong>5. æ€»ç»“</strong></h3><h3 id="å¦‚ä½•å¢å¼ºç­¾åæ ¡éªŒï¼Ÿï¼ˆå¼€å‘è€…è§†è§’ï¼‰"><a href="#å¦‚ä½•å¢å¼ºç­¾åæ ¡éªŒï¼Ÿï¼ˆå¼€å‘è€…è§†è§’ï¼‰" class="headerlink" title="å¦‚ä½•å¢å¼ºç­¾åæ ¡éªŒï¼Ÿï¼ˆå¼€å‘è€…è§†è§’ï¼‰"></a><strong>å¦‚ä½•å¢å¼ºç­¾åæ ¡éªŒï¼Ÿ</strong>ï¼ˆå¼€å‘è€…è§†è§’ï¼‰</h3><ol><li><strong>é¿å…ç¡¬ç¼–ç ç­¾åå€¼</strong><ul><li>åŠ¨æ€ä»æœåŠ¡å™¨è·å–åˆæ³•ç­¾åï¼Œæˆ–é€šè¿‡ä»£ç æ··æ·†åˆ†æ•£å­˜å‚¨ã€‚</li></ul></li><li><strong>Nativeå±‚æ ¡éªŒ</strong><ul><li>å°†æ ¡éªŒé€»è¾‘å†™å…¥C/C++åº“ï¼ˆ.soæ–‡ä»¶ï¼‰ï¼Œå¹¶æ·»åŠ åè°ƒè¯•ã€ä»£ç æ··æ·†ç­‰ä¿æŠ¤ã€‚</li></ul></li><li><strong>å¤šç»´åº¦æ ¡éªŒ</strong><ul><li>åŒæ—¶æ ¡éªŒç­¾åå“ˆå¸Œã€è¯ä¹¦åºåˆ—å·ã€å…¬é’¥ç­‰ä¿¡æ¯ï¼Œè€Œéå•ä¸€å“ˆå¸Œå€¼ã€‚</li></ul></li><li><strong>ç¯å¢ƒæ£€æµ‹</strong><ul><li>ç»“åˆRootæ£€æµ‹ã€æ¨¡æ‹Ÿå™¨æ£€æµ‹ï¼Œé˜²æ­¢æ ¡éªŒé€»è¾‘åœ¨è°ƒè¯•ç¯å¢ƒä¸­è¿è¡Œã€‚</li></ul></li><li><strong>æœåŠ¡ç«¯ååŒ</strong><ul><li>å…³é”®ä¸šåŠ¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯äºŒæ¬¡æ ¡éªŒå®¢æˆ·ç«¯çš„ç­¾åä¿¡æ¯ã€‚</li></ul></li></ol><table><thead><tr><th><strong>ç­¾åæ ¡éªŒç±»å‹</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>ç»•è¿‡æ–¹å¼</strong></th></tr></thead><tbody><tr><td><strong>ç³»ç»Ÿçº§ç­¾åæ ¡éªŒ</strong></td><td>æ£€æŸ¥ APK å®‰è£…æ—¶çš„åˆæ³•æ€§</td><td>æ— æ³•ç»•è¿‡ï¼Œå¿…é¡»é‡æ–°ç­¾å</td></tr><tr><td><strong>åº”ç”¨è‡ªæ ¡éªŒ</strong></td><td>è¿è¡Œæ—¶æ£€æµ‹ç­¾åæ˜¯å¦åŒ¹é…</td><td>Hook <code>getPackageInfo()</code>ã€ä¿®æ”¹ Smali</td></tr></tbody></table><ul><li><strong>ç­¾åæ ¡éªŒä¸»è¦ç”¨äºé˜²æ­¢äºŒæ¬¡æ‰“åŒ…å’Œç ´è§£ï¼Œä½†å¯ä»¥é€šè¿‡ Hook æˆ–ä¿®æ”¹ Smali ç»•è¿‡ã€‚</strong></li><li><strong>æ›´é«˜çº§çš„ä¿æŠ¤æ‰‹æ®µå¯èƒ½ä¼šå°†ç­¾åæ ¡éªŒä¸ä»£ç å®Œæ•´æ€§æ ¡éªŒã€JNI ä¿æŠ¤ç­‰ç»“åˆï¼Œå¢åŠ ç ´è§£éš¾åº¦ã€‚</strong></li></ul></li></ul><p>å¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ‰ç­¾åæ ¡éªŒï¼Ÿ</p><p>ä¸åšä»»ä½•ä¿®æ”¹ï¼Œç›´æ¥ç­¾åå®‰è£…ï¼Œåº”ç”¨é—ªé€€åˆ™è¯´æ˜å¤§æ¦‚ç‡æœ‰ç­¾åæ ¡éªŒ</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ™®é€šçš„ç­¾åæ ¡éªŒä¼šå¯¼è‡´è½¯ä»¶çš„é—ªé€€ï¼Œé»‘å±ï¼Œå¡å¯åŠ¨é¡µç­‰</p><p>å½“ç„¶ï¼Œä»¥ä¸Šéƒ½ç®—æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæœ‰ä¸€äº›æ¯”è¾ƒç‹ çš„ä½œè€…ï¼Œåˆ™ä¼šç›´æ¥rm -rf /ï¼ŒæŠŠåŸºå¸¦éƒ½æ ¼æ‰çš„ä¸€é”®å˜ç –ã€‚</p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs lua"><br>kill/killProcess<span class="hljs-comment">-----kill/KillProcess()å¯ä»¥æ€æ­»å½“å‰åº”ç”¨æ´»åŠ¨çš„è¿›ç¨‹ï¼Œè¿™ä¸€æ“ä½œå°†ä¼šæŠŠæ‰€æœ‰è¯¥è¿›ç¨‹å†…çš„èµ„æºï¼ˆåŒ…æ‹¬çº¿ç¨‹å…¨éƒ¨æ¸…ç†æ‰ï¼‰.å½“ç„¶ï¼Œç”±äºActivityManageræ—¶åˆ»ç›‘å¬ç€è¿›ç¨‹ï¼Œä¸€æ—¦å‘ç°è¿›ç¨‹è¢«éæ­£å¸¸Killï¼Œå®ƒå°†ä¼šè¯•å›¾å»é‡å¯è¿™ä¸ªè¿›ç¨‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œæœ‰æ—¶å€™å½“æˆ‘ä»¬è¯•å›¾è¿™æ ·å»ç»“æŸæ‰åº”ç”¨æ—¶ï¼Œå‘ç°å®ƒåˆè‡ªåŠ¨é‡æ–°å¯åŠ¨çš„åŸå› .</span><br><br>system.<span class="hljs-built_in">exit</span><span class="hljs-comment">-----æ€æ­»äº†æ•´ä¸ªè¿›ç¨‹ï¼Œè¿™æ—¶å€™æ´»åŠ¨æ‰€å çš„èµ„æºä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚</span><br><br>finish<span class="hljs-comment">----------ä»…ä»…é’ˆå¯¹Activityï¼Œå½“è°ƒç”¨finish()æ—¶ï¼Œåªæ˜¯å°†æ´»åŠ¨æ¨å‘åå°ï¼Œå¹¶æ²¡æœ‰ç«‹å³é‡Šæ”¾å†…å­˜ï¼Œæ´»åŠ¨çš„èµ„æºå¹¶æ²¡æœ‰è¢«æ¸…ç†</span><br></code></pre></td></tr></tbody></table></figure><p>åœ¨æˆ‘ä¸ªäººè§è¿‡æœ€æ¶å¿ƒçš„ç­¾åæ ¡éªŒä¸­ï¼Œå½“å±ä¸‰è§’æ ¡éªŒ(ä½è°ƒå¤§ä½¬æ•™çš„)æœ€çƒ¦äººã€‚</p><p>æ‰€è°“ä¸‰è§’æ ¡éªŒï¼Œå°±æ˜¯soæ£€æµ‹dexï¼ŒåŠ¨æ€åŠ è½½çš„dex(åœ¨è½¯ä»¶è¿è¡Œæ—¶ä¼šè§£å‹é‡Šæ”¾ä¸€æ®µdexæ–‡ä»¶ï¼Œæ£€æµ‹å®Œåå°±åˆ é™¤)æ£€æµ‹soï¼Œdexæ£€æµ‹åŠ¨æ€åŠ è½½çš„dex</p><ul><li><p>ç¤ºä¾‹</p><ol><li>æ‰“å¼€ç®—æ³•åŠ©æ‰‹çš„æ‹¦æˆªå’Œé˜²æ­¢é€€å‡º</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232135856.png"></p><ol><li>æˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¿—ä¸­æŸ¥çœ‹åˆ°æ‹¦æˆªä¿¡æ¯</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232136105.png"></p><ol><li>æŸ¥æ‰¾åˆ°é—ªé€€çš„æ–¹æ³•</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232136056.png"></p><ol><li>æŸ¥è¯¢åˆ°é—ªé€€çš„ä»£ç å°†å…¶æ³¨é‡Šæ‰ï¼Œå°±å¯ä»¥è§£å†³é—ªé€€ç­‰é—®é¢˜ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232136193.png"></p><ol><li>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç®—æ³•åŠ©æ‰‹çš„ç­¾åç›‘å¬æ¥è¿›è¡Œå®šä½</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232136656.png"></p><ol><li>é€šè¿‡æ—¥å¿—ä¸­çš„ç­¾åä¿¡æ¯æ‰¾åˆ°å…¶ç›¸åº”çš„å †æ ˆè¿›è¡ŒæŸ¥è¯¢</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232136332.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137296.png"></p><ol><li>å¯¹å †æ ˆè¿›è¡ŒæŸ¥è¯¢æ‰¾åˆ°å…³é”®æ–¹æ³•<code>checkSign</code>è¿›è¡Œåˆ†æã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137737.png"></p><ol><li>é€šè¿‡è·å–å®‰è£…åŒ…ç­¾åä¿¡æ¯çš„å€¼ä¸<code>SIGNATURE</code>çš„å€¼è¿›è¡Œæ¯”å¯¹</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137906.png"></p><ol><li>æˆ‘ä»¬å¯ä»¥å°†åˆ¤æ–­çš„é€»è¾‘if-nezæ”¹ä¸ºif-eqzï¼Œç›´æ¥æŠŠåˆ¤æ–­å–å</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137976.png"></p><ol><li>ç›´æ¥å¯¹signå€¼è¿›è¡ŒæŸ¥è¯¢</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137127.png"></p><ol><li>å°†åŒ…å†…çš„signæ›¿æ¢æ‰ï¼Œå°±å¯ä»¥é€šè¿‡æ™®é€šç­¾åæ ¡éªŒ</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232137039.png"></p></li></ul><p>æ™®é€šè·å–ç­¾åæ ¡éªŒä»£ç ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">SignCheck</span><span class="hljs-params">()</span> {<br>&nbsp; &nbsp; <span class="hljs-type">String</span> <span class="hljs-variable">trueSignMD5</span> <span class="hljs-operator">=</span> <span class="hljs-string">"d0add9987c7c84aeb7198c3ff26ca152"</span>;<br>&nbsp; &nbsp; <span class="hljs-type">String</span> <span class="hljs-variable">nowSignMD5</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>;<br>&nbsp; &nbsp; <span class="hljs-keyword">try</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">// å¾—åˆ°ç­¾åçš„MD5</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">PackageInfo</span> <span class="hljs-variable">packageInfo</span> <span class="hljs-operator">=</span> getPackageManager().getPackageInfo(getPackageName(),PackageManager.GET_SIGNATURES);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Signature[] signs = packageInfo.signatures;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">signBase64</span> <span class="hljs-operator">=</span> Base64Util.encodeToString(signs[<span class="hljs-number">0</span>].toByteArray());<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;nowSignMD5 = MD5Utils.MD5(signBase64);<br>&nbsp; &nbsp; } <span class="hljs-keyword">catch</span> (PackageManager.NameNotFoundException e) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;e.printStackTrace();<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> trueSignMD5.equals(nowSignMD5);<br>}<br></code></pre></td></tr></tbody></table></figure><p>ç³»ç»Ÿå°†åº”ç”¨çš„ç­¾åä¿¡æ¯å°è£…åœ¨ PackageInfo ä¸­ï¼Œè°ƒç”¨ PackageManager çš„ getPackageInfo(String packageName, int flags) å³å¯è·å–æŒ‡å®šåŒ…åçš„ç­¾åä¿¡æ¯ã€‚</p><h2 id="4-ç­¾åæ ¡éªŒå¯¹æŠ—"><a href="#4-ç­¾åæ ¡éªŒå¯¹æŠ—" class="headerlink" title="4.ç­¾åæ ¡éªŒå¯¹æŠ—"></a><strong>4.ç­¾åæ ¡éªŒå¯¹æŠ—</strong></h2><p>æ–¹æ³•ä¸€:æ ¸å¿ƒç ´è§£æ’ä»¶ï¼Œä¸ç­¾åå®‰è£…åº”ç”¨</p><p>æ–¹æ³•äºŒ:ä¸€é”®è¿‡ç­¾åå·¥å…·ï¼Œä¾‹å¦‚MTã€NPã€ARMProã€CNFIXã€Modexçš„å»é™¤ç­¾åæ ¡éªŒåŠŸèƒ½</p><p>æ–¹æ³•ä¸‰:å…·ä½“åˆ†æç­¾åæ ¡éªŒé€»è¾‘(æ‰‹æ’•ç­¾åæ ¡éªŒ)</p><p>æ–¹æ³•å››:ioé‡å®šå‘â€“VA&amp;SVCï¼šptrace+seccomp</p><p><a href="https://bbs.pediy.com/thread-273160.htm">SVCçš„TraceHookæ²™ç®±çš„å®ç°&amp;æ— ç—•Hookå®ç°æ€è·¯</a></p><p>æ–¹æ³•äº”:å»ä½œè€…å®¶ä¸¥åˆ‘æ‹·æ‰“æ‹¿åˆ°.jksæ–‡ä»¶å’Œå¯†ç </p><ul><li><p>jksæ–‡ä»¶äº†</p><p>  <strong><code>.jks</code> æ–‡ä»¶</strong>æ˜¯ <strong>Java KeyStore</strong> æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºå­˜å‚¨åŠ å¯†å¯†é’¥ã€è¯ä¹¦å’Œç§é’¥ï¼Œé€šå¸¸ç”¨äº SSL/TLS è¯ä¹¦ç®¡ç†ã€‚Java åº”ç”¨ç¨‹åºä½¿ç”¨ <code>.jks</code> æ–‡ä»¶æ¥ç¡®ä¿å®‰å…¨çš„é€šä¿¡ã€‚</p><h3 id="å¸¸è§ç”¨é€”"><a href="#å¸¸è§ç”¨é€”" class="headerlink" title="å¸¸è§ç”¨é€”"></a><strong>å¸¸è§ç”¨é€”</strong></h3><ol><li><strong>SSL/TLS è¯ä¹¦ç®¡ç†</strong>ï¼ˆHTTPS æœåŠ¡å™¨ã€å®¢æˆ·ç«¯èº«ä»½éªŒè¯ï¼‰</li><li><strong>Java åº”ç”¨å®‰å…¨</strong>ï¼ˆå¦‚ Spring Bootã€Tomcatï¼‰</li><li><strong>Android ç­¾å</strong>ï¼ˆç”¨äº APK ç­¾åï¼‰</li></ol><h3 id="å¸¸è§å‘½ä»¤ï¼ˆkeytool-å·¥å…·ï¼‰"><a href="#å¸¸è§å‘½ä»¤ï¼ˆkeytool-å·¥å…·ï¼‰" class="headerlink" title="å¸¸è§å‘½ä»¤ï¼ˆkeytool å·¥å…·ï¼‰"></a><strong>å¸¸è§å‘½ä»¤ï¼ˆkeytool å·¥å…·ï¼‰</strong></h3><p>  <code>keytool</code> æ˜¯ Java è‡ªå¸¦çš„å¯†é’¥ç®¡ç†å·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºå’Œç®¡ç† <code>.jks</code> æ–‡ä»¶ã€‚</p><h3 id="1-ç”Ÿæˆæ–°çš„-JKS-æ–‡ä»¶"><a href="#1-ç”Ÿæˆæ–°çš„-JKS-æ–‡ä»¶" class="headerlink" title="1. ç”Ÿæˆæ–°çš„ JKS æ–‡ä»¶"></a><strong>1. ç”Ÿæˆæ–°çš„ JKS æ–‡ä»¶</strong></h3>  <figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">keytool</span> -genkey -alias myalias -keyalg RSA -keystore mykeystore.jks -validity <span class="hljs-number">3650</span> -storepass mypassword<br><br></code></pre></td></tr></tbody></table></figure><ul><li><code>alias myalias</code>ï¼šæŒ‡å®šåˆ«å</li><li><code>keyalg RSA</code>ï¼šå¯†é’¥ç®—æ³•</li><li><code>keystore mykeystore.jks</code>ï¼šJKS æ–‡ä»¶å</li><li><code>validity 3650</code>ï¼šè¯ä¹¦æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰</li><li><code>storepass mypassword</code>ï¼šå¯†é’¥åº“å¯†ç </li></ul><h3 id="2-æŸ¥çœ‹-JKS-æ–‡ä»¶å†…å®¹"><a href="#2-æŸ¥çœ‹-JKS-æ–‡ä»¶å†…å®¹" class="headerlink" title="2. æŸ¥çœ‹ JKS æ–‡ä»¶å†…å®¹"></a><strong>2. æŸ¥çœ‹ JKS æ–‡ä»¶å†…å®¹</strong></h3>  <figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lsl">keytool -<span class="hljs-type">list</span> -keystore mykeystore.jks -storepass mypassword<br><br></code></pre></td></tr></tbody></table></figure><h3 id="3-å¯¼å…¥è¯ä¹¦åˆ°-JKS"><a href="#3-å¯¼å…¥è¯ä¹¦åˆ°-JKS" class="headerlink" title="3. å¯¼å…¥è¯ä¹¦åˆ° JKS"></a><strong>3. å¯¼å…¥è¯ä¹¦åˆ° JKS</strong></h3>  <figure class="highlight applescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">keytool -import -trustcacerts -<span class="hljs-built_in">alias</span> mycert -<span class="hljs-built_in">file</span> mycert.crt -keystore mykeystore.jks<br><br></code></pre></td></tr></tbody></table></figure><h3 id="4-å¯¼å‡ºè¯ä¹¦"><a href="#4-å¯¼å‡ºè¯ä¹¦" class="headerlink" title="4. å¯¼å‡ºè¯ä¹¦"></a><strong>4. å¯¼å‡ºè¯ä¹¦</strong></h3>  <figure class="highlight delphi"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs delphi">keytool -<span class="hljs-keyword">export</span> -<span class="hljs-keyword">alias</span> myalias -<span class="hljs-keyword">file</span> mycert.crt -keystore mykeystore.jks<br><br></code></pre></td></tr></tbody></table></figure><h3 id="5-è½¬æ¢-JKS-åˆ°-PKCS12"><a href="#5-è½¬æ¢-JKS-åˆ°-PKCS12" class="headerlink" title="5. è½¬æ¢ JKS åˆ° PKCS12"></a><strong>5. è½¬æ¢ JKS åˆ° PKCS12</strong></h3>  <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">keytool -importkeystore -srckeystore mykeystore<span class="hljs-selector-class">.jks</span> -destkeystore mykeystore<span class="hljs-selector-class">.p12</span> -deststoretype PKCS12<br><br></code></pre></td></tr></tbody></table></figure><h3 id="JKS-åœ¨-Android-ä¸­çš„åº”ç”¨"><a href="#JKS-åœ¨-Android-ä¸­çš„åº”ç”¨" class="headerlink" title="JKS åœ¨ Android ä¸­çš„åº”ç”¨"></a><strong>JKS åœ¨ Android ä¸­çš„åº”ç”¨</strong></h3><p>  Android åº”ç”¨ä½¿ç”¨ JKS æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>.keystore</code> æ ¼å¼ï¼‰æ¥ç­¾å APKã€‚ä¾‹å¦‚ï¼š</p>  <figure class="highlight applescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">arsigner -verbose -keystore <span class="hljs-keyword">my</span>-release-key.jks <span class="hljs-keyword">my</span>-app.apk myalias<br><br></code></pre></td></tr></tbody></table></figure></li></ul><h2 id="5-æ‰‹åŠ¨å®ç°PMä»£-è¿‡-æ»¤-ç†"><a href="#5-æ‰‹åŠ¨å®ç°PMä»£-è¿‡-æ»¤-ç†" class="headerlink" title="5.æ‰‹åŠ¨å®ç°PMä»£{è¿‡}{æ»¤}ç†"></a><strong>5.æ‰‹åŠ¨å®ç°PMä»£{è¿‡}{æ»¤}ç†</strong></h2><h3 id="1-ä»€ä¹ˆæ˜¯PMS"><a href="#1-ä»€ä¹ˆæ˜¯PMS" class="headerlink" title="1.ä»€ä¹ˆæ˜¯PMS"></a><strong>1.ä»€ä¹ˆæ˜¯PMS</strong></h3><p>æ€è·¯æºè‡ªï¼š<a href="https://github.com/fourbrother/HookPmsSignature">Androidä¸­Hook åº”ç”¨ç­¾åæ–¹æ³•</a></p><p>PackageManagerServiceï¼ˆç®€ç§°PMSï¼‰ï¼Œæ˜¯Androidç³»ç»Ÿæ ¸å¿ƒæœåŠ¡ä¹‹ä¸€ï¼Œå¤„ç†åŒ…ç®¡ç†ç›¸å…³çš„å·¥ä½œï¼Œå¸¸è§çš„æ¯”å¦‚å®‰è£…ã€å¸è½½åº”ç”¨ç­‰ã€‚</p><h3 id="2-å®ç°æ–¹æ³•ä»¥åŠåŸç†è§£æ"><a href="#2-å®ç°æ–¹æ³•ä»¥åŠåŸç†è§£æ" class="headerlink" title="2.å®ç°æ–¹æ³•ä»¥åŠåŸç†è§£æ"></a><strong>2.å®ç°æ–¹æ³•ä»¥åŠåŸç†è§£æ</strong></h3><p>HOOK PMSä»£ç :</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.zj.hookpms;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.lang.reflect.Proxy;<br><br><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.content.pm.PackageManager;<br><span class="hljs-keyword">import</span> android.util.Log;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceManagerWraper</span> {<br><br>&nbsp; &nbsp; <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">ZJ</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ZJ595"</span>;<br><br>&nbsp; &nbsp; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hookPMS</span><span class="hljs-params">(Context context, String signed, String appPkgName, <span class="hljs-type">int</span> hashCode)</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">try</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// è·å–å…¨å±€çš„ActivityThreadå¯¹è±¡</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Class&lt;?&gt; activityThreadClass = Class.forName(<span class="hljs-string">"android.app.ActivityThread"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Method</span> <span class="hljs-variable">currentActivityThreadMethod</span> <span class="hljs-operator">=</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;activityThreadClass.getDeclaredMethod(<span class="hljs-string">"currentActivityThread"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Object</span> <span class="hljs-variable">currentActivityThread</span> <span class="hljs-operator">=</span> currentActivityThreadMethod.invoke(<span class="hljs-literal">null</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// è·å–ActivityThreadé‡Œé¢åŸå§‹çš„sPackageManager</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Field</span> <span class="hljs-variable">sPackageManagerField</span> <span class="hljs-operator">=</span> activityThreadClass.getDeclaredField(<span class="hljs-string">"sPackageManager"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sPackageManagerField.setAccessible(<span class="hljs-literal">true</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Object</span> <span class="hljs-variable">sPackageManager</span> <span class="hljs-operator">=</span> sPackageManagerField.get(currentActivityThread);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// å‡†å¤‡å¥½ä»£{è¿‡}{æ»¤}ç†å¯¹è±¡, ç”¨æ¥æ›¿æ¢åŸå§‹çš„å¯¹è±¡</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Class&lt;?&gt; iPackageManagerInterface = Class.forName(<span class="hljs-string">"android.content.pm.IPackageManager"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Object</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> Proxy.newProxyInstance(<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;iPackageManagerInterface.getClassLoader(),<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>&lt;?&gt;[]{iPackageManagerInterface},<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">new</span> <span class="hljs-title class_">PmsHookBinderInvocationHandler</span>(sPackageManager, signed, appPkgName, <span class="hljs-number">0</span>));<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// 1. æ›¿æ¢æ‰ActivityThreadé‡Œé¢çš„ sPackageManager å­—æ®µ</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sPackageManagerField.set(currentActivityThread, proxy);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// 2. æ›¿æ¢ ApplicationPackageManageré‡Œé¢çš„ mPMå¯¹è±¡</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">PackageManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> context.getPackageManager();<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-type">Field</span> <span class="hljs-variable">mPmField</span> <span class="hljs-operator">=</span> pm.getClass().getDeclaredField(<span class="hljs-string">"mPM"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;mPmField.setAccessible(<span class="hljs-literal">true</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;mPmField.set(pm, proxy);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;} <span class="hljs-keyword">catch</span> (Exception e) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Log.d(ZJ, <span class="hljs-string">"hook pms error:"</span> + Log.getStackTraceString(e));<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hookPMS</span><span class="hljs-params">(Context context)</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">String</span> <span class="hljs-variable">Sign</span> <span class="hljs-operator">=</span> <span class="hljs-string">"åŸåŒ…çš„ç­¾åä¿¡æ¯"</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;hookPMS(context, Sign, <span class="hljs-string">"com.zj.hookpms"</span>, <span class="hljs-number">0</span>);<br>&nbsp; &nbsp; }<br>}<br></code></pre></td></tr></tbody></table></figure><p>ActivityThreadçš„é™æ€å˜é‡sPackageManager</p><p>ApplicationPackageManagerå¯¹è±¡é‡Œé¢çš„mPMå˜é‡</p><ul><li><p>è·å–åŸåŒ…ç­¾åä¿¡æ¯</p><ol><li>ä½¿ç”¨MTç®¡ç†å™¨ï¼Œç‚¹å‡»ç­¾åä¿¡æ¯å¹¶æŸ¥çœ‹åŸå§‹æ•°æ®</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232138337.png"></p><ol><li>è¿™ä¸€ä¸²å†…å®¹å‡ä¸ºå…¶é‚£åä¿¡æ¯ï¼Œå°†å†…å®¹å…¨é€‰å¤åˆ¶ä¸ºbase64å¹¶ä¸åŸåŒ…ç­¾åä¿¡æ¯è¿›è¡Œæ›¿æ¢</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232139337.png"></p><p>  3.æ›¿æ¢ä¿¡æ¯åï¼Œè°ƒç”¨ä»£ç </p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232139942.png"></p></li></ul><p>è¯¥æ–¹æ³•è¾ƒä¸ºè¿‡æ—¶ï¼Œç®€å•äº†è§£ä¸€ä¸‹å³å¯ã€‚</p><h2 id="6-IOé‡å®šå‘"><a href="#6-IOé‡å®šå‘" class="headerlink" title="6.IOé‡å®šå‘"></a><strong>6.IOé‡å®šå‘</strong></h2><ul><li><p>ä»€ä¹ˆæ˜¯IOé‡å®šå‘</p><pre><code class="hljs">IO é‡å®šå‘ï¼ˆInput/Output Redirectionï¼‰æ˜¯æŒ‡åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå°†æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰æˆ–æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰é‡å®šå‘åˆ°ä¸åŒçš„æ–‡ä»¶æˆ–è®¾å¤‡ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ç»ˆç«¯ï¼ˆå±å¹•å’Œé”®ç›˜ï¼‰ã€‚è¿™æ˜¯ Unix/Linux å’Œ Windows å‘½ä»¤è¡Œä¸­å¸¸è§çš„æ“ä½œï¼Œä¸»è¦ç”¨äºæ§åˆ¶ç¨‹åºçš„è¾“å…¥å’Œè¾“å‡ºã€‚åœ¨ **Android é€†å‘** ä¸­ï¼Œ**IO é‡å®šå‘**ï¼ˆInput/Output Redirectionï¼‰ä¸»è¦ç”¨äºåŠ«æŒã€ä¿®æ”¹æˆ–æ•è·åº”ç”¨ç¨‹åºçš„æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰ã€‚å®ƒåœ¨åˆ†æã€è°ƒè¯•å’Œ Hook è¿‡ç¨‹ä¸­éå¸¸é‡è¦ã€‚</code></pre><hr><h2 id="1-IO-é‡å®šå‘åœ¨-Android-é€†å‘ä¸­çš„ä½œç”¨"><a href="#1-IO-é‡å®šå‘åœ¨-Android-é€†å‘ä¸­çš„ä½œç”¨" class="headerlink" title="1. IO é‡å®šå‘åœ¨ Android é€†å‘ä¸­çš„ä½œç”¨"></a><strong>1. IO é‡å®šå‘åœ¨ Android é€†å‘ä¸­çš„ä½œç”¨</strong></h2><p>  åœ¨ Android é€†å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›è·å–åº”ç”¨ç¨‹åºçš„ <strong>è°ƒè¯•æ—¥å¿—</strong>ã€<strong>æ ‡å‡†è¾“å‡º</strong>ã€<strong>æ ‡å‡†é”™è¯¯</strong>ï¼Œæˆ–è€…å°†è¾“å…¥é‡å®šå‘åˆ°ç›®æ ‡è¿›ç¨‹ã€‚ç”±äº Android åº”ç”¨é€šå¸¸è¿è¡Œåœ¨ <strong>Linux ç¯å¢ƒï¼ˆåŸºäº Android å†…æ ¸ï¼‰</strong> ä¸‹ï¼Œå®ƒä¹Ÿéµå¾ª Linux çš„ IO æœºåˆ¶ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <strong>é‡å®šå‘æŠ€æœ¯</strong> è¿›è¡Œä¿¡æ¯æ•è·æˆ–å¹²é¢„ã€‚</p><hr><h2 id="2-IO-é‡å®šå‘çš„å¸¸è§ç”¨é€”"><a href="#2-IO-é‡å®šå‘çš„å¸¸è§ç”¨é€”" class="headerlink" title="2. IO é‡å®šå‘çš„å¸¸è§ç”¨é€”"></a><strong>2. IO é‡å®šå‘çš„å¸¸è§ç”¨é€”</strong></h2><h3 id="ï¼ˆ1ï¼‰æ•è·åº”ç”¨æ ‡å‡†è¾“å‡º"><a href="#ï¼ˆ1ï¼‰æ•è·åº”ç”¨æ ‡å‡†è¾“å‡º" class="headerlink" title="ï¼ˆ1ï¼‰æ•è·åº”ç”¨æ ‡å‡†è¾“å‡º"></a><strong>ï¼ˆ1ï¼‰æ•è·åº”ç”¨æ ‡å‡†è¾“å‡º</strong></h3><p>  æœ‰äº› Android åº”ç”¨ä¼šåœ¨ <code>stdout</code> æˆ– <code>stderr</code> ä¸­æ‰“å°è°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p>  <figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">c<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">"Secret Key: %s\n"</span>, secretKey);<br><br></code></pre></td></tr></tbody></table></figure><p>  ä½†è¿™äº›ä¿¡æ¯ä¸ä¼šç›´æ¥æ˜¾ç¤ºåœ¨ Logcat ä¸­ï¼Œè€Œæ˜¯éœ€è¦é‡å®šå‘è¾“å‡ºæ‰èƒ½æ•è·ã€‚</p><h3 id="æ–¹æ³•1ï¼šä½¿ç”¨-strace-æˆ–-logcat"><a href="#æ–¹æ³•1ï¼šä½¿ç”¨-strace-æˆ–-logcat" class="headerlink" title="æ–¹æ³•1ï¼šä½¿ç”¨ strace æˆ– logcat"></a><strong>æ–¹æ³•1ï¼šä½¿ç”¨ strace æˆ– logcat</strong></h3><ul><li><p><strong>ä½¿ç”¨ <code>strace</code> ç›‘è§† IO è°ƒç”¨</strong></p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>strace -p &lt;PID&gt; -e write<br><br></code></pre></td></tr></tbody></table></figure><p>  è¿™å¯ä»¥ç›‘è§† <code>write</code> ç³»ç»Ÿè°ƒç”¨ï¼Œæ•è·åº”ç”¨å†™å…¥ <code>stdout</code> å’Œ <code>stderr</code> çš„æ•°æ®ã€‚</p></li><li><p><strong>ä½¿ç”¨ <code>logcat</code> æ•è·æ—¥å¿—</strong></p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>logcat -s <span class="hljs-string">"AppTag"</span><br><br></code></pre></td></tr></tbody></table></figure></li></ul><h3 id="æ–¹æ³•2ï¼šä½¿ç”¨-run-as-é‡å®šå‘"><a href="#æ–¹æ³•2ï¼šä½¿ç”¨-run-as-é‡å®šå‘" class="headerlink" title="æ–¹æ³•2ï¼šä½¿ç”¨ run-as é‡å®šå‘"></a><strong>æ–¹æ³•2ï¼šä½¿ç”¨ <code>run-as</code> é‡å®šå‘</strong></h3><p>  å¦‚æœç›®æ ‡åº”ç”¨æ˜¯ <code>debuggable</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>run-as</code> åˆ‡æ¢åˆ°åº”ç”¨çš„ UID å¹¶é‡å®šå‘ IOï¼š</p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>run-as com.example.app sh -c <span class="hljs-string">'exec &gt; /data/data/com.example.app/output.log 2&gt;&amp;1'</span><br><br></code></pre></td></tr></tbody></table></figure><p>  è¿™ä¼šå°†åº”ç”¨çš„ <code>stdout</code> å’Œ <code>stderr</code> é‡å®šå‘åˆ° <code>output.log</code>ï¼Œç„¶åå¯ä»¥ç”¨ <code>adb pull</code> æ‹‰å–æ—¥å¿—ï¼š</p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>adb pull /data/data/com.example.app/output.log .<br><br></code></pre></td></tr></tbody></table></figure><hr><h3 id="ï¼ˆ2ï¼‰Hook-IO-å‡½æ•°"><a href="#ï¼ˆ2ï¼‰Hook-IO-å‡½æ•°" class="headerlink" title="ï¼ˆ2ï¼‰Hook IO å‡½æ•°"></a><strong>ï¼ˆ2ï¼‰Hook IO å‡½æ•°</strong></h3><p>  <strong>é‡å®šå‘ <code>open</code>ã€<code>read</code>ã€<code>write</code> ç­‰ç³»ç»Ÿè°ƒç”¨</strong>ï¼Œå¯ä»¥åœ¨åŠ¨æ€è°ƒè¯•ä¸­æ•è·å…³é”®æ•°æ®ï¼Œä¾‹å¦‚åº”ç”¨è¯»å†™çš„æ–‡ä»¶ã€ç½‘ç»œæ•°æ®ç­‰ã€‚</p><h3 id="æ–¹æ³•1ï¼šä½¿ç”¨-Frida-Hook-IO"><a href="#æ–¹æ³•1ï¼šä½¿ç”¨-Frida-Hook-IO" class="headerlink" title="æ–¹æ³•1ï¼šä½¿ç”¨ Frida Hook IO"></a><strong>æ–¹æ³•1ï¼šä½¿ç”¨ Frida Hook IO</strong></h3>  <figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">python<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-keyword">import</span> frida<br><br>script_code = <span class="hljs-string">"""</span><br><span class="hljs-string">Interceptor.attach(Module.findExportByName(null, 'write'), {</span><br><span class="hljs-string">    onEnter: function(args) {</span><br><span class="hljs-string">        send("Writing data: " + Memory.readUtf8String(args[1]));</span><br><span class="hljs-string">    }</span><br><span class="hljs-string">});</span><br><span class="hljs-string">"""</span><br>device = frida.get_usb_device()<br>session = device.attach(<span class="hljs-string">"com.target.app"</span>)<br>script = session.create_script(script_code)<br>script.on(<span class="hljs-string">"message"</span>, <span class="hljs-keyword">lambda</span> msg, data: <span class="hljs-built_in">print</span>(msg))<br>script.load()<br><br></code></pre></td></tr></tbody></table></figure><p>  <strong>ä½œç”¨ï¼š</strong></p><ul><li>Hook <code>write()</code> ç³»ç»Ÿè°ƒç”¨ï¼ŒåŠ«æŒç›®æ ‡è¿›ç¨‹çš„è¾“å‡ºå†…å®¹ï¼ˆå¦‚æ—¥å¿—ã€å¯†é’¥ç­‰ï¼‰ã€‚</li><li>é€‚ç”¨äºéœ€è¦ <strong>ç›‘è§†åº”ç”¨è¾“å‡ºæ•°æ®</strong> çš„åœºæ™¯ã€‚</li></ul><hr><h3 id="ï¼ˆ3ï¼‰ä¿®æ”¹åº”ç”¨è¾“å…¥"><a href="#ï¼ˆ3ï¼‰ä¿®æ”¹åº”ç”¨è¾“å…¥" class="headerlink" title="ï¼ˆ3ï¼‰ä¿®æ”¹åº”ç”¨è¾“å…¥"></a><strong>ï¼ˆ3ï¼‰ä¿®æ”¹åº”ç”¨è¾“å…¥</strong></h3><p>  åœ¨ Android é€†å‘ä¸­ï¼ŒæŸäº›åº”ç”¨ä¼šé€šè¿‡ <code>stdin</code> è¯»å–æ•°æ®ï¼Œæ¯”å¦‚å‘½ä»¤è¡Œå·¥å…·æˆ–è€… Shell è„šæœ¬ã€‚å¯ä»¥é€šè¿‡ <strong>è¾“å…¥é‡å®šå‘</strong> ä¼ªé€ æ•°æ®è¾“å…¥ï¼Œä¾‹å¦‚ï¼š</p>  <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-built_in">echo</span> <span class="hljs-string">"fake_password"</span> | ./target_binary<br><br></code></pre></td></tr></tbody></table></figure><p>  æˆ–è€… Hook <code>read()</code> å‡½æ•°ï¼Œä¿®æ”¹ <code>stdin</code> è¾“å…¥ï¼š</p>  <figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">python<br>å¤åˆ¶ç¼–è¾‘<br>Interceptor.attach(Module.findExportByName(null, <span class="hljs-string">'read'</span>), {<br>    onEnter: function(args) {<br>        args[<span class="hljs-number">1</span>].writeUtf8String(<span class="hljs-string">"hacked_input"</span>);<br>    }<br>});<br><br></code></pre></td></tr></tbody></table></figure><hr><h3 id="ï¼ˆ4ï¼‰åŠ«æŒ-Java-å±‚-IO"><a href="#ï¼ˆ4ï¼‰åŠ«æŒ-Java-å±‚-IO" class="headerlink" title="ï¼ˆ4ï¼‰åŠ«æŒ Java å±‚ IO"></a><strong>ï¼ˆ4ï¼‰åŠ«æŒ Java å±‚ IO</strong></h3><p>  åœ¨ Java å±‚ï¼Œ<code>System.out.print()</code> é»˜è®¤ä¼šè¾“å‡ºåˆ° <code>stdout</code>ï¼Œå¯ä»¥é€šè¿‡ Hook <code>System.out</code> æ¥ä¿®æ”¹æˆ–æ•è·ï¼š</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">java<br>å¤åˆ¶ç¼–è¾‘<br>System.setOut(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStream</span>() {<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(<span class="hljs-type">int</span> b)</span> {<br>        <span class="hljs-comment">// åŠ«æŒ IOï¼Œæ”¹å†™è¾“å‡º</span><br>    }<br>}));<br><br></code></pre></td></tr></tbody></table></figure><p>  è¿™åœ¨ Hook Java æ–¹æ³•æ—¶å¯ä»¥ç”¨äºä¿®æ”¹åº”ç”¨æ—¥å¿—æˆ–éšè—å…³é”®è¾“å‡ºã€‚</p><hr><h2 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a><strong>3. æ€»ç»“</strong></h2><table><thead><tr><th><strong>ç”¨é€”</strong></th><th><strong>æŠ€æœ¯</strong></th></tr></thead><tbody><tr><td><strong>æ•è· <code>stdout</code>ã€<code>stderr</code></strong></td><td><code>strace</code>ã€<code>logcat</code>ã€<code>run-as</code></td></tr><tr><td><strong>Hook IO å‡½æ•°</strong></td><td><code>Frida</code>ã€<code>Xposed</code>ã€<code>LD_PRELOAD</code></td></tr><tr><td><strong>ä¿®æ”¹è¾“å…¥</strong></td><td><code>stdin</code> é‡å®šå‘ã€Hook <code>read()</code></td></tr><tr><td><strong>Java å±‚ IO åŠ«æŒ</strong></td><td><code>System.setOut()</code></td></tr></tbody></table><p>  <strong>IO é‡å®šå‘åœ¨ Android é€†å‘ä¸­çš„æ ¸å¿ƒä½œç”¨ï¼š</strong></p><ol><li><strong>è·å–åº”ç”¨æœªå…¬å¼€çš„è°ƒè¯•ä¿¡æ¯</strong></li><li><strong>ç›‘è§†æˆ–ç¯¡æ”¹åº”ç”¨è¾“å…¥</strong></li><li><strong>åˆ†æç›®æ ‡åº”ç”¨çš„æ—¥å¿—ã€å¯†é’¥æˆ–æ•æ„Ÿæ•°æ®</strong></li><li><strong>ç»“åˆ Frida/Xposed è¿›è¡Œ Hookï¼Œæé«˜è°ƒè¯•èƒ½åŠ›</strong></li></ol></li></ul><p>ä¾‹ï¼šåœ¨è¯»Aæ–‡ä»¶çš„æ—¶å€™æŒ‡å‘Bæ–‡ä»¶</p><p><a href="https://github.com/virjarRatel/ratel-core">å¹³å¤´å“¥çš„æ ¸å¿ƒä»£ç </a></p><p><a href="https://github.com/asLody/VirtualApp">Virtual Engine for Android(Support 12.0 in business version)</a></p><p>IOé‡å®šå‘å¯ä»¥å¹²å˜›ï¼Ÿ</p><p>1ï¼Œå¯ä»¥è®©æ–‡ä»¶åªè¯»ï¼Œä¸å¯å†™</p><p>2ï¼Œç¦æ­¢è®¿é—®æ–‡ä»¶</p><p>3ï¼Œè·¯å¾„æ›¿æ¢</p><p>å…·ä½“å®ç°ï¼š</p><p>è¿‡ç­¾åæ£€æµ‹(è¯»å–åŸåŒ…)</p><p>é£æ§å¯¹æŠ—(ä¾‹:ä¸€ä¸ªæ–‡ä»¶è®°å½•Appå¯åŠ¨çš„æ¬¡æ•°)</p><p>è¿‡Rootæ£€æµ‹ï¼ŒXposedæ£€æµ‹(æ–‡ä»¶ä¸å¯å–)</p><ul><li><p>æ–°çš„APIç­¾åæ ¡éªŒä¸æ™®é€šç­¾åæ ¡éªŒTureæ–¹æ³•ä¸€è‡´</p><ol><li>åˆ†æAPIçš„ç­¾åæ ¡éªŒç®—æ³•ï¼Œå‘ç°å®ƒnewsignå®šä½å¥½ç­¾åä¹‹åï¼Œå°†æ–°çš„APIä¸åŸæ¥çš„è¿›è¡Œæ¯”å¯¹ï¼Œä»å¯ä»¥é‡‡ç”¨æ™®é€šæ ¡éªŒçš„æ–¹å¼å°†æ–°çš„APIæ›¿æ¢ï¼Œtureå¤„ç†æ‰ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232139287.png">  </p></li><li><p>CRCæ ¡éªŒ</p><ol><li>è§‚å¯Ÿæ ¡éªŒéƒ¨åˆ†çš„ä»£ç å‘ç°ï¼Œè§£å‹åè·å–dexæ–‡ä»¶ï¼Œè·å–å®ƒçš„crcçš„ä¸€ä¸ªå€¼ã€‚è€Œæˆ‘ä»¬æ¯åšä¸€æ¬¡ä¿®æ”¹ï¼Œdexæ–‡ä»¶ä¸­çš„å€¼éƒ½ä¼šå‘ç”Ÿå¯¹åº”çš„æ”¹å˜ï¼Œè€Œå®ƒçš„å€¼éœ€è¦ä¸jè¿›è¡Œä¸€ä¸ªå¯¹æ¯”ï¼Œæˆ‘ä»¬é¡ºç€æ€è·¯æŸ¥çœ‹jåœ¨å“ªé‡Œ.</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140551.png"></p><ol><li>Ctrl+Fé¡ºç€jè¿›è¡ŒæŸ¥æ‰¾ï¼Œå‘ç°æ˜¯é€šè¿‡ä¸€ä¸ªæ–¹æ³•ä¼ å…¥ä¸€ä¸ªå€¼</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140993.png"></p><ol><li>æˆ‘ä»¬é¡ºç€è§‚å¯Ÿå‘ç°stringç±»é‡Œé¢æœ‰crcçš„å€¼</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140610.png"></p><ol><li>è·³è½¬æŸ¥çœ‹å‘ç°æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½ä¼šä½¿æ•°å€¼å‘ç”Ÿè½¬å˜ï¼Œä¸å¯èƒ½æ¯ä¸€æ¬¡éƒ½å¯¹æ•°å€¼è¿›è¡Œä¿®æ”¹ï¼Œå†™æ­»ä¼šå¯¼è‡´æ ¡éªŒå¤±è´¥ã€‚éœ€è¦è¿ç”¨ioé‡å®šå‘</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140613.png"></p><ol><li>ä»£ç å·²ç»å†™åœ¨soæ–‡ä»¶ä¸­ï¼Œç°åœ¨ç¼ºå°‘ä¸€ä¸ªè°ƒç”¨ã€‚ä½¿ç”¨smailä»£ç ã€‚å®ƒæ˜¯è·å–ä¸Šä¸‹æ–‡çš„æ–‡æœ¬ï¼Œç„¶åä¼ å…¥åˆ°hookæ–¹æ³•ä¸­ï¼Œhookæ–¹æ³•æ˜¯ä¸€ä¸ªnativeæ–¹æ³•ã€‚</li><li>é¦–å…ˆæ‰“å¼€ç¼–è¾‘å™¨æœç´¢åˆ°checkSignæ–¹æ³•åï¼Œæ‰“å¼€å¯¼èˆªæ‰¾åˆ°crcï¼ŒæŸ¥çœ‹ä»–çš„è°ƒç”¨ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140229.png"></p><ol><li>å› ä¸ºè¦è¿›è¡Œé‡å®šå‘ï¼Œè¦åœ¨æ ¡éªŒä¹‹å‰å®Œæˆè¿™éƒ¨åˆ†å·¥ä½œæ‰å¯ä»¥è¯»åˆ°åŸåŒ…ã€‚åœ¨æ–¹æ³•å¼€å¤´å°†æˆ‘ä»¬çš„è°ƒç”¨ä»£ç æ”¾å…¥è¿›å»ã€‚</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232140491.png"></p><ol><li>åœ¨è½¯ä»¶æ•°æ®ç›®å½•ä¸‹ï¼ˆæ•°æ®ç›®å½•1ï¼‰æ–°å»ºä¸€ä¸ªfilesæ–‡ä»¶ï¼Œå°†æ²¡æœ‰ç»è¿‡ä¿®æ”¹çš„åŸåŒ…å¤åˆ¶åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œé‡å‘½åä¸ºbase.apkï¼Œè¿™æ ·æ‰å¯ä»¥å®ç°ä¸€ä¸ªioçš„é‡å®šå‘è¯»å–åŸåŒ…çš„ä¿¡æ¯ã€‚ï¼ˆå…·ä½“åŸå› åœ¨ä»£ç éƒ¨åˆ†è§£é‡Šï¼‰</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232141891.png"></p><ol><li>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ioé‡å®šå‘çš„å®ç°ï¼ˆcrcè¯»å–dexçš„ä¸€ä¸ªcrcå€¼ï¼Œè€Œhashè¯»å–æ•´ä¸ªAPKä¸€ä¸ªhashçš„ä¸€ä¸ªå€¼ï¼‰</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232141186.png"></p></li></ul><p>ioé‡å®šå‘åŸç ï¼Œç›¸å½“äºhookçš„openï¼Œopenatç­‰å‡ ä¸ªå‡½æ•°ï¼ˆç”¨äºè¯»å–åº•å±‚æ–‡ä»¶å‡½æ•°ï¼‰</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><code class="hljs java">using namespace std;<br>string packname;<br>string origpath;<br>string fakepath;<br><br><span class="hljs-type">int</span> (*orig_open)(const <span class="hljs-type">char</span> *pathname, <span class="hljs-type">int</span> flags, ...);<br><span class="hljs-type">int</span> (*orig_openat)(<span class="hljs-type">int</span>,const <span class="hljs-type">char</span> *pathname, <span class="hljs-type">int</span> flags, ...);<br>FILE *(*orig_fopen)(const <span class="hljs-type">char</span> *filename, const <span class="hljs-type">char</span> *mode);<br><span class="hljs-keyword">static</span> <span class="hljs-title function_">long</span> <span class="hljs-params">(*orig_syscall)</span><span class="hljs-params">(<span class="hljs-type">long</span> number, ...)</span>;<br><span class="hljs-type">int</span> (*orig__NR_openat)(<span class="hljs-type">int</span>,const <span class="hljs-type">char</span> *pathname, <span class="hljs-type">int</span> flags, ...);<br><br><span class="hljs-keyword">void</span>* (*orig_dlopen_CI)(const <span class="hljs-type">char</span> *filename, <span class="hljs-type">int</span> flag);<br><span class="hljs-keyword">void</span>* (*orig_dlopen_CIV)(const <span class="hljs-type">char</span> *filename, <span class="hljs-type">int</span> flag, const <span class="hljs-keyword">void</span> *extinfo);<br><span class="hljs-keyword">void</span>* (*orig_dlopen_CIVV)(const <span class="hljs-type">char</span> *name, <span class="hljs-type">int</span> flags, const <span class="hljs-keyword">void</span> *extinfo, <span class="hljs-keyword">void</span> *caller_addr);<br><br><span class="hljs-keyword">static</span> inline bool <span class="hljs-title function_">needs_mode</span><span class="hljs-params">(<span class="hljs-type">int</span> flags)</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> ((flags &amp; O_CREAT) == O_CREAT) || ((flags &amp; O_TMPFILE) == O_TMPFILE);<br>}<br>bool <span class="hljs-title function_">startsWith</span><span class="hljs-params">(string str, string sub)</span>{<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> str.find(sub)==<span class="hljs-number">0</span>;<br>}<br><br>bool <span class="hljs-title function_">endsWith</span><span class="hljs-params">(string s,string sub)</span>{<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> s.rfind(sub)==(s.length()-sub.length());<br>}<br>bool <span class="hljs-title function_">isOrigAPK</span><span class="hljs-params">(string&nbsp;&nbsp;path)</span>{<br><br>&nbsp; &nbsp; <span class="hljs-keyword">if</span>(path==origpath){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>}<br><span class="hljs-comment">//è¯¥å‡½æ•°çš„åŠŸèƒ½æ˜¯åœ¨æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶è¿›è¡Œæ‹¦æˆªï¼Œå¹¶åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶å°†æ–‡ä»¶è·¯å¾„æ›¿æ¢ä¸ºå¦ä¸€ä¸ªè·¯å¾„</span><br><br><span class="hljs-comment">//fake_open å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</span><br><span class="hljs-comment">//pathnameï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ‰“å¼€çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</span><br><span class="hljs-comment">//flagsï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ï¼Œä¾‹å¦‚åªè¯»ã€åªå†™ã€è¯»å†™ç­‰ã€‚</span><br><span class="hljs-comment">//modeï¼ˆå¯é€‰å‚æ•°ï¼‰ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶æ—¶åº”ç”¨çš„æƒé™æ¨¡å¼ã€‚</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">fake_open</span><span class="hljs-params">(const <span class="hljs-type">char</span> *pathname, <span class="hljs-type">int</span> flags, ...)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">mode_t</span> <span class="hljs-variable">mode</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span> (needs_mode(flags)) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_list args;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_start(args, flags);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mode = static_cast&lt;mode_t&gt;(va_arg(args, <span class="hljs-type">int</span>));<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_end(args);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-comment">//LOGI("open,&nbsp;&nbsp;path: %s, flags: %d, mode: %d",pathname, flags ,mode);</span><br>&nbsp; &nbsp; string cpp_path= pathname;<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span>(isOrigAPK(cpp_path)){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;LOGI(<span class="hljs-string">"libc_open, redirect: %s, ---&gt;: %s"</span>,pathname, fakepath.data());<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> orig_open(<span class="hljs-string">"/data/user/0/com.zj.wuaipojie/files/base.apk"</span>, flags, mode);<br>    }<span class="hljs-comment">//è¿™é‡Œå·²ç»å°†æˆ‘ä»¬ioåçš„è·¯å¾„å†™æ­»ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å®ä¾‹ä¸­æ–°å»ºå¯¹åº”æ–‡ä»¶çš„åŸå› ã€‚</span><br>    &nbsp; <span class="hljs-keyword">return</span>&nbsp;&nbsp;orig_open(pathname, flags, mode);<br><br>}<br><br><span class="hljs-comment">//è¯¥å‡½æ•°çš„åŠŸèƒ½æ˜¯åœ¨æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶è¿›è¡Œæ‹¦æˆªï¼Œå¹¶åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶å°†æ–‡ä»¶è·¯å¾„æ›¿æ¢ä¸ºå¦ä¸€ä¸ªè·¯å¾„</span><br><br><span class="hljs-comment">//fake_openat å‡½æ•°æœ‰å››ä¸ªå‚æ•°ï¼š</span><br><span class="hljs-comment">//fdï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè¦æ‰“å¼€çš„æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</span><br><span class="hljs-comment">//pathnameï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ‰“å¼€çš„æ–‡ä»¶çš„è·¯å¾„ã€‚</span><br><span class="hljs-comment">//flagsï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ï¼Œä¾‹å¦‚åªè¯»ã€åªå†™ã€è¯»å†™ç­‰ã€‚</span><br><span class="hljs-comment">//modeï¼ˆå¯é€‰å‚æ•°ï¼‰ï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶æ—¶åº”ç”¨çš„æƒé™æ¨¡å¼ã€‚</span><br><span class="hljs-comment">//openat å‡½æ•°çš„ä½œç”¨ç±»ä¼¼äº open å‡½æ•°ï¼Œä½†æ˜¯å®ƒä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ–‡ä»¶è·¯å¾„æœ¬èº«ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥åœ¨æ‰“å¼€æ–‡ä»¶æ—¶ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè€Œä¸å¿…æä¾›å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="hljs-comment">//ä¾‹å¦‚ï¼Œå¦‚æœè¦æ‰“å¼€ç›¸å¯¹äºå½“å‰ç›®å½•çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ openat å‡½æ•°ï¼Œè€Œä¸æ˜¯ open å‡½æ•°ï¼Œå› ä¸º open å‡½æ•°åªèƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</span><br><span class="hljs-comment">//</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">fake_openat</span><span class="hljs-params">(<span class="hljs-type">int</span> fd, const <span class="hljs-type">char</span> *pathname, <span class="hljs-type">int</span> flags, ...)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">mode_t</span> <span class="hljs-variable">mode</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span> (needs_mode(flags)) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_list args;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_start(args, flags);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mode = static_cast&lt;mode_t&gt;(va_arg(args, <span class="hljs-type">int</span>));<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;va_end(args);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; LOGI(<span class="hljs-string">"openat, fd: %d, path: %s, flags: %d, mode: %d"</span>,fd ,pathname, flags ,mode);<br>&nbsp; &nbsp; string cpp_path= pathname;<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span>(isOrigAPK(cpp_path)){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;LOGI(<span class="hljs-string">"libc_openat, redirect: %s, ---&gt;: %s"</span>,pathname, fakepath.data());<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;&nbsp;orig_openat(fd,fakepath.data(), flags, mode);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> orig_openat(fd,pathname, flags, mode);<br><br>}<br>FILE *fake_fopen(const <span class="hljs-type">char</span> *filename, const <span class="hljs-type">char</span> *mode) {<br>&nbsp; &nbsp; string cpp_path= filename;<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span>(isOrigAPK(cpp_path)){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;&nbsp;orig_fopen(fakepath.data(), mode);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> orig_fopen(filename, mode);<br>}<br><span class="hljs-comment">//è¯¥å‡½æ•°çš„åŠŸèƒ½æ˜¯åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨æ—¶è¿›è¡Œæ‹¦æˆªï¼Œå¹¶åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶ä¿®æ”¹ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°ã€‚</span><br><span class="hljs-comment">//syscall å‡½æ•°æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œæ˜¯ç¨‹åºè®¿é—®å†…æ ¸åŠŸèƒ½çš„æ–¹æ³•ä¹‹ä¸€ã€‚ä½¿ç”¨ syscall å‡½æ•°å¯ä»¥è°ƒç”¨å¤§é‡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒä»¬ç”¨äºå®ç°æ“ä½œç³»ç»Ÿçš„å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚æ‰“å¼€æ–‡ä»¶ã€åˆ›å»ºè¿›ç¨‹ã€åˆ†é…å†…å­˜ç­‰ã€‚</span><br><span class="hljs-comment">//</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">fake_syscall</span><span class="hljs-params">(<span class="hljs-type">long</span> number, ...)</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">void</span> *arg[<span class="hljs-number">7</span>];<br>&nbsp; &nbsp; va_list list;<br><br>&nbsp; &nbsp; va_start(list, number);<br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">7</span>; ++i) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;arg[i] = va_arg(list, <span class="hljs-keyword">void</span> *);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; va_end(list);<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span> (number == __NR_openat){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;const <span class="hljs-type">char</span> *cpp_path = static_cast&lt;const <span class="hljs-type">char</span> *&gt;(arg[<span class="hljs-number">1</span>]);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;LOGI(<span class="hljs-string">"syscall __NR_openat, fd: %d, path: %s, flags: %d, mode: %d"</span>,arg[<span class="hljs-number">0</span>] ,arg[<span class="hljs-number">1</span>], arg[<span class="hljs-number">2</span>], arg[<span class="hljs-number">3</span>]);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (isOrigAPK(cpp_path)){<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;LOGI(<span class="hljs-string">"syscall __NR_openat, redirect: %s, ---&gt;: %s"</span>,arg[<span class="hljs-number">1</span>], fakepath.data());<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">return</span> orig_syscall(number,arg[<span class="hljs-number">0</span>], fakepath.data() ,arg[<span class="hljs-number">2</span>],arg[<span class="hljs-number">3</span>]);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> orig_syscall(number, arg[<span class="hljs-number">0</span>], arg[<span class="hljs-number">1</span>], arg[<span class="hljs-number">2</span>], arg[<span class="hljs-number">3</span>], arg[<span class="hljs-number">4</span>], arg[<span class="hljs-number">5</span>], arg[<span class="hljs-number">6</span>]);<br><br>}<br><br><span class="hljs-comment">//å‡½æ•°çš„åŠŸèƒ½æ˜¯è·å–å½“å‰åº”ç”¨çš„åŒ…åã€APK æ–‡ä»¶è·¯å¾„ä»¥åŠåº“æ–‡ä»¶è·¯å¾„ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ä¿å­˜åœ¨å…¨å±€å˜é‡ä¸­</span><br><span class="hljs-comment">//å‡½æ•°è°ƒç”¨ GetObjectClass å’Œ GetMethodID å‡½æ•°æ¥è·å– context å¯¹è±¡çš„ç±»å‹ä»¥åŠ getPackageName æ–¹æ³•çš„ IDã€‚ç„¶åï¼Œå‡½æ•°è°ƒç”¨ CallObjectMethod å‡½æ•°æ¥è°ƒç”¨ getPackageName æ–¹æ³•ï¼Œè·å–å½“å‰åº”ç”¨çš„åŒ…åã€‚æœ€åï¼Œå‡½æ•°ä½¿ç”¨ GetStringUTFChars å‡½æ•°å°†åŒ…åè½¬æ¢ä¸º C å­—ç¬¦ä¸²ï¼Œå¹¶å°†åŒ…åä¿å­˜åœ¨ packname å…¨å±€å˜é‡ä¸­</span><br><span class="hljs-comment">//æ¥ç€ï¼Œå‡½æ•°ä½¿ç”¨ fakepath å…¨å±€å˜é‡ä¿å­˜äº† /data/user/0/&lt;packname&gt;/files/base.apk è¿™æ ·çš„è·¯å¾„ï¼Œå…¶ä¸­ &lt;packname&gt; æ˜¯å½“å‰åº”ç”¨çš„åŒ…åã€‚</span><br><span class="hljs-comment">//ç„¶åï¼Œå‡½æ•°å†æ¬¡è°ƒç”¨ GetObjectClass å’Œ GetMethodID å‡½æ•°æ¥è·å– context å¯¹è±¡çš„ç±»å‹ä»¥åŠ getApplicationInfo æ–¹æ³•çš„ IDã€‚ç„¶åï¼Œå‡½æ•°è°ƒç”¨ CallObjectMethod å‡½æ•°æ¥è°ƒç”¨ getApplicationInfo æ–¹æ³•ï¼Œè·å–å½“å‰åº”ç”¨çš„ ApplicationInfo å¯¹è±¡ã€‚</span><br><span class="hljs-comment">//å®ƒå…ˆè°ƒç”¨ GetObjectClass å‡½æ•°è·å– ApplicationInfo å¯¹è±¡çš„ç±»å‹ï¼Œç„¶åè°ƒç”¨ GetFieldID å‡½æ•°è·å– sourceDir å­—æ®µçš„ IDã€‚æ¥ç€ï¼Œå‡½æ•°ä½¿ç”¨ GetObjectField å‡½æ•°è·å– sourceDir å­—æ®µçš„å€¼ï¼Œå¹¶ä½¿ç”¨ GetStringUTFChars å‡½æ•°å°†å…¶è½¬æ¢ä¸º C å­—ç¬¦ä¸²ã€‚æœ€åï¼Œå‡½æ•°å°† C å­—ç¬¦ä¸²ä¿å­˜åœ¨ origpath å…¨å±€å˜é‡ä¸­ï¼Œè¡¨ç¤ºå½“å‰åº”ç”¨çš„ APK æ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="hljs-comment">//æœ€åï¼Œå‡½æ•°ä½¿ç”¨ GetFieldID å’Œ GetObjectField å‡½æ•°è·å– nativeLibraryDir å­—æ®µçš„å€¼ï¼Œå¹¶ä½¿ç”¨ GetStringUTFChars å‡½æ•°å°†å…¶è½¬æ¢ä¸º C å­—ç¬¦ä¸²ã€‚å‡½æ•°æœ€åè°ƒç”¨ LOGI å‡½æ•°æ‰“å°åº“æ–‡ä»¶è·¯å¾„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å°†å…¶ä¿å­˜åœ¨å…¨å±€å˜é‡ä¸­ã€‚</span><br><br>extern <span class="hljs-string">"C"</span> JNIEXPORT <span class="hljs-keyword">void</span> JNICALL<br><span class="hljs-title function_">Java_com_zj_wuaipojie_util_SecurityUtil_hook</span><span class="hljs-params">(JNIEnv *env, jclass clazz, jobject context)</span> {<br>&nbsp; &nbsp; <span class="hljs-type">jclass</span> <span class="hljs-variable">conext_class</span> <span class="hljs-operator">=</span> env-&gt;GetObjectClass(context);<br>&nbsp; &nbsp; <span class="hljs-type">jmethodID</span> <span class="hljs-variable">methodId_pack</span> <span class="hljs-operator">=</span> env-&gt;GetMethodID(conext_class, <span class="hljs-string">"getPackageName"</span>,<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-string">"()Ljava/lang/String;"</span>);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">packname_js</span> <span class="hljs-operator">=</span> reinterpret_cast&lt;jstring&gt;(env-&gt;CallObjectMethod(context, methodId_pack));<br>&nbsp; &nbsp; const <span class="hljs-type">char</span> *pn = env-&gt;GetStringUTFChars(packname_js, <span class="hljs-number">0</span>);<br>&nbsp; &nbsp; packname = string(pn);<br><br>&nbsp; &nbsp; env-&gt;ReleaseStringUTFChars(packname_js, pn);<br>&nbsp; &nbsp; <span class="hljs-comment">//LOGI("packname: %s", packname.data());</span><br>&nbsp; &nbsp; fakepath= <span class="hljs-string">"/data/user/0/"</span>+ packname +<span class="hljs-string">"/files/base.apk"</span>;<br><br>&nbsp; &nbsp; <span class="hljs-type">jclass</span> <span class="hljs-variable">conext_class2</span> <span class="hljs-operator">=</span> env-&gt;GetObjectClass(context);<br>&nbsp; &nbsp; <span class="hljs-type">jmethodID</span> <span class="hljs-variable">methodId_pack2</span> <span class="hljs-operator">=</span> env-&gt;GetMethodID(conext_class2,<span class="hljs-string">"getApplicationInfo"</span>,<span class="hljs-string">"()Landroid/content/pm/ApplicationInfo;"</span>);<br>&nbsp; &nbsp; <span class="hljs-type">jobject</span> <span class="hljs-variable">application_info</span> <span class="hljs-operator">=</span> env-&gt;CallObjectMethod(context,methodId_pack2);<br>&nbsp; &nbsp; <span class="hljs-type">jclass</span> <span class="hljs-variable">pm_clazz</span> <span class="hljs-operator">=</span> env-&gt;GetObjectClass(application_info);<br><br>&nbsp; &nbsp; <span class="hljs-type">jfieldID</span> <span class="hljs-variable">package_info_id</span> <span class="hljs-operator">=</span> env-&gt;GetFieldID(pm_clazz,<span class="hljs-string">"sourceDir"</span>,<span class="hljs-string">"Ljava/lang/String;"</span>);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">sourceDir_js</span> <span class="hljs-operator">=</span> reinterpret_cast&lt;jstring&gt;(env-&gt;GetObjectField(application_info,package_info_id));<br>&nbsp; &nbsp; const <span class="hljs-type">char</span> *sourceDir = env-&gt;GetStringUTFChars(sourceDir_js, <span class="hljs-number">0</span>);<br>&nbsp; &nbsp; origpath = string(sourceDir);<br>&nbsp; &nbsp; LOGI(<span class="hljs-string">"sourceDir: %s"</span>, sourceDir);<br><br>&nbsp; &nbsp; <span class="hljs-type">jfieldID</span> <span class="hljs-variable">package_info_id2</span> <span class="hljs-operator">=</span> env-&gt;GetFieldID(pm_clazz,<span class="hljs-string">"nativeLibraryDir"</span>,<span class="hljs-string">"Ljava/lang/String;"</span>);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">nativeLibraryDir_js</span> <span class="hljs-operator">=</span> reinterpret_cast&lt;jstring&gt;(env-&gt;GetObjectField(application_info,package_info_id2));<br>&nbsp; &nbsp; const <span class="hljs-type">char</span> *nativeLibraryDir = env-&gt;GetStringUTFChars(nativeLibraryDir_js, <span class="hljs-number">0</span>);<br>&nbsp; &nbsp; LOGI(<span class="hljs-string">"nativeLibraryDir: %s"</span>, nativeLibraryDir);<br>&nbsp; &nbsp; <span class="hljs-comment">//LOGI("%s", "Start Hook");</span><br><br>&nbsp; &nbsp; <span class="hljs-comment">//å¯åŠ¨hook</span><br>&nbsp; &nbsp; <span class="hljs-keyword">void</span> *handle = dlopen(<span class="hljs-string">"libc.so"</span>,RTLD_NOW);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">pagesize</span> <span class="hljs-operator">=</span> sysconf(_SC_PAGE_SIZE);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">addr</span> <span class="hljs-operator">=</span> ((uintptr_t)dlsym(handle,<span class="hljs-string">"open"</span>) &amp; (-pagesize));<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">addr2</span> <span class="hljs-operator">=</span> ((uintptr_t)dlsym(handle,<span class="hljs-string">"openat"</span>) &amp; (-pagesize));<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">addr3</span> <span class="hljs-operator">=</span> ((uintptr_t)fopen) &amp; (-pagesize);<br>&nbsp; &nbsp; <span class="hljs-type">auto</span> <span class="hljs-variable">addr4</span> <span class="hljs-operator">=</span> ((uintptr_t)syscall) &amp; (-pagesize);<br><br>&nbsp; &nbsp; <span class="hljs-comment">//è§£é™¤éƒ¨åˆ†æœºå‹openè¢«ä¿æŠ¤</span><br>&nbsp; &nbsp; mprotect((<span class="hljs-keyword">void</span>*)addr, pagesize, PROT_READ | PROT_WRITE | PROT_EXEC);<br>&nbsp; &nbsp; mprotect((<span class="hljs-keyword">void</span>*)addr2, pagesize, PROT_READ | PROT_WRITE | PROT_EXEC);<br>&nbsp; &nbsp; mprotect((<span class="hljs-keyword">void</span>*)addr3, pagesize, PROT_READ | PROT_WRITE | PROT_EXEC);<br>&nbsp; &nbsp; mprotect((<span class="hljs-keyword">void</span>*)addr4, pagesize, PROT_READ | PROT_WRITE | PROT_EXEC);<br><br>&nbsp; &nbsp; DobbyHook((<span class="hljs-keyword">void</span> *)dlsym(handle,<span class="hljs-string">"open"</span>), (<span class="hljs-keyword">void</span> *)fake_open, (<span class="hljs-keyword">void</span> **)&amp;orig_open);<br>&nbsp; &nbsp; DobbyHook((<span class="hljs-keyword">void</span> *)dlsym(handle,<span class="hljs-string">"openat"</span>), (<span class="hljs-keyword">void</span> *)fake_openat, (<span class="hljs-keyword">void</span> **)&amp;orig_openat);<br>&nbsp; &nbsp; DobbyHook((<span class="hljs-keyword">void</span> *)fopen, (<span class="hljs-keyword">void</span> *)fake_fopen, (<span class="hljs-keyword">void</span>**)&amp;orig_fopen);<br>&nbsp; &nbsp; DobbyHook((<span class="hljs-keyword">void</span> *)syscall, (<span class="hljs-keyword">void</span> *)fake_syscall, (<span class="hljs-keyword">void</span> **)&amp;orig_syscall);<br>}<br><br></code></pre></td></tr></tbody></table></figure><figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs smali"> <br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<span class="hljs-built_in">&nbsp;sget-object </span>p10, <span class="hljs-class">Lcom/zj/wuaipojie/util/ContextUtils;</span>-&gt;INSTANCE:<span class="hljs-class">Lcom/zj/wuaipojie/util/ContextUtils;</span><br><br>&nbsp; &nbsp;<span class="hljs-built_in"> invoke-virtual </span>{p10}, <span class="hljs-class">Lcom/zj/wuaipojie/util/ContextUtils;</span>-&gt;getContext()<span class="hljs-class">Landroid/content/Context;</span><br><br>&nbsp; &nbsp;<span class="hljs-built_in"> move-result-object </span>p10<br><br>&nbsp; &nbsp;<span class="hljs-built_in"> invoke-static </span>{p10}, <span class="hljs-class">Lcom/zj/wuaipojie/util/SecurityUtil;</span>-&gt;hook(<span class="hljs-class">Landroid/content/Context;</span>)V<br></code></pre></td></tr></tbody></table></figure><h2 id="7-å…¶ä»–å¸¸è§æ ¡éªŒ"><a href="#7-å…¶ä»–å¸¸è§æ ¡éªŒ" class="headerlink" title="7.å…¶ä»–å¸¸è§æ ¡éªŒ"></a><strong>7.å…¶ä»–å¸¸è§æ ¡éªŒ</strong></h2><h3 id="rootæ£€æµ‹ï¼š"><a href="#rootæ£€æµ‹ï¼š" class="headerlink" title="rootæ£€æµ‹ï¼š"></a><strong>rootæ£€æµ‹ï¼š</strong></h3><p>ååˆ¶æ‰‹æ®µ</p><p>1.ç®—æ³•åŠ©æ‰‹ã€å¯¹è¯æ¡†å–æ¶ˆç­‰æ’ä»¶ä¸€é”®hook</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232142228.png"></p><p>2.åˆ†æå…·ä½“çš„æ£€æµ‹ä»£ç </p><p>3.åˆ©ç”¨IOé‡å®šå‘ä½¿æ–‡ä»¶ä¸å¯è¯»</p><p>4.ä¿®æ”¹Andoirdæºç ï¼Œå»é™¤å¸¸è§æŒ‡çº¹</p><figure class="highlight kotlin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"> å¤åˆ¶ä»£ç  éšè—ä»£ç <br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isDeviceRooted</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> checkRootMethod1() || checkRootMethod2() || checkRootMethod3()<br>}<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkRootMethod1</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">val</span> buildTags = android.os.Build.TAGS<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> buildTags != <span class="hljs-literal">null</span> &amp;&amp; buildTags.contains(<span class="hljs-string">"test-keys"</span>)<br>}<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkRootMethod2</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">val</span> paths = arrayOf(<span class="hljs-string">"/system/app/Superuser.apk"</span>, <span class="hljs-string">"/sbin/su"</span>, <span class="hljs-string">"/system/bin/su"</span>, <span class="hljs-string">"/system/xbin/su"</span>, <span class="hljs-string">"/data/local/xbin/su"</span>, <span class="hljs-string">"/data/local/bin/su"</span>, <span class="hljs-string">"/system/sd/xbin/su"</span>,<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-string">"/system/bin/failsafe/su"</span>, <span class="hljs-string">"/data/local/su"</span>, <span class="hljs-string">"/su/bin/su"</span>)<br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> (path <span class="hljs-keyword">in</span> paths) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (File(path).exists()) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>}<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkRootMethod3</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">var</span> process: Process? = <span class="hljs-literal">null</span><br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;process = Runtime.getRuntime().exec(arrayOf(<span class="hljs-string">"/system/xbin/which"</span>, <span class="hljs-string">"su"</span>))<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">val</span> bufferedReader = BufferedReader(InputStreamReader(process.inputStream))<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;bufferedReader.readLine() != <span class="hljs-literal">null</span><br>&nbsp; &nbsp; } <span class="hljs-keyword">catch</span> (t: Throwable) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-literal">false</span><br>&nbsp; &nbsp; } <span class="hljs-keyword">finally</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;process?.destroy()<br>&nbsp; &nbsp; }<br>}<br><br></code></pre></td></tr></tbody></table></figure><p>å®šä¹‰äº†ä¸€ä¸ª&nbsp;<code>isDeviceRooted()</code>&nbsp;å‡½æ•°ï¼Œè¯¥å‡½æ•°è°ƒç”¨äº†ä¸‰ä¸ªæ£€æµ‹ root çš„æ–¹æ³•ï¼š<code>checkRootMethod1()</code>ã€<code>checkRootMethod2()</code>&nbsp;å’Œ&nbsp;<code>checkRootMethod3()</code>ã€‚</p><p><code>checkRootMethod1()</code>&nbsp;æ–¹æ³•æ£€æŸ¥è®¾å¤‡çš„&nbsp;<code>build tags</code>&nbsp;æ˜¯å¦åŒ…å«&nbsp;<code>test-keys</code>ã€‚è¿™é€šå¸¸æ˜¯ç”¨äºæµ‹è¯•çš„è®¾å¤‡ï¼Œå› æ­¤å¦‚æœæ£€æµ‹åˆ°è¿™ä¸ªæ ‡è®°ï¼Œåˆ™å¯ä»¥è®¤ä¸ºè®¾å¤‡å·²è¢« rootã€‚</p><p><code>checkRootMethod2()</code>&nbsp;æ–¹æ³•æ£€æŸ¥è®¾å¤‡æ˜¯å¦å­˜åœ¨ä¸€äº›ç‰¹å®šçš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶é€šå¸¸è¢«ç”¨äºæ‰§è¡Œ root æ“ä½œã€‚å¦‚æœæ£€æµ‹åˆ°è¿™äº›æ–‡ä»¶ï¼Œåˆ™å¯ä»¥è®¤ä¸ºè®¾å¤‡å·²è¢« rootã€‚</p><p><code>checkRootMethod3()</code>&nbsp;æ–¹æ³•ä½¿ç”¨&nbsp;<code>Runtime.exec()</code>&nbsp;æ–¹æ³•æ¥æ‰§è¡Œ&nbsp;<code>which su</code>&nbsp;å‘½ä»¤ï¼Œç„¶åæ£€æŸ¥å‘½ä»¤çš„è¾“å‡ºæ˜¯å¦ä¸ä¸ºç©ºã€‚å¦‚æœè¾“å‡ºä¸ä¸ºç©ºï¼Œåˆ™å¯ä»¥è®¤ä¸ºè®¾å¤‡å·²è¢« rootã€‚</p><h3 id="æ¨¡æ‹Ÿå™¨æ£€æµ‹"><a href="#æ¨¡æ‹Ÿå™¨æ£€æµ‹" class="headerlink" title="æ¨¡æ‹Ÿå™¨æ£€æµ‹"></a><strong>æ¨¡æ‹Ÿå™¨æ£€æµ‹</strong></h3><figure class="highlight kotlin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEmulator</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> Build.FINGERPRINT.startsWith(<span class="hljs-string">"generic"</span>) || Build.FINGERPRINT.startsWith(<span class="hljs-string">"unknown"</span>) || Build.MODEL.contains(<span class="hljs-string">"google_sdk"</span>) Build.MODEL.contains(<span class="hljs-string">"Emulator"</span>) || Build.MODEL.contains(<span class="hljs-string">"Android SDK built for x86"</span>) || Build.MANUFACTURER.contains(<span class="hljs-string">"Genymotion"</span>) || Build.HOST.startsWith(<span class="hljs-string">"Build"</span>) || Build.PRODUCT == <span class="hljs-string">"google_sdk"</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br><br></code></pre></td></tr></tbody></table></figure><p>é€šè¿‡æ£€æµ‹ç³»ç»Ÿçš„&nbsp;<code>Build</code>&nbsp;å¯¹è±¡æ¥åˆ¤æ–­å½“å‰è®¾å¤‡æ˜¯å¦ä¸ºæ¨¡æ‹Ÿå™¨ã€‚å…·ä½“æ–¹æ³•æ˜¯æ£€æµ‹&nbsp;<code>Build.FINGERPRINT</code>&nbsp;å±æ€§æ˜¯å¦åŒ…å«å­—ç¬¦ä¸²&nbsp;<code>"generic"</code>ã€‚</p><p><a href="https://www.notion.so/04dbaf39091f42519b14decd2a87fde7?pvs=21">æ¨¡æ‹Ÿå™¨æ£€æµ‹å¯¹æŠ—</a></p><h3 id="åè°ƒè¯•æ£€æµ‹"><a href="#åè°ƒè¯•æ£€æµ‹" class="headerlink" title="åè°ƒè¯•æ£€æµ‹"></a><strong>åè°ƒè¯•æ£€æµ‹</strong></h3><p>å®‰å“ç³»ç»Ÿè‡ªå¸¦è°ƒè¯•æ£€æµ‹å‡½æ•°</p><figure class="highlight kotlin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkForDebugger</span><span class="hljs-params">()</span></span> {<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span> (Debug.isDebuggerConnected()) {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">// å¦‚æœè°ƒè¯•å™¨å·²è¿æ¥ï¼Œåˆ™ç»ˆæ­¢åº”ç”¨ç¨‹åº</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;System.exit(<span class="hljs-number">0</span>)<br>&nbsp; &nbsp; }<br>}<br></code></pre></td></tr></tbody></table></figure><p>debuggableå±æ€§</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">getAppCanDebug</span><span class="hljs-params">(Context context)</span><span class="hljs-comment">//ä¸Šä¸‹æ–‡å¯¹è±¡ä¸ºxxActivity.this</span><br>{<br>&nbsp; &nbsp; <span class="hljs-type">boolean</span> <span class="hljs-variable">isDebug</span> <span class="hljs-operator">=</span> context.getApplicationInfo() != <span class="hljs-literal">null</span> &amp;&amp;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;(context.getApplicationInfo().flags &amp; ApplicationInfo.FLAG_DEBUGGABLE) != <span class="hljs-number">0</span>;<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> isDebug;<br>}<br><br></code></pre></td></tr></tbody></table></figure><p>ptraceæ£€æµ‹</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">ptrace_protect</span><span class="hljs-params">()</span><span class="hljs-comment">//ptraceé™„åŠ è‡ªèº«çº¿ç¨‹ ä¼šå¯¼è‡´æ­¤è¿›ç¨‹TracerPid å˜ä¸ºçˆ¶è¿›ç¨‹çš„TracerPid å³zygote</span></span><br><span class="hljs-function"></span>{<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-built_in">ptrace</span>(PTRACE_TRACEME,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);;<span class="hljs-comment">//è¿”å›-1å³ä¸ºå·²ç»è¢«è°ƒè¯•</span><br>}<br></code></pre></td></tr></tbody></table></figure><p>æ¯ä¸ªè¿›ç¨‹åŒæ—¶åˆ»åªèƒ½è¢«1ä¸ªè°ƒè¯•è¿›ç¨‹ptrace&nbsp;&nbsp;ï¼Œä¸»åŠ¨ptraceæœ¬è¿›ç¨‹å¯ä»¥ä½¿å¾—å…¶ä»–è°ƒè¯•å™¨æ— æ³•è°ƒè¯•</p><p>è°ƒè¯•è¿›ç¨‹åæ£€æµ‹</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">SearchObjProcess</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>{<br>&nbsp; &nbsp; FILE* pfile=<span class="hljs-literal">NULL</span>;<br>&nbsp; &nbsp; <span class="hljs-type">char</span> buf[<span class="hljs-number">0x1000</span>]={<span class="hljs-number">0</span>};<br><br>&nbsp; &nbsp; pfile=<span class="hljs-built_in">popen</span>(<span class="hljs-string">"ps"</span>,<span class="hljs-string">"r"</span>);<br>&nbsp; &nbsp; <span class="hljs-keyword">if</span>(<span class="hljs-literal">NULL</span>==pfile)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment">//LOGA("SearchObjProcess popenæ‰“å¼€å‘½ä»¤å¤±è´¥!\n");</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-comment">// è·å–ç»“æœ</span><br>&nbsp; &nbsp; <span class="hljs-comment">//LOGA("popenæ–¹æ¡ˆ:\n");</span><br>&nbsp; &nbsp; <span class="hljs-keyword">while</span>(<span class="hljs-built_in">fgets</span>(buf,<span class="hljs-built_in">sizeof</span>(buf),pfile))<br>&nbsp; &nbsp; {<br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">char</span>* strA=<span class="hljs-literal">NULL</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">char</span>* strB=<span class="hljs-literal">NULL</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">char</span>* strC=<span class="hljs-literal">NULL</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-type">char</span>* strD=<span class="hljs-literal">NULL</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;strA=<span class="hljs-built_in">strstr</span>(buf,<span class="hljs-string">"android_server"</span>);<span class="hljs-comment">//é€šè¿‡æŸ¥æ‰¾åŒ¹é…å­ä¸²åˆ¤æ–­</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;strB=<span class="hljs-built_in">strstr</span>(buf,<span class="hljs-string">"gdbserver"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;strC=<span class="hljs-built_in">strstr</span>(buf,<span class="hljs-string">"gdb"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;strD=<span class="hljs-built_in">strstr</span>(buf,<span class="hljs-string">"fuwu"</span>);<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span>(strA || strB ||strC || strD)<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment">// æ‰§è¡Œåˆ°è¿™é‡Œï¼Œåˆ¤å®šä¸ºè°ƒè¯•çŠ¶æ€</span><br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <span class="hljs-built_in">pclose</span>(pfile);<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}<br></code></pre></td></tr></tbody></table></figure><p><a href="https://bbs.pediy.com/thread-268155.htm">[åŸåˆ›]å¯¹å®‰å“åè°ƒè¯•å’Œæ ¡éªŒæ£€æµ‹çš„ä¸€äº›å®è·µä¸ç»“è®º</a></p><h3 id="fridaæ£€æµ‹"><a href="#fridaæ£€æµ‹" class="headerlink" title="fridaæ£€æµ‹"></a><strong>fridaæ£€æµ‹</strong></h3><p><a href="https://github.com/xxr0ss/AntiFrida">ä¸€äº›Fridaæ£€æµ‹æ‰‹æ®µ</a></p><h2 id="8-smaliè¯­æ³•å°è¯¾å ‚ä¹‹èµ‹å€¼"><a href="#8-smaliè¯­æ³•å°è¯¾å ‚ä¹‹èµ‹å€¼" class="headerlink" title="8.smaliè¯­æ³•å°è¯¾å ‚ä¹‹èµ‹å€¼"></a><strong>8.smaliè¯­æ³•å°è¯¾å ‚ä¹‹èµ‹å€¼</strong></h2><h3 id="1-Intå‹èµ‹å€¼"><a href="#1-Intå‹èµ‹å€¼" class="headerlink" title="1.Intå‹èµ‹å€¼"></a><strong>1.Intå‹èµ‹å€¼</strong></h3><figure class="highlight smalltalk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs smalltalk"><br>.method private static final onCreate<span class="hljs-string">$l</span>ambda<span class="hljs-number">-0</span>(<span class="hljs-type">Lcom</span>/zj/wuaipojie/ui/<span class="hljs-type">SmaliLearn</span>;<span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;<span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;<span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;<span class="hljs-type">Landroid</span>/view/<span class="hljs-type">View</span>;)<span class="hljs-type">V</span><br>&nbsp; &nbsp; .registers <span class="hljs-number">9</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">21</span><br>&nbsp; &nbsp; invoke-virtual {p0}, <span class="hljs-type">Lcom</span>/zj/wuaipojie/ui/<span class="hljs-type">SmaliLearn</span>;-&gt;isVip()<span class="hljs-type">I</span><br><br>&nbsp; &nbsp; move-result p4<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;//åˆ¤æ–­vipçš„å€¼åˆ†åˆ«å¯¹åº”ä¸ç”¨çš„ä¼šå‘˜çš„ç­‰çº§<br>&nbsp; &nbsp; if-eqz p4, :cond_35<br><br>&nbsp; &nbsp; const/<span class="hljs-number">4</span> v0, <span class="hljs-number">0x1</span><br><br>&nbsp; &nbsp; if-eq p4, v0, :cond_2d<br><br>&nbsp; &nbsp; const/<span class="hljs-number">4</span> v0, <span class="hljs-number">0x4</span><br><br>&nbsp; &nbsp; if-eq p4, v0, :cond_25<br><br>&nbsp; &nbsp; const/<span class="hljs-number">16</span> v0, <span class="hljs-number">0x10</span><br><br>&nbsp; &nbsp; if-eq p4, v0, :cond_1d<br><br>&nbsp; &nbsp; const/<span class="hljs-number">16</span> v0, <span class="hljs-number">0x63</span><br><br>&nbsp; &nbsp; if-eq p4, v0, :cond_15<br><br>&nbsp; &nbsp; goto :goto_3c<br><br>&nbsp; &nbsp; :cond_15<br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"è‡³å°Šä¼šå‘˜"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">26</span><br>&nbsp; &nbsp; check-cast p4, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; goto :goto_3c<br><br>&nbsp; &nbsp; :cond_1d<br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"è¶…çº§ä¼šå‘˜"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">25</span><br>&nbsp; &nbsp; check-cast p4, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; goto :goto_3c<br><br>&nbsp; &nbsp; :cond_25<br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"å¤§ä¼šå‘˜"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">24</span><br>&nbsp; &nbsp; check-cast p4, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; goto :goto_3c<br><br>&nbsp; &nbsp; :cond_2d<br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"ä¼šå‘˜"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">23</span><br>&nbsp; &nbsp; check-cast p4, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; goto :goto_3c<br><br>&nbsp; &nbsp; :cond_35<br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"éä¼šå‘˜"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">22</span><br>&nbsp; &nbsp; check-cast p4, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;.line <span class="hljs-number">28</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;//åˆ¤æ–­vipEndTimeçš„æ—¶é—´æˆ³æ˜¯å¦å°äºç³»ç»Ÿæ—¶é—´<br>&nbsp; &nbsp; :goto_3c<br>&nbsp; &nbsp; new-instance p1, <span class="hljs-type">Ljava</span>/util/<span class="hljs-type">Date</span>;<br><br>&nbsp; &nbsp; invoke-direct {p1}, <span class="hljs-type">Ljava</span>/util/<span class="hljs-type">Date</span>;-&gt;&lt;init&gt;()<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; invoke-virtual {p1}, <span class="hljs-type">Ljava</span>/util/<span class="hljs-type">Date</span>;-&gt;getTime()<span class="hljs-type">J</span><br><br>&nbsp; &nbsp; move-result-wide v0<br><br>&nbsp; &nbsp; .line <span class="hljs-number">29</span><br>&nbsp; &nbsp; new-instance p1, <span class="hljs-type">Ljava</span>/text/<span class="hljs-type">SimpleDateFormat</span>;<br><br>&nbsp; &nbsp; const-string p4, <span class="hljs-comment">"yyyy-MM-dd"</span><br><br>&nbsp; &nbsp; invoke-direct {p1, p4}, <span class="hljs-type">Ljava</span>/text/<span class="hljs-type">SimpleDateFormat</span>;-&gt;&lt;init&gt;(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">String</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">30</span><br>&nbsp; &nbsp; invoke-virtual {p0}, <span class="hljs-type">Lcom</span>/zj/wuaipojie/ui/<span class="hljs-type">SmaliLearn</span>;-&gt;vipEndTime()<span class="hljs-type">J</span><br><br>&nbsp; &nbsp; move-result-wide v2<br><br>&nbsp; &nbsp; cmp-long p4, v2, v0<br><br>&nbsp; &nbsp; if-gez p4, :cond_5c<br><br>&nbsp; &nbsp; const-string p1, <span class="hljs-comment">"å·²è¿‡æœŸ"</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">31</span><br>&nbsp; &nbsp; check-cast p1, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p2, p1}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; goto :goto_6d<br><br>&nbsp; &nbsp; .line <span class="hljs-number">33</span><br>&nbsp; &nbsp; :cond_5c<br>&nbsp; &nbsp; invoke-virtual {p0}, <span class="hljs-type">Lcom</span>/zj/wuaipojie/ui/<span class="hljs-type">SmaliLearn</span>;-&gt;vipEndTime()<span class="hljs-type">J</span><br><br>&nbsp; &nbsp; move-result-wide v0<br><br>&nbsp; &nbsp; invoke-static {v0, v1}, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">Long</span>;-&gt;valueOf(<span class="hljs-type">J</span>)<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">Long</span>;<br><br>&nbsp; &nbsp; move-result-object p4<br><br>&nbsp; &nbsp; invoke-virtual {p1, p4}, <span class="hljs-type">Ljava</span>/text/<span class="hljs-type">SimpleDateFormat</span>;-&gt;format(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">Object</span>;)<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">String</span>;<br><br>&nbsp; &nbsp; move-result-object p1<br><br>&nbsp; &nbsp; check-cast p1, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p2, p1}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; .line <span class="hljs-number">35</span><br>&nbsp; &nbsp; :goto_6d<br>&nbsp; &nbsp; iget p0, p0, <span class="hljs-type">Lcom</span>/zj/wuaipojie/ui/<span class="hljs-type">SmaliLearn</span>;-&gt;vip_coin:<span class="hljs-type">I</span><br><br>&nbsp; &nbsp; if-eqz p0, :cond_74<br><br>&nbsp; &nbsp; .line <span class="hljs-number">36</span><br>&nbsp; &nbsp; invoke-static {p0}, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">String</span>;-&gt;valueOf(<span class="hljs-type">I</span>)<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">String</span>;<br><br>&nbsp; &nbsp; move-result-object p0<br><br>&nbsp; &nbsp; check-cast p0, <span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;<br><br>&nbsp; &nbsp; invoke-virtual {p3, p0}, <span class="hljs-type">Landroid</span>/widget/<span class="hljs-type">TextView</span>;-&gt;setText(<span class="hljs-type">Ljava</span>/lang/<span class="hljs-type">CharSequence</span>;)<span class="hljs-type">V</span><br><br>&nbsp; &nbsp; :cond_74<br>&nbsp; &nbsp; return-void<br>.end method<br></code></pre></td></tr></tbody></table></figure><p>const/4å’Œconst/16çš„åŒºåˆ«ï¼Ÿ</p><p>const/4 æœ€å¤§åªå…è®¸å­˜æ”¾4ä¸ªäºŒè¿›åˆ¶ä½(4bit)ï¼Œ</p><p>const/16 æœ€å¤§å€¼å…è®¸å­˜æ”¾16ä¸ªäºŒè¿›åˆ¶ä½(16bit)ï¼Œ ç¬¬ä¸€ä½(å³æœ€é«˜ä½)é»˜è®¤ä¸ºç¬¦å·ä½ã€‚å•ä½æ¢ç®— 1byte=8bit</p><p>ä¸¾ä¾‹è¯´æ˜ä¸‹å¯„å­˜å™¨çš„å–å€¼èŒƒå›´: # ä»¥ä¸‹æ•°æ®å®šä¹‰é«˜ä½é»˜è®¤ä¸ºç¬¦å·ä½</p><p>const/4 v0,0x2 # æœ€å¤§åªå…è®¸å­˜æ”¾åŠå­—èŠ‚æ•°æ® å–å€¼èŒƒå›´ä¸º -8 and 7</p><p>const/16 v0 , 0xABCD # å®šä¹‰ä¸€ä¸ªå¯„å­˜å™¨å˜é‡ï¼Œæœ€å¤§åªå…è®¸å­˜æ”¾16ä½æ•°æ® æ¯”å¦‚shortç±»å‹æ•°æ® å–å€¼èŒƒå›´ä¸º-32768~32767</p><p>const v0 , 0xA# å®šä¹‰ä¸€ä¸ªå¯„å­˜å™¨ï¼Œ æœ€å¤§åªå…è®¸å­˜æ”¾32ä½æ•°æ®,æ¯”å¦‚intç±»å‹æ•°æ® å°†æ•°å­—10èµ‹å€¼ç»™v0 å–å€¼èŒƒå›´-2147483647~2147483647</p><p>const/high16 #å®šä¹‰ä¸€ä¸ªå¯„å­˜å™¨ï¼Œ æœ€å¤§åªå…è®¸å­˜æ”¾é«˜16ä½æ•°å€¼ æ¯”å¦‚0xFFFF0000æœ«å››ä½è¡¥0 å­˜å…¥é«˜å››ä½0XFFFF</p><h3 id="2-Longå‹èµ‹å€¼"><a href="#2-Longå‹èµ‹å€¼" class="headerlink" title="2.Longå‹èµ‹å€¼"></a><strong>2.Longå‹èµ‹å€¼</strong></h3><p><strong>const-wide vx, lit32</strong>&nbsp;è¡¨ç¤ºå°†ä¸€ä¸ª 32 ä½çš„å¸¸é‡å­˜å‚¨åˆ° vx ä¸ vx+1 ä¸¤ä¸ªå¯„å­˜å™¨ä¸­ â€”â€” å³ä¸€ä¸ª long ç±»å‹çš„æ•°æ®</p><figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs smali"><br><span class="hljs-keyword">.method</span><span class="hljs-keyword"> public</span><span class="hljs-keyword"> final</span> vipEndTime()J<br>&nbsp; &nbsp; .registers 3<br><br>&nbsp; &nbsp;<span class="hljs-built_in"> const-wide </span>v0, 0x1854460ef29L<br><br>&nbsp; &nbsp;<span class="hljs-built_in"> return-wide </span>v0<span class="hljs-keyword"></span><br><span class="hljs-keyword">.end method</span><br><br></code></pre></td></tr></tbody></table></figure><p>ä¼šå‘˜åˆ°æœŸæ—¶é—´å°±æ˜¯2022å¹´12æœˆ24æ—¥ã€‚é‚£ä¹ˆ1854460ef29L æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿä¹Ÿå°±æ˜¯ï¼ˆ2022å¹´12æœˆ24æ—¥-1970å¹´1æœˆ1æ—¥ï¼‰Ã—365å¤©Ã—24å°æ—¶Ã—60åˆ†é’ŸÃ—60ç§’Ã—1000æ¯«ç§’ï¼Œè½¬æ¢æˆ16è¿›åˆ¶å°±å¤§æ¦‚æ˜¯é‚£ä¸ªæ•°äº†</p><p><a href="https://www.beijing-time.org/shijianchuo/">åœ¨çº¿æ—¶é—´æˆ³è½¬æ¢</a></p><h3 id="3-å˜é‡èµ‹å€¼-æ­£åˆ™"><a href="#3-å˜é‡èµ‹å€¼-æ­£åˆ™" class="headerlink" title="3.å˜é‡èµ‹å€¼(æ­£åˆ™)"></a><strong>3.å˜é‡èµ‹å€¼(æ­£åˆ™)</strong></h3><figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs smali"><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<span class="hljs-built_in">&nbsp;iget </span>p0, p0, <span class="hljs-class">Lcom/zj/wuaipojie/ui/SmaliLearn;</span>-&gt;vip_coin:I<br><br>&nbsp; &nbsp;<span class="hljs-built_in"> if-eqz </span>p0,<span class="hljs-keyword"> :cond_74</span><br><br>&nbsp; &nbsp; .line 36<br>&nbsp; &nbsp;<span class="hljs-built_in"> invoke-static </span>{p0}, <span class="hljs-class">Ljava/lang/String;</span>-&gt;valueOf(I)<span class="hljs-class">Ljava/lang/String;</span><br><br>&nbsp; &nbsp;<span class="hljs-built_in"> move-result-object </span>p0<br><br>&nbsp; &nbsp;<span class="hljs-built_in"> check-cast </span>p0, <span class="hljs-class">Ljava/lang/CharSequence;</span><br><br>&nbsp; &nbsp;<span class="hljs-built_in"> invoke-virtual </span>{p3, p0}, <span class="hljs-class">Landroid/widget/TextView;</span>-&gt;setText(<span class="hljs-class">Ljava/lang/CharSequence;</span>)<br></code></pre></td></tr></tbody></table></figure><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232142255.png"></p><figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">(.*) .*<span class="hljs-built_in"></span><br><span class="hljs-built_in">const/4 </span>$1 0x1  //æ›¿æ¢<br></code></pre></td></tr></tbody></table></figure>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç­¾åæ ¡éªŒ</tag>
      
      <tag>smali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jebåŠ¨æ€è°ƒè¯•ï¼ŒLogæ’æ¡©</title>
    <link href="/2025/03/23/ZJ5/jeb%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%EF%BC%8CLog%E6%8F%92%E6%A1%A9%201b1a6f4b4daf80a68a87f1bcc2c5232d/"/>
    <url>/2025/03/23/ZJ5/jeb%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%EF%BC%8CLog%E6%8F%92%E6%A1%A9%201b1a6f4b4daf80a68a87f1bcc2c5232d/</url>
    
    <content type="html"><![CDATA[<h1 id="jebåŠ¨æ€è°ƒè¯•ï¼ŒLogæ’æ¡©"><a href="#jebåŠ¨æ€è°ƒè¯•ï¼ŒLogæ’æ¡©" class="headerlink" title="jebåŠ¨æ€è°ƒè¯•ï¼ŒLogæ’æ¡©"></a>jebåŠ¨æ€è°ƒè¯•ï¼ŒLogæ’æ¡©</h1><h2 id="1-ä»€ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•"><a href="#1-ä»€ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•" class="headerlink" title="1.ä»€ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•"></a><strong>1.ä»€ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•</strong></h2><p>åŠ¨æ€è°ƒè¯•æ˜¯æŒ‡è‡ªå¸¦çš„è°ƒè¯•å™¨è·Ÿè¸ªè‡ªå·±è½¯ä»¶çš„è¿è¡Œï¼Œå¯ä»¥åœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­çŸ¥é“å‚æ•°æˆ–è€…å±€éƒ¨å˜é‡çš„å€¼ä»¥åŠå±¥æ¸…ä»£ç è¿è¡Œçš„å…ˆåé¡ºåºã€‚å¤šç”¨äºçˆ†ç ´æ³¨å†Œç ã€‚ä¸é™æ€åˆ†æï¼ˆç›´æ¥é˜…è¯»åç¼–è¯‘çš„ä»£ç ï¼‰ä¸åŒï¼ŒåŠ¨æ€è°ƒè¯•å…è®¸å®æ—¶ç›‘æ§å†…å­˜ã€å¯„å­˜å™¨ã€å˜é‡å€¼å’Œæ‰§è¡Œæµç¨‹ï¼Œå°¤å…¶é€‚åˆåˆ†æå¤æ‚é€»è¾‘æˆ–åŠ å¯†/æ··æ·†åçš„ä»£ç ã€‚</p><ul><li><p><strong>åŠ¨æ€è°ƒè¯• vs é™æ€åˆ†æ</strong></p><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>åŠ¨æ€è°ƒè¯•</strong></th><th><strong>é™æ€åˆ†æ</strong></th></tr></thead><tbody><tr><td><strong>æ‰§è¡ŒçŠ¶æ€</strong></td><td>ç¨‹åºæ­£åœ¨è¿è¡Œ</td><td>ç¨‹åºæœªè¿è¡Œï¼Œä»…åˆ†æä»£ç æ–‡ä»¶</td></tr><tr><td><strong>ä¼˜åŠ¿</strong></td><td>è§‚å¯Ÿå®æ—¶æ•°æ®æµã€å†…å­˜å˜åŒ–ï¼Œç»•è¿‡éƒ¨åˆ†åé€†å‘æŠ€æœ¯</td><td>å…¨é¢æŸ¥çœ‹ä»£ç ç»“æ„ï¼Œæ— æ‰§è¡Œç¯å¢ƒä¾èµ–</td></tr><tr><td><strong>åŠ£åŠ¿</strong></td><td>éœ€å¤„ç†åè°ƒè¯•æœºåˆ¶ï¼Œä¾èµ–è¿è¡Œç¯å¢ƒ</td><td>æ— æ³•è¿½è¸ªè¿è¡Œæ—¶çŠ¶æ€ï¼Œéš¾ä»¥åˆ†æåŠ¨æ€é€»è¾‘</td></tr><tr><td><strong>å…¸å‹å·¥å…·</strong></td><td>GDBã€LLDBã€IDA Proã€Fridaã€Android Studio</td><td>JADXã€Ghidraã€IDA Proã€Binary Ninja</td></tr></tbody></table></li></ul><h2 id="2-åŠ¨æ€è°ƒè¯•æ­¥éª¤"><a href="#2-åŠ¨æ€è°ƒè¯•æ­¥éª¤" class="headerlink" title="2.åŠ¨æ€è°ƒè¯•æ­¥éª¤"></a><strong>2.åŠ¨æ€è°ƒè¯•æ­¥éª¤</strong></h2><h3 id="1-ä¿®æ”¹debugæƒé™"><a href="#1-ä¿®æ”¹debugæƒé™" class="headerlink" title="1.ä¿®æ”¹debugæƒé™"></a><strong>1.ä¿®æ”¹debugæƒé™</strong></h3><p>æ–¹æ³•ä¸€:åœ¨AndroidManifest.xmlé‡Œæ·»åŠ å¯è°ƒè¯•æƒé™</p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">android:debuggable="true"<br></code></pre></td></tr></tbody></table></figure><ul><li><p>ç¤ºä¾‹</p><p>  1.å…ˆæå–å®‰è£…åŒ…è¿›è¡Œåç»­ä¿®æ”¹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232115640.png"></p><p>  2.å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232115589.png"></p><p>  3.å°†æƒé™æ·»åŠ åœ¨<code>application</code>ä¸­</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232115786.png"></p><p>  4.é‡æ–°å®‰è£…å®Œæˆåå³å¯å¾—åˆ°ä¸€ä¸ªå¯ä»¥è°ƒè¯•çš„å®‰è£…åŒ…ã€‚</p></li></ul><p>æ–¹æ³•äºŒï¼šXappDebugæ¨¡å—hookå¯¹åº”çš„app</p><p>é¡¹ç›®åœ°å€</p><p><a href="https://github.com/Palatis/XAppDebug">XappDebug</a></p><p>æ–¹æ³•ä¸‰ï¼šMagiskå‘½ä»¤(é‡å¯å¤±æ•ˆ)</p><figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span>&nbsp;&nbsp;adb shell #adbè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br><br><span class="hljs-bullet">2.</span>&nbsp;&nbsp;su #åˆ‡æ¢è‡³è¶…çº§ç”¨æˆ·<br><br><span class="hljs-bullet">3.</span>&nbsp;&nbsp;magisk resetprop ro.debuggable 1<br><br><span class="hljs-bullet">4.</span>&nbsp;&nbsp;stop;start; #ä¸€å®šè¦é€šè¿‡è¯¥æ–¹å¼é‡å¯<br></code></pre></td></tr></tbody></table></figure><p>æ–¹æ³•å››:åˆ·å…¥MagiskHide Props Configæ¨¡å—</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨4é€‰é¡¹ä¸­å¦‚æœæœ‰ro.debuggableé‚£å°±ç›´æ¥ä¿®æ”¹</p><p>æ²¡æœ‰çš„è¯å°±é€‰5</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232115387.png"></p><p>ä¿®æ”¹ro.debuggableçš„å€¼ä¸º1</p><h3 id="2-ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™"><a href="#2-ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™" class="headerlink" title="2.ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™"></a><strong>2.ç«¯å£è½¬å‘ä»¥åŠå¼€å¯adbæƒé™</strong></h3><p>ç‰ˆæœ¬å·ç‚¹å‡»ä¸ƒæ¬¡å¼€å¯å¼€å‘è€…æ¨¡å¼å¹¶å¼€å¯adbè°ƒè¯•æƒé™</p><p>å¤œç¥æ¨¡æ‹Ÿå™¨ï¼šadb connect 127.0.0.1:62001ï¼ˆé›·ç”µæ¨¡æ‹Ÿå™¨è‡ªå¸¦ç«¯å£è½¬å‘ï¼‰</p><h3 id="3-ä¸‹æ®µç‚¹"><a href="#3-ä¸‹æ®µç‚¹" class="headerlink" title="3.ä¸‹æ®µç‚¹"></a><strong>3.ä¸‹æ®µç‚¹</strong></h3><p>ctrl+bä¸‹æ–­ç‚¹</p><h3 id="4-debugæ¨¡å¼å¯åŠ¨"><a href="#4-debugæ¨¡å¼å¯åŠ¨" class="headerlink" title="4.debugæ¨¡å¼å¯åŠ¨"></a><strong>4.debugæ¨¡å¼å¯åŠ¨</strong></h3><figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> start -D -n <span class="hljs-keyword">com</span>.zj.wuaipojie/.ui.MainActivity<br></code></pre></td></tr></tbody></table></figure><p>adb shell am start -D -n</p><p>adb shell am start -D -n åŒ…å/ç±»å</p><p>am start -n è¡¨ç¤ºå¯åŠ¨ä¸€ä¸ªactivity</p><p>am start -D è¡¨ç¤ºå°†åº”ç”¨è®¾ç½®ä¸ºå¯è°ƒè¯•æ¨¡å¼</p><p><a href="https://blog.csdn.net/jinmie0193/article/details/111355867">Androidä¿®æ”¹ro.debuggable çš„å››ç§æ–¹æ³•-CSDNåšå®¢</a></p><h3 id="5-Jebé™„åŠ è°ƒè¯•è¿›ç¨‹"><a href="#5-Jebé™„åŠ è°ƒè¯•è¿›ç¨‹" class="headerlink" title="5.Jebé™„åŠ è°ƒè¯•è¿›ç¨‹"></a><strong>5.Jebé™„åŠ è°ƒè¯•è¿›ç¨‹</strong></h3><p>æ¿€æ´»jeb</p><p>åœ¨çº¿pythonè¿è¡Œ</p><p><a href="https://tool.lu/coderunner/">https://tool.lu/coderunner/</a></p><ul><li><p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><p>  1.æŸ¥è¯¢åˆ°ç›¸å…³ä½ç½®</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232116197.png"></p><p>  2.å°†å†…å®¹ç¼–è¯‘ä¸ºJAVAçš„å½¢å¼è¿›è¡Œåˆ†æ</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232116068.png"></p><p>  3.é€šè¿‡åˆæ­¥åˆ†æåˆ¤æ–­å…³é”®ç‚¹åœ¨<code>chek()</code>æ–¹æ³•å¯¹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œäº†æ€æ ·çš„åˆ¤æ–­ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232116137.png"></p><p>  4.åŒå‡»è¿›å…¥åˆ°<code>chek()</code>ä»£ç ï¼Œå‘ç°å®ƒæ˜¯ä¸€ä¸ªç»è¿‡ä¸€ä¸²è¿ç®—åè¿›è¡Œbase64ç¼–ç ä¸å­—ç¬¦è¿›è¡Œå¯¹æ¯”</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232116429.png"></p><p>  5.æŸ¥æ‰¾åˆ°å…³é”®ä¸­é—´å­—ç¬¦çš„ä»£ç è¿›è¡Œä¸‹æ–­ç‚¹ï¼ˆCtrl+bï¼‰</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232116510.png"></p><p>  6.ä½¿ç”¨debugå¯åŠ¨è¯¥è½¯ä»¶ï¼Œä¾æ¬¡è·å–åŒ…åå’Œå¯åŠ¨ç±»å</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232117031.png"></p><p>  å»æ‰åŒ…åçš„éƒ¨åˆ†ï¼Œåè¾¹çš„ä¸€ä¸²å±äºæ˜¯è¦å¡«å†™çš„ç±»å</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232117489.png"></p><p>  7.å¯åŠ¨åè¿”å›ç•Œé¢å‡ºç°ä¸‹åˆ—æç¤ºè¯´æ˜å·²æ­£å¸¸è¿è¡Œdebugæ¨¡å¼</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232117217.png"></p><p>  8.ä½¿ç”¨jebå¯¹ä¸‹æ–­ç‚¹çš„åœ°æ–¹è¿›è¡Œè°ƒè¯•ï¼Œæˆ‘ä»¬æ£€æŸ¥è°ƒè¯•ç«¯å£å’ŒæŠ¥åå¯¹åº”æ­£ç¡®ä¸”è¿›ç¨‹å­˜åœ¨ï¼Œç‚¹å‡»<strong>é™„ä¸Š</strong></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503232117764.png"></p><ol start="9"><li></li></ol></li></ul><p>ç®—å·ä»£ç ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"> å¤åˆ¶ä»£ç  éšè—ä»£ç <br><span class="hljs-comment">#https://bbs.pediy.com/</span><br><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-keyword">import</span> os, sys, struct, time, binascii, hashlib<br><br>RC4_Key2= <span class="hljs-string">'Eg\xa2\x99_\x83\xf1\x10'</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">Key, inData</span>):<br>&nbsp; &nbsp; Buf = <span class="hljs-string">""</span><br>&nbsp; &nbsp; S = <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)<br>&nbsp; &nbsp; K = (<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x:<span class="hljs-built_in">ord</span>(x), Key) * (<span class="hljs-number">256</span> / <span class="hljs-built_in">len</span>(Key) + <span class="hljs-number">1</span>))[:<span class="hljs-number">256</span>]<br>&nbsp; &nbsp; j = <span class="hljs-number">0</span><br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;j = (S[i] + K[i] + j) % <span class="hljs-number">256</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;S[i], S[j] = S[j], S[i]<br>&nbsp; &nbsp; i, j = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>&nbsp; &nbsp; <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inData)):<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;j = (j + S[i]) % <span class="hljs-number">256</span><br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;S[i], S[j] = S[j], S[i]<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Buf += <span class="hljs-built_in">chr</span>(S[(S[j] + S[i]) % <span class="hljs-number">256</span>] ^ <span class="hljs-built_in">ord</span>(inData[x]))<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> Buf<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Long2Int</span>(<span class="hljs-params">longdata</span>):<br>&nbsp; &nbsp; lo = longdata &amp; <span class="hljs-number">0xFFFFFFFF</span><br>&nbsp; &nbsp; hi = (longdata &gt;&gt; <span class="hljs-number">32</span>) &amp; <span class="hljs-number">0x7FFFFFFF</span><br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> hi, lo<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KeygenSN</span>(<span class="hljs-params">LicenseSerial, MachineID</span>):<br>&nbsp; &nbsp; mhi, mlo = Long2Int(MachineID)<br>&nbsp; &nbsp; lhi, llo = Long2Int(LicenseSerial)<br>&nbsp; &nbsp; hi_Key = (mhi - lhi + <span class="hljs-number">0x55667788</span>) &amp; <span class="hljs-number">0x7FFFFFFF</span><br>&nbsp; &nbsp; lo_Key = (mlo + llo + <span class="hljs-number">0x11223344</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>&nbsp; &nbsp; Z0, = struct.unpack(<span class="hljs-string">'&lt;Q'</span>, struct.pack(<span class="hljs-string">'&lt;LL'</span>, lo_Key, hi_Key))<br>&nbsp; &nbsp; Z1 = <span class="hljs-built_in">int</span>(time.time()) ^ <span class="hljs-number">0x56739ACD</span><br>&nbsp; &nbsp; s = <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x:<span class="hljs-built_in">int</span>(x, <span class="hljs-number">16</span>), <span class="hljs-string">"%x"</span> % Z1)) % <span class="hljs-number">10</span><br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-string">"%dZ%d%d"</span> % (Z0, Z1, s)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ParsePost</span>(<span class="hljs-params">buf</span>):<br>&nbsp; &nbsp; Info = struct.unpack(<span class="hljs-string">'&lt;3L2Q4LQ3L'</span>, buf[:<span class="hljs-number">0x40</span>])<br>&nbsp; &nbsp; flag, CRC, UserSerial, LicenseSerial, MachineID, build_type, \<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; Ver_Major, Ver_Minor, Ver_Buildid, Ver_Timestamp, \<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; TimeOffset, Kclass, Random2 = Info<br>&nbsp; &nbsp; SysInfoData = buf[<span class="hljs-number">0x40</span>:]<br>&nbsp; &nbsp; <span class="hljs-keyword">assert</span> CRC == binascii.crc32(buf[<span class="hljs-number">8</span>:]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> Info, SysInfoData<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">DecodeRc4Str</span>(<span class="hljs-params">buf</span>):<br>&nbsp; &nbsp; buf = buf.decode(<span class="hljs-string">'hex'</span>)<br>&nbsp; &nbsp; i, s = ParsePost(rc4(buf[:<span class="hljs-number">8</span>] + RC4_Key2, buf[<span class="hljs-number">8</span>:]))<br>&nbsp; &nbsp; <span class="hljs-keyword">return</span> i, s<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GetJebLicenseKey</span>():<br>&nbsp; &nbsp; licdata = <span class="hljs-string">""</span><br>&nbsp; &nbsp; <span class="hljs-keyword">if</span> licdata:<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;i, MachineID = DecodeRc4Str(licdata)<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;SN = KeygenSN(i[<span class="hljs-number">3</span>], i[<span class="hljs-number">4</span>])<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span> <span class="hljs-string">"JEB License Key:"</span>, SN<br>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> SN<br><br>GetJebLicenseKey()<br>raw_input(<span class="hljs-string">"Enter to Exit..."</span>)<br><br></code></pre></td></tr></tbody></table></figure><p>å¿«æ·é”®ï¼š</p><p>^F6è¿›å…¥æ–¹æ³•</p><p>F6è·³è¿‡æ–¹æ³•</p><p>F7ä»æ–¹æ³•ä¸­è·³å‡ºæ¥</p><p>Rè¿è¡Œåˆ°å…‰æ ‡å¤„</p><h3 id="3-Logæ’æ¡©"><a href="#3-Logæ’æ¡©" class="headerlink" title="3.Logæ’æ¡©"></a><strong>3.Logæ’æ¡©</strong></h3><p>å®šä¹‰ï¼šLogæ’æ¡©æŒ‡çš„æ˜¯åç¼–è¯‘APKæ–‡ä»¶æ—¶ï¼Œåœ¨å¯¹åº”çš„smaliæ–‡ä»¶é‡Œï¼Œæ·»åŠ ç›¸åº”çš„smaliä»£ç ï¼Œå°†ç¨‹åºä¸­çš„å…³é”®ä¿¡æ¯ï¼Œä»¥logæ—¥å¿—çš„å½¢å¼è¿›è¡Œè¾“å‡ºã€‚</p><p>è°ƒç”¨å‘½ä»¤</p><figure class="highlight smali"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs smali"> å¤åˆ¶ä»£ç  éšè—ä»£ç <br><span class="hljs-built_in"></span><br><span class="hljs-built_in">invoke-static </span>{å¯¹åº”å¯„å­˜å™¨}, <span class="hljs-class">Lcom/mtools/LogUtils;</span>-&gt;v(<span class="hljs-class">Ljava/lang/Object;</span>)V<br></code></pre></td></tr></tbody></table></figure>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ¨æ€è°ƒè¯•</tag>
      
      <tag>jeb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼¹çª—å®šä½å»æ›´æ–°ï¼Œå¹¿å‘Šåˆ†æä¸å¸ƒå±€ä¼˜åŒ–</title>
    <link href="/2025/03/23/ZJ4/%E5%BC%B9%E7%AA%97%E5%AE%9A%E4%BD%8D%E5%8E%BB%E6%9B%B4%E6%96%B0%EF%BC%8C%E5%B9%BF%E5%91%8A%E5%88%86%E6%9E%90%E4%B8%8E%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96%201b0a6f4b4daf80019ef2e0767f50ce0e/"/>
    <url>/2025/03/23/ZJ4/%E5%BC%B9%E7%AA%97%E5%AE%9A%E4%BD%8D%E5%8E%BB%E6%9B%B4%E6%96%B0%EF%BC%8C%E5%B9%BF%E5%91%8A%E5%88%86%E6%9E%90%E4%B8%8E%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96%201b0a6f4b4daf80019ef2e0767f50ce0e/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼¹çª—å®šä½å»æ›´æ–°ï¼Œå¹¿å‘Šåˆ†æä¸å¸ƒå±€ä¼˜åŒ–"><a href="#å¼¹çª—å®šä½å»æ›´æ–°ï¼Œå¹¿å‘Šåˆ†æä¸å¸ƒå±€ä¼˜åŒ–" class="headerlink" title="å¼¹çª—å®šä½å»æ›´æ–°ï¼Œå¹¿å‘Šåˆ†æä¸å¸ƒå±€ä¼˜åŒ–"></a>å¼¹çª—å®šä½å»æ›´æ–°ï¼Œå¹¿å‘Šåˆ†æä¸å¸ƒå±€ä¼˜åŒ–</h1><h2 id="1-å¹¿å‘Šç±»å‹"><a href="#1-å¹¿å‘Šç±»å‹" class="headerlink" title="1.å¹¿å‘Šç±»å‹"></a><strong>1.å¹¿å‘Šç±»å‹</strong></h2><p>å¯åŠ¨å¹¿å‘Š&nbsp; &nbsp;&nbsp;&nbsp;å¼¹çª—&amp;æ›´æ–°å¹¿å‘Š&nbsp; &nbsp;æ¨ªå¹…å¹¿å‘Š</p><h2 id="2-å®‰å“å››å¤§ç»„ä»¶"><a href="#2-å®‰å“å››å¤§ç»„ä»¶" class="headerlink" title="2.å®‰å“å››å¤§ç»„ä»¶"></a>2.å®‰å“å››å¤§ç»„ä»¶</h2><table><thead><tr><th><strong>ç»„ä»¶</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>Activity(æ´»åŠ¨)</td><td>åœ¨åº”ç”¨ä¸­çš„ä¸€ä¸ªActivityå¯ä»¥ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªç•Œé¢ï¼Œæ„æ€å¯ä»¥ç†è§£ä¸ºâ€œæ´»åŠ¨â€ï¼Œå³ä¸€ä¸ªæ´»åŠ¨å¼€å§‹ï¼Œä»£è¡¨ Activityç»„ä»¶å¯åŠ¨ï¼Œæ´»åŠ¨ç»“æŸï¼Œä»£è¡¨ä¸€ä¸ªActivityçš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚ä¸€ä¸ªAndroidåº”ç”¨å¿…é¡»é€šè¿‡Activityæ¥è¿è¡Œå’Œå¯åŠ¨ï¼ŒActivityçš„ç”Ÿå‘½å‘¨æœŸäº¤ç»™ç³»ç»Ÿç»Ÿä¸€ç®¡ç†ã€‚</td></tr><tr><td>Service(æœåŠ¡)</td><td>Serviceå®ƒå¯ä»¥åœ¨åå°æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œæ“ä½œè€Œæ²¡æœ‰ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç»„ä»¶ï¼Œä¸ä¾èµ–ä»»ä½•ç”¨æˆ·ç•Œé¢ï¼Œä¾‹å¦‚åå°æ’­æ”¾éŸ³ä¹ï¼Œåå°ä¸‹è½½æ–‡ä»¶ç­‰ã€‚</td></tr><tr><td>Broadcast Receiver(å¹¿æ’­æ¥æ”¶å™¨)</td><td>ä¸€ä¸ªç”¨äºæ¥æ”¶å¹¿æ’­ä¿¡æ¯ï¼Œå¹¶åšå‡ºå¯¹åº”å¤„ç†çš„ç»„ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„ç³»ç»Ÿå¹¿æ’­ï¼šé€šçŸ¥æ—¶åŒºæ”¹å˜ã€ç”µé‡ä½ã€ç”¨æˆ·æ”¹å˜äº†è¯­è¨€é€‰é¡¹ç­‰ã€‚</td></tr><tr><td>Content Provider(å†…å®¹æä¾›è€…)</td><td>ä½œä¸ºåº”ç”¨ç¨‹åºä¹‹é—´å”¯ä¸€çš„å…±äº«æ•°æ®çš„é€”å¾„ï¼ŒContent Providerä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å­˜å‚¨å¹¶æ£€ç´¢æ•°æ®ä»¥åŠå‘å…¶ä»–åº”ç”¨ç¨‹åºæä¾›è®¿é—®æ•°æ®çš„æ¥å£ã€‚Androidå†…ç½®çš„è®¸å¤šæ•°æ®éƒ½æ˜¯ä½¿ç”¨Content Providerå½¢å¼ï¼Œä¾›å¼€å‘è€…è°ƒç”¨çš„ï¼ˆå¦‚è§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ï¼Œé€šè®¯å½•ç­‰ï¼‰</td></tr></tbody></table><h3 id="1-activityçš„åˆ‡æ¢"><a href="#1-activityçš„åˆ‡æ¢" class="headerlink" title="1.activityçš„åˆ‡æ¢"></a><strong>1.activityçš„åˆ‡æ¢</strong></h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;!---å£°æ˜å®ç°åº”ç”¨éƒ¨åˆ†å¯è§†åŒ–ç•Œé¢çš„ Activityï¼Œå¿…é¡»ä½¿ç”¨ AndroidManifest ä¸­çš„ &lt;activity&gt; å…ƒç´ è¡¨ç¤ºæ‰€æœ‰ Activityã€‚ç³»ç»Ÿä¸ä¼šè¯†åˆ«å’Œè¿è¡Œä»»ä½•æœªè¿›è¡Œå£°æ˜çš„Activityã€‚-----&gt;<br>&lt;activity  <br>    android:label=<span class="hljs-string">"@string/app_name"</span>  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.MainActivity"</span>  <br>    android:exported=<span class="hljs-string">"true"</span>&gt;  &lt;!--å½“å‰Activityæ˜¯å¦å¯ä»¥è¢«å¦ä¸€ä¸ªApplicationçš„ç»„ä»¶å¯åŠ¨ï¼š<span class="hljs-literal">true</span>å…è®¸è¢«å¯åŠ¨ï¼›<span class="hljs-literal">false</span>ä¸å…è®¸è¢«å¯åŠ¨--&gt;<br>    &lt;!---æŒ‡æ˜è¿™ä¸ªactivityå¯ä»¥ä»¥ä»€ä¹ˆæ ·çš„æ„å›¾(intent)å¯åŠ¨---&gt;<br>    &lt;intent-filter&gt;  <br>        &lt;!--è¡¨ç¤ºactivityä½œä¸ºä¸€ä¸ªä»€ä¹ˆåŠ¨ä½œå¯åŠ¨ï¼Œandroid.intent.action.MAINè¡¨ç¤ºä½œä¸ºä¸»activityå¯åŠ¨---&gt;<br>        &lt;action  <br>            android:name=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;  <br>        &lt;!--è¿™æ˜¯actionå…ƒç´ çš„é¢å¤–ç±»åˆ«ä¿¡æ¯ï¼Œandroid.intent.category.LAUNCHERè¡¨ç¤ºè¿™ä¸ªactivityä¸ºå½“å‰åº”ç”¨ç¨‹åºä¼˜å…ˆçº§æœ€é«˜çš„Activity--&gt;<br>        &lt;category  <br>            android:name=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;  <br>    &lt;/intent-filter&gt;  <br>&lt;/activity&gt;  <br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeFirst"</span> /&gt;<br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeFifth"</span>  <br>    android:exported=<span class="hljs-string">"true"</span> /&gt;  <br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeFourth"</span>  <br>    android:exported=<span class="hljs-string">"true"</span> /&gt;  <br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeThird"</span>  <br>    android:exported=<span class="hljs-string">"false"</span> /&gt;  <br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.ChallengeSecond"</span>  <br>    android:exported=<span class="hljs-string">"false"</span> /&gt;  <br>&lt;activity  <br>    android:name=<span class="hljs-string">"com.zj.wuaipojie.ui.AdActivity"</span> /&gt;  <span class="hljs-comment">//å¹¿å‘Šçš„Activity</span><br></code></pre></td></tr></tbody></table></figure><p>å¯åŠ¨å¹¿å‘Šæµç¨‹ï¼š<br>å¯åŠ¨Activity-&gt;å¹¿å‘ŠActivity-&gt;ä¸»é¡µActivity</p><p>ä¿®æ”¹æ–¹æ³•ï¼š<br>1.ä¿®æ”¹åŠ è½½æ—¶é—´<br>2.Acitivityåˆ‡æ¢å®šä½ï¼Œä¿®æ”¹Intentçš„Activityç±»å</p><ul><li><p>ä¿®æ”¹Intentçš„Activityç±»åç¤ºä¾‹</p><p>  1.åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥ç›´æ¥æ’é™¤ä»–è‡ªèº«ä¸€ä¸ªç±»çš„è°ƒç”¨</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231717814.png"></p><p>  2.è§‚å¯Ÿæ”¹ä»£ç çš„è°ƒç”¨é€»è¾‘</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">switch</span> (position) {  <br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:  <br>        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();  <br>        intent.setClass(it.getContext(), ChallengeFirst.class);  <br>        it.getContext().startActivity(intent);  <br>        <span class="hljs-keyword">return</span>;  <br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:  <br>        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();  <br>        intent2.setClass(it.getContext(), ChallengeSecond.class);  <br>        it.getContext().startActivity(intent2);  <br>        <span class="hljs-keyword">return</span>;  <br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:  <br>        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();  <span class="hljs-comment">//newä¸€ä¸ªIntentï¼Œ</span><br>        intent3.setClass(it.getContext(), AdActivity.class);  <span class="hljs-comment">//ä¼ å…¥è¦åˆ‡æ¢çš„Acitivityçš„ç±»å</span><br>        it.getContext().startActivity(intent3);  <span class="hljs-comment">//å¯åŠ¨å¯¹åº”çš„Activity</span><br>        <span class="hljs-keyword">return</span>;  <br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:  <br>        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();  <br>        intent4.setClass(it.getContext(), ChallengeFourth.class);  <br>        it.getContext().startActivity(intent4);  <br>        <span class="hljs-keyword">return</span>; <br>    <span class="hljs-keyword">default</span>:  <br>        <span class="hljs-keyword">return</span>;  <br>}<br></code></pre></td></tr></tbody></table></figure><p>  3.é€šè¿‡è§‚å¯Ÿå‘ç°AdActivity.classæ˜¯æ’å…¥å¹¿å‘Šçš„åœ°æ–¹ï¼Œæˆ‘ä»¬è¿›å…¥è¯¥åœ°æ–¹å°†ä¼ å…¥çš„å¹¿å‘ŠActivityåˆ‡æ¢ä¸ºæˆ‘ä»¬æ­£å¸¸çš„é¡µé¢Activity</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231712525.png"></p><p>  4.é‡æ–°ç­¾åå®‰è£…åå°±å‘ç°æˆ‘ä»¬ç›´æ¥è¿›å…¥åˆ°æ­£å¸¸çš„Activityé¡µé¢ã€‚è¯¥æ–¹æ³•å®šä½åˆ°å…·ä½“çš„ä»£ç åœ°æ–¹ä¿®æ”¹å¯ä»¥é¿å…ç›´æ¥åœ¨XMlæ–‡ä»¶é‡Œä¿®æ”¹è€Œäº§ç”Ÿçš„é¡µé¢å†…å®¹æ— æ³•åŠ è½½æˆ–é—ªé€€ç­‰æƒ…å†µã€‚</p></li></ul><h3 id="activityåˆ‡æ¢å®šä½æ³•"><a href="#activityåˆ‡æ¢å®šä½æ³•" class="headerlink" title="activityåˆ‡æ¢å®šä½æ³•"></a>activityåˆ‡æ¢å®šä½æ³•</h3><ul><li><p>ä¿®æ”¹æ—¶é—´ç¤ºä¾‹</p><p>  1.å…ˆæ‰“å¼€Activityè®°å½•</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231713500.png"></p><p>  2.å¯ä»¥æŸ¥æ‰¾å®šä½åˆ°æˆ‘ä»¬åˆšåˆšæ‰“å¼€ç•Œé¢æˆ–è‡ªåŠ¨å¼¹å‡ºç•Œé¢çš„Activity</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231713929.png"></p><p>  3.ç‚¹å‡»å¤åˆ¶è¿›è¡ŒæŸ¥æ‰¾</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231713873.png"></p><p>  4.ä¿®æ”¹æ—¶é—´æ¥å…³é—­å¼¹çª—ï¼Œæˆ‘ä»¬å‘ç°è°ƒç”¨æ—¶é—´çš„æ˜¯loadAd()æ–¹æ³•ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231713028.png"></p><ol><li><code>0xbb8</code>æ˜¯åå…­è¿›åˆ¶æ•°å€¼ï¼Œå¯¹åº”åè¿›åˆ¶çš„&nbsp;3000 æ¯«ç§’ï¼ˆ3 ç§’ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶ä¿®æ”¹ä¸º0x0ä½¿å…¶è¯»ç§’æ•°å˜ä¸º0</li></ol><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231713307.png"></p><p>  6.ä¿å­˜å®‰è£…åå°±å¯ä»¥å‘ç°ç•Œé¢ä»ä¼šèµ°åˆ°ï¼Œä½†æ˜¯å› ä¸ºåœç•™æ—¶é—´å¤ªçŸ­å¯ä»¥å¿½ç•¥ã€‚</p></li></ul><h2 id="3-Activityç”Ÿå‘½å‘¨æœŸ"><a href="#3-Activityç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3.Activityç”Ÿå‘½å‘¨æœŸ"></a>3.<strong>Activityç”Ÿå‘½å‘¨æœŸ</strong></h2><table><thead><tr><th><strong>å‡½æ•°åç§°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>onCreate()</td><td>ä¸€ä¸ªActivityå¯åŠ¨åç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå¸¸ç”¨æ¥åœ¨æ­¤æ–¹æ³•ä¸­è¿›è¡ŒActivityçš„ä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ä¾‹å¦‚åˆ›å»ºViewï¼Œç»‘å®šæ•°æ®ï¼Œæ³¨å†Œç›‘å¬ï¼ŒåŠ è½½å‚æ•°ç­‰ã€‚</td></tr><tr><td>onStart()</td><td>å½“Activityæ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œæ­¤æ–¹æ³•è¢«è°ƒç”¨ä½†æ­¤æ—¶è¿˜æ— æ³•è¿›è¡Œä¸ç”¨æˆ·çš„äº¤äº’æ“ä½œã€‚</td></tr><tr><td>onResume()</td><td>è¿™ä¸ªæ–¹æ³•åœ¨onStart()ä¹‹åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨Activityå‡†å¤‡å¥½ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„æ—¶å€™è°ƒç”¨ï¼Œæ­¤æ—¶çš„Activityä¸€å®šä½äºActivityæ ˆé¡¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€ã€‚</td></tr><tr><td>onPause()</td><td>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç³»ç»Ÿå‡†å¤‡å»å¯åŠ¨æˆ–è€…æ¢å¤å¦å¤–ä¸€ä¸ªActivityçš„æ—¶å€™è°ƒç”¨ï¼Œé€šå¸¸åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ‰§è¡Œä¸€äº›é‡Šæ”¾èµ„æºçš„æ–¹æ³•ï¼Œä»¥åŠä¿å­˜ä¸€äº›å…³é”®æ•°æ®ã€‚</td></tr><tr><td>onStop()</td><td>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨Activityå®Œå…¨ä¸å¯è§çš„æ—¶å€™è°ƒç”¨çš„ã€‚</td></tr><tr><td>onDestroy()</td><td>è¿™ä¸ªæ–¹æ³•åœ¨Activityé”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œä¹‹åActivityçš„çŠ¶æ€ä¸ºé”€æ¯çŠ¶æ€ã€‚</td></tr><tr><td>onRestart()</td><td>å½“Activityä»åœæ­¢stopçŠ¶æ€æ¢è¿›å…¥startçŠ¶æ€æ—¶è°ƒç”¨çŠ¶æ€ã€‚</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231714521.png"></p><h2 id="4-å¼¹çª—å®šä½-å †æ ˆåˆ†æ"><a href="#4-å¼¹çª—å®šä½-å †æ ˆåˆ†æ" class="headerlink" title="4.å¼¹çª—å®šä½&amp;å †æ ˆåˆ†æ"></a><strong>4.å¼¹çª—å®šä½&amp;å †æ ˆåˆ†æ</strong></h2><p>ä¿®æ”¹æ–¹æ³•ï¼š</p><ul><li><p>1.ä¿®æ”¹xmlä¸­çš„versiocode</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231714745.png"></p></li><li><p>2.Hookå¼¹çª—(æ¨èç®—æ³•åŠ©æ‰‹å¼€å¯å¼¹çª—å®šä½)</p><p>  ï¼ˆ1ï¼‰å¯åŠ¨æ¨¡å—ï¼Œå‹¾é€‰ä½œç”¨åŸŸé‡å¯è½¯ä»¶</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231714395.png"></p><p>  ï¼ˆ2ï¼‰æ‰“å¼€ç®—æ³•åŠ©æ‰‹ï¼Œæ‰¾åˆ°è¯¥è½¯ä»¶åˆ†åˆ«æ‰“å¼€åº”ç”¨æ€»å¼€å…³å’Œå¼¹çª—å®šä½ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231714171.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231714172.png"><br>  ï¼ˆ3ï¼‰å¯åŠ¨åç‚¹å‡»è¿”å›å°±å¯ä»¥å®ç°è¿”å›ï¼Œä½†åœ¨Hookä¹‹å‰ä¼šæŠŠè¿”å›é”®ç»™åŠ«æŒæ‰ã€‚ç›¸å½“äºå»æ‰å¼¹çª—ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715113.png"></p><p>  ï¼ˆ4ï¼‰ä¹Ÿå¯ä»¥ç›´æ¥å¯ç”¨çš„å…³é”®è¯å¼¹çª—ï¼Œç›´æ¥Hookæ‰ä¸¤ä¸ªå¼¹çª—ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715712.png"></p></li><li><p>3.ä¿®æ”¹dexå¼¹çª—ä»£ç </p><p>  ï¼ˆ1ï¼‰æ‰“å¼€æ—¥å¿—æ‰¾åˆ°æœ€æ–°å¼¹çª—ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥å¼¹çª—çš„ç›¸å…³å†…å®¹ä»¥åŠå †æ ˆçš„è°ƒç”¨</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715655.png"></p><p>  ï¼ˆ2ï¼‰å› ä¸ºæœ€ç»ˆè¦å®šä½åˆ°è¯¥onCreateæ–¹æ³•ï¼Œæˆ‘ä»¬å®šä½åˆ°æœ€ç²¾å‡†çš„åœ°æ–¹è¿›è¡ŒæŸ¥çœ‹ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715361.png"></p><p>  ï¼ˆ3ï¼‰ä¼šå‘ç°åé¢è°ƒç”¨äº†show()æ–¹æ³•æ¥æ˜¾ç¤ºå¼¹çª—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥æ®µä»£ç æ³¨é‡Šæ‰æˆ–åˆ é™¤ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715201.png"></p></li><li><p>4.æŠ“åŒ…ä¿®æ”¹å“åº”ä½“(ä¹Ÿå¯ä»¥è·¯ç”±å™¨æ‹¦æˆª)</p><p>  è¯¦è§åé¢æŠ“åŒ…å†…å®¹</p></li><li><p>æ¨ªå¹…å¹¿å‘Š</p><p>  1.ä½¿ç”¨å¼€å‘åŠ©æ‰‹çš„å¸ƒå±€æŸ¥çœ‹åŠŸèƒ½ï¼ŒåŒæ„å…¶ç”³è¯·æƒé™</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231715524.png"></p><p>  2.ä½¿ç”¨å°æ”¾å¤§é•œé€‰å–æ¨ªå¹…ï¼ŒæŸ¥çœ‹å…¶ç›¸å…³ä¿¡æ¯ï¼Œad_imageæ˜¯å¹¿å‘Šçš„æ„æ€</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231716804.png"></p><p>  3.è¿›ä¸€æ­¥æˆ‘ä»¬æŸ¥çœ‹åˆ°å…¶idç­‰ä¿¡æ¯</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231716397.png"></p><p>  4.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨XMLæŸ¥æ‰¾</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231716426.png"></p><p>  5.åˆ°å®šä½ä½ç½®ä¿®æ”¹å…¶ç•Œé¢çš„ç›¸å…³ä¿¡æ¯</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231716519.png"></p><p>  6.åŒæ ·ä¹Ÿå¯ä»¥åŠ å…¥xmléšè—ä»£ç å°†è¯¥å¸ƒå±€éšè—èµ·æ¥</p>  <figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br>android:visibility="gone"<br></code></pre></td></tr></tbody></table></figure><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503231716656.png"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰å“å››å¤§ç»„ä»¶</tag>
      
      <tag>Activity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†Smail</title>
    <link href="/2025/03/22/ZJ3/%E5%88%9D%E8%AF%86smail%201aba6f4b4daf80fb9bbfc0bb1c274e44/"/>
    <url>/2025/03/22/ZJ3/%E5%88%9D%E8%AF%86smail%201aba6f4b4daf80fb9bbfc0bb1c274e44/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆè¯†smail"><a href="#åˆè¯†smail" class="headerlink" title="åˆè¯†smail"></a>åˆè¯†smail</h1><h1 id="1-ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART"><a href="#1-ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART" class="headerlink" title="1.ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART"></a>1.ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART</h1><p>JVMæ˜¯JAVAè™šæ‹Ÿæœºï¼Œè¿è¡ŒJAVAå­—èŠ‚ç ç¨‹åº</p><p>Dalvikæ˜¯Googleä¸“é—¨ä¸ºAndroidè®¾è®¡çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼ŒDalvikæœ‰ä¸“å±çš„æ–‡ä»¶æ‰§è¡Œæ ¼å¼dex(Dalvik executable)</p><p>Art(Android Runtime)ç›¸å½“äºDalvikçš„å‡çº§ç‰ˆï¼Œæœ¬è´¨ä¸Dalvikæ— å¼‚</p><ul><li><p><strong>JVM</strong>&nbsp;æ˜¯ Java ç”Ÿæ€çš„é€šç”¨è¿è¡Œæ—¶ï¼Œ<strong>Dalvik</strong>&nbsp;æ˜¯ Android æ—©æœŸçš„ç§»åŠ¨ä¼˜åŒ–æ–¹æ¡ˆï¼Œ<strong>ART</strong>&nbsp;æ˜¯æ›´ç°ä»£çš„ Android è¿è¡Œæ—¶ï¼Œé€šè¿‡é¢„ç¼–è¯‘å’Œæ··åˆæ¨¡å¼æ˜¾è‘—æå‡æ€§èƒ½ã€‚ä¸‰è€…çš„æ¼”è¿›åæ˜ äº†ä»è·¨å¹³å°å…¼å®¹æ€§åˆ°ç§»åŠ¨ç«¯æè‡´æ€§èƒ½çš„æƒè¡¡</p><h3 id="1-JVMï¼ˆJava-Virtual-Machineï¼‰"><a href="#1-JVMï¼ˆJava-Virtual-Machineï¼‰" class="headerlink" title="1. JVMï¼ˆJava Virtual Machineï¼‰"></a><strong>1. JVMï¼ˆJava Virtual Machineï¼‰</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šJVM æ˜¯ Java å¹³å°çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ‰§è¡Œ&nbsp;<strong>Java å­—èŠ‚ç </strong>ï¼ˆ<code>.class</code>&nbsp;æ–‡ä»¶ï¼‰ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>è·¨å¹³å°</strong>ï¼šéµå¾ªâ€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€çš„ç†å¿µï¼Œé€šè¿‡å­—èŠ‚ç å’Œ JVM çš„é€‚é…å®ç°è·¨å¹³å°ã€‚</li><li><strong>åŸºäºæ ˆçš„æ¶æ„</strong>ï¼šæŒ‡ä»¤æ“ä½œåŸºäºæ ˆï¼ˆæ“ä½œæ•°æ ˆï¼‰ï¼ŒæŒ‡ä»¤æ›´ç´§å‡‘ä½†å¯èƒ½æ‰§è¡Œè¾ƒæ…¢ã€‚</li><li><strong>JIT ç¼–è¯‘</strong>ï¼ˆJust-In-Timeï¼‰ï¼šè¿è¡Œæ—¶å°†çƒ­ç‚¹ä»£ç ï¼ˆé¢‘ç¹æ‰§è¡Œçš„ä»£ç ï¼‰åŠ¨æ€ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ä»¥æé«˜æ€§èƒ½ã€‚</li></ul></li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šä¼ ç»Ÿ Java åº”ç”¨ï¼ˆå¦‚æ¡Œé¢ã€æœåŠ¡å™¨ç«¯ç¨‹åºï¼‰ã€‚</li></ul><hr><h3 id="2-Dalvik"><a href="#2-Dalvik" class="headerlink" title="2. Dalvik"></a><strong>2. Dalvik</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šDalvik æ˜¯ Android æ—©æœŸï¼ˆ5.0 ä¹‹å‰ï¼‰ä½¿ç”¨çš„<strong>è™šæ‹Ÿæœº</strong>ï¼Œä¸“ä¸ºç§»åŠ¨è®¾å¤‡ä¼˜åŒ–ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>åŸºäºå¯„å­˜å™¨æ¶æ„</strong>ï¼šæŒ‡ä»¤ç›´æ¥æ“ä½œå¯„å­˜å™¨ï¼Œæ‰§è¡Œæ•ˆç‡æ›´é«˜ï¼ˆä½†æŒ‡ä»¤æ›´é•¿ï¼‰ã€‚</li><li><strong>è¿è¡Œ Dex æ–‡ä»¶</strong>ï¼šå°†å¤šä¸ª&nbsp;<code>.class</code>&nbsp;æ–‡ä»¶åˆå¹¶ä¼˜åŒ–ä¸ºå•ä¸ª&nbsp;<code>.dex</code>&nbsp;æ–‡ä»¶ï¼Œå‡å°‘ä½“ç§¯å’Œå†—ä½™ã€‚</li><li><strong>JIT ç¼–è¯‘</strong>ï¼šåœ¨åº”ç”¨è¿è¡Œæ—¶åŠ¨æ€ç¼–è¯‘å­—èŠ‚ç ä¸ºæœºå™¨ç ï¼Œä½†æ¯æ¬¡å¯åŠ¨éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</li><li><strong>å¤šå®ä¾‹è®¾è®¡</strong>ï¼šæ¯ä¸ª Android åº”ç”¨è¿è¡Œåœ¨ç‹¬ç«‹çš„ Dalvik è¿›ç¨‹ä¸­ï¼Œå®ç°æ²™ç›’éš”ç¦»ã€‚</li></ul></li><li><strong>å±€é™æ€§</strong>ï¼šJIT ç¼–è¯‘å¯¼è‡´å¯åŠ¨æ…¢ã€å†…å­˜å ç”¨é«˜ï¼Œä¸”è¿è¡Œæ—¶æ€§èƒ½ä¸å¦‚é¢„å…ˆç¼–è¯‘ã€‚</li></ul><hr><h3 id="3-ARTï¼ˆAndroid-Runtimeï¼‰"><a href="#3-ARTï¼ˆAndroid-Runtimeï¼‰" class="headerlink" title="3. ARTï¼ˆAndroid Runtimeï¼‰"></a><strong>3. ARTï¼ˆAndroid Runtimeï¼‰</strong></h3><ul><li><strong>å®šä¹‰</strong>ï¼šART æ˜¯ Android 5.0ï¼ˆLollipopï¼‰åŠä¹‹åå–ä»£ Dalvik çš„<strong>æ–°ä¸€ä»£è¿è¡Œæ—¶</strong>ã€‚</li><li><strong>æ ¸å¿ƒæ”¹è¿›</strong>ï¼š<ul><li><strong>AOT ç¼–è¯‘</strong>ï¼ˆAhead-Of-Timeï¼‰ï¼š<strong>å®‰è£…æ—¶</strong>å°† Dex å­—èŠ‚ç å®Œå…¨ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œç›´æ¥æ‰§è¡Œï¼Œå¤§å¹…æå‡è¿è¡Œé€Ÿåº¦å’Œèƒ½æ•ˆã€‚</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå‡å°‘è¿è¡Œæ—¶ç¼–è¯‘å¼€é”€ï¼ŒCPU å’Œå†…å­˜æ•ˆç‡æ›´é«˜ã€‚</li><li><strong>åƒåœ¾å›æ”¶æ”¹è¿›</strong>ï¼šå‡å°‘æš‚åœæ—¶é—´ï¼Œæ”¯æŒå¹¶è¡Œå¤„ç†ã€‚</li><li><strong>æ”¯æŒ 64 ä½</strong>ï¼šæ›´å¥½åœ°åˆ©ç”¨ç°ä»£ç¡¬ä»¶ã€‚</li></ul></li><li><strong>ä»£ä»·</strong>ï¼šåº”ç”¨å®‰è£…æ—¶é—´å˜é•¿ï¼Œå­˜å‚¨å ç”¨å¢åŠ ï¼ˆéœ€å­˜å‚¨ç¼–è¯‘åçš„æœºå™¨ç ï¼‰ã€‚</li><li><strong>æ··åˆç¼–è¯‘ï¼ˆAndroid 7.0+ï¼‰</strong>ï¼šç»“åˆ JIT å’Œ AOTï¼Œå®‰è£…æ—¶ä»…éƒ¨åˆ†ç¼–è¯‘ï¼Œè¿è¡Œæ—¶æ”¶é›†çƒ­ç‚¹ä»£ç å†ä¼˜åŒ–ï¼Œå¹³è¡¡é€Ÿåº¦å’Œå­˜å‚¨ã€‚</li></ul><hr><h3 id="å¯¹æ¯”æ€»ç»“"><a href="#å¯¹æ¯”æ€»ç»“" class="headerlink" title="å¯¹æ¯”æ€»ç»“"></a><strong>å¯¹æ¯”æ€»ç»“</strong></h3><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>JVM</strong></th><th><strong>Dalvik</strong></th><th><strong>ART</strong></th></tr></thead><tbody><tr><td><strong>æ¶æ„</strong></td><td>åŸºäºæ ˆ</td><td>åŸºäºå¯„å­˜å™¨</td><td>åŸºäºå¯„å­˜å™¨ï¼ˆå…¼å®¹ Dexï¼‰</td></tr><tr><td><strong>ç¼–è¯‘æ–¹å¼</strong></td><td>JIT</td><td>JIT</td><td>AOT + JITï¼ˆæ··åˆæ¨¡å¼ï¼‰</td></tr><tr><td><strong>æ–‡ä»¶æ ¼å¼</strong></td><td><code>.class</code>&nbsp;æ–‡ä»¶</td><td><code>.dex</code>&nbsp;æ–‡ä»¶</td><td><code>.dex</code>&nbsp;â†’ æœ¬åœ°æœºå™¨ç </td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>é€‚ä¸­ï¼ˆè·¨å¹³å°ä»£ä»·ï¼‰</td><td>å¯åŠ¨æ…¢ï¼Œè¿è¡Œæ—¶ä¼˜åŒ–</td><td>å¯åŠ¨å¿«ï¼Œè¿è¡Œé«˜æ•ˆ</td></tr><tr><td><strong>å­˜å‚¨å ç”¨</strong></td><td>ä½</td><td>ä½</td><td>è¾ƒé«˜ï¼ˆå­˜å‚¨é¢„ç¼–è¯‘æœºå™¨ç ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ¡Œé¢/æœåŠ¡å™¨ Java åº”ç”¨</td><td>æ—©æœŸ Android è®¾å¤‡</td><td>ç°ä»£ Android è®¾å¤‡ï¼ˆ5.0+ï¼‰</td></tr></tbody></table><hr><h3 id="ä¸ºä»€ä¹ˆ-Android-ä¸ç”¨-JVMï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-Android-ä¸ç”¨-JVMï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ Android ä¸ç”¨ JVMï¼Ÿ"></a><strong>ä¸ºä»€ä¹ˆ Android ä¸ç”¨ JVMï¼Ÿ</strong></h3><ol><li><strong>ä¸“åˆ©ä¸æˆæƒ</strong>ï¼šæ—©æœŸ Oracle å¯¹ JVM ä¸“åˆ©æ§åˆ¶ä¸¥æ ¼ï¼ŒAndroid é€‰æ‹©ç»•è¿‡ã€‚</li><li><strong>ç§»åŠ¨ç«¯ä¼˜åŒ–</strong>ï¼šDalvik/ART é’ˆå¯¹ä½å†…å­˜ã€ä½åŠŸè€—è®¾å¤‡è®¾è®¡ï¼ˆå¦‚å¯„å­˜å™¨æ¶æ„ã€Dex ä¼˜åŒ–ï¼‰ã€‚</li><li><strong>ç”Ÿæ€éš”ç¦»</strong>ï¼šAndroid é€šè¿‡è‡ªå®šä¹‰è¿è¡Œæ—¶é¿å…ä¸ Java ME ç”Ÿæ€å†²çªã€‚</li></ol></li></ul><h1 id="2-smaliåŠå…¶è¯­æ³•"><a href="#2-smaliåŠå…¶è¯­æ³•" class="headerlink" title="2.smaliåŠå…¶è¯­æ³•"></a><strong>2.smaliåŠå…¶è¯­æ³•</strong></h1><p>smaliæ˜¯Dalvikçš„å¯„å­˜å™¨è¯­è¨€ï¼Œsmaliä»£ç æ˜¯dexåç¼–è¯‘è€Œæ¥çš„ã€‚ï¼ˆé™æ€ä¿®æ”¹å‰ææ¡ä»¶ï¼‰</p><p><a href="https://www.52pojie.cn/thread-1485681-1-1.html">ã€åŸæœ¨æ–‡ç« ã€‘Androidæ”¹é€ è€…ä¹‹è·¯-02.åˆæ¢smaliåŠŸæ³• - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p><a href="https://www.52pojie.cn/thread-396966-1-1.html">å¾çˆ±ç ´è§£å®‰å“é€†å‘å…¥é—¨æ•™ç¨‹ï¼ˆä¸‰ï¼‰-æ·±å…¥Smaliæ–‡ä»¶ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p><a href="https://www.52pojie.cn/thread-397858-1-1.html">å¾çˆ±ç ´è§£å®‰å“é€†å‘å…¥é—¨æ•™ç¨‹ï¼ˆå››ï¼‰-Smaliå‡½æ•°åˆ†æ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><h3 id="å…³é”®å­—"><a href="#å…³é”®å­—" class="headerlink" title="å…³é”®å­—"></a><strong>å…³é”®å­—</strong></h3><table><thead><tr><th><strong>åç§°</strong></th><th><strong>æ³¨é‡Š</strong></th></tr></thead><tbody><tr><td>.class</td><td>ç±»å</td></tr><tr><td>.super</td><td>çˆ¶ç±»åï¼Œç»§æ‰¿çš„ä¸Šçº§ç±»ååç§°</td></tr><tr><td>.source</td><td>æºå</td></tr><tr><td>.field</td><td>å˜é‡</td></tr><tr><td>.method</td><td>æ–¹æ³•å</td></tr><tr><td>.register</td><td>å¯„å­˜å™¨</td></tr><tr><td>.end method</td><td>æ–¹æ³•åçš„ç»“æŸ</td></tr><tr><td>public</td><td>å…¬æœ‰</td></tr><tr><td>protected</td><td>åŠå…¬å¼€ï¼Œåªæœ‰åŒä¸€å®¶äººæ‰èƒ½ç”¨</td></tr><tr><td>private</td><td>ç§æœ‰ï¼Œåªèƒ½è‡ªå·±ä½¿ç”¨</td></tr><tr><td>.parameter</td><td>æ–¹æ³•å‚æ•°</td></tr><tr><td>.prologue</td><td>æ–¹æ³•å¼€å§‹</td></tr><tr><td>.line xxx</td><td>ä½äºç¬¬xxxè¡Œ</td></tr></tbody></table><h3 id="æ•°æ®ç±»å‹å¯¹åº”"><a href="#æ•°æ®ç±»å‹å¯¹åº”" class="headerlink" title="æ•°æ®ç±»å‹å¯¹åº”"></a>æ•°æ®ç±»å‹å¯¹åº”</h3><table><thead><tr><th><strong>smaliç±»å‹</strong></th><th><strong>javaç±»å‹</strong></th><th><strong>æ³¨é‡Š</strong></th></tr></thead><tbody><tr><td>V</td><td>void</td><td>æ— è¿”å›å€¼</td></tr><tr><td>Z</td><td>boolean</td><td>å¸ƒå°”å€¼ç±»å‹ï¼Œè¿”å›0æˆ–1</td></tr><tr><td>B</td><td>byte</td><td>å­—èŠ‚ç±»å‹ï¼Œè¿”å›å­—èŠ‚</td></tr><tr><td>S</td><td>short</td><td>çŸ­æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td>C</td><td>char</td><td>å­—ç¬¦ç±»å‹ï¼Œè¿”å›å­—ç¬¦</td></tr><tr><td>I</td><td>int</td><td>æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td>J</td><td>long ï¼ˆ64ä½ éœ€è¦2ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td><td>é•¿æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td>F</td><td>float</td><td>å•æµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td>D</td><td>double ï¼ˆ64ä½ éœ€è¦2ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td><td>åŒæµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td>string</td><td>String</td><td>æ–‡æœ¬ç±»å‹ï¼Œè¿”å›å­—ç¬¦ä¸²</td></tr><tr><td>Lxxx/xxx/xxx</td><td>object</td><td>å¯¹è±¡ç±»å‹ï¼Œè¿”å›å¯¹è±¡</td></tr></tbody></table><h3 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h3><table><thead><tr><th><strong>å…³é”®å­—</strong></th><th><strong>æ³¨é‡Š</strong></th></tr></thead><tbody><tr><td>const</td><td>é‡å†™æ•´æ•°å±æ€§ï¼ŒçœŸå‡å±æ€§å†…å®¹ï¼Œåªèƒ½æ˜¯æ•°å­—ç±»å‹</td></tr><tr><td>const-string</td><td>é‡å†™å­—ç¬¦ä¸²å†…å®¹</td></tr><tr><td>const-wide</td><td>é‡å†™é•¿æ•´æ•°ç±»å‹ï¼Œå¤šç”¨äºä¿®æ”¹åˆ°æœŸæ—¶é—´ã€‚</td></tr><tr><td>return</td><td>è¿”å›æŒ‡ä»¤</td></tr><tr><td>if-eq</td><td>å…¨ç§°equal(a=b)ï¼Œæ¯”è¾ƒå¯„å­˜å™¨abå†…å®¹ï¼Œç›¸åŒåˆ™è·³</td></tr><tr><td>if-ne</td><td>å…¨ç§°not equal(a!=b)ï¼Œabå†…å®¹ä¸ç›¸åŒåˆ™è·³</td></tr><tr><td>if-eqz</td><td>å…¨ç§°equal zero(a=0)ï¼Œzå³æ˜¯0çš„æ ‡è®°ï¼Œaç­‰äº0åˆ™è·³</td></tr><tr><td>if-nez</td><td>å…¨ç§°not equal zero(a!=0)ï¼Œaä¸ç­‰äº0åˆ™è·³</td></tr><tr><td>if-ge</td><td>å…¨ç§°greater&nbsp;equal(a&gt;=b)ï¼Œaå¤§äºæˆ–ç­‰äºåˆ™è·³</td></tr><tr><td>if-le</td><td>å…¨ç§°little equal(a&lt;=b)ï¼Œaå°äºæˆ–ç­‰äºåˆ™è·³</td></tr><tr><td>goto</td><td>å¼ºåˆ¶è·³åˆ°æŒ‡å®šä½ç½®</td></tr><tr><td>switch</td><td>åˆ†æ”¯è·³è½¬ï¼Œä¸€èˆ¬ä¼šæœ‰å¤šä¸ªåˆ†æ”¯çº¿ï¼Œå¹¶æ ¹æ®æŒ‡ä»¤è·³è½¬åˆ°é€‚å½“ä½ç½®</td></tr><tr><td>iget</td><td>è·å–å¯„å­˜å™¨æ•°æ®</td></tr></tbody></table><ul><li><p>if-eqz å¦ä¸€ä¸ªæ˜¯if-nez è¿™ä¸¤æ¡æŒ‡ä»¤æ˜¯ç›¸å¯¹çš„</p><p>  (1)if-eqz vA, vB, :cond_**â€&nbsp; &nbsp;å¦‚æœvAç­‰äºvBåˆ™è·³è½¬åˆ°:cond_**</p><p>  (2)if-nez vA, vB, :cond_**â€&nbsp; &nbsp;å¦‚æœvAä¸ç­‰äºvBåˆ™è·³è½¬åˆ°:cond_**</p></li></ul><p>å…¶ä½™æŒ‡ä»¤å¯ç”¨è¯­æ³•å·¥å…·æŸ¥è¯¢</p><p>å®šä½æ–¹æ³•ï¼šæœç´¢å¼¹çª—å…³é”®å­—ã€æŠ“å–æŒ‰é’®id</p><ul><li><p>åˆ†æç¤ºä¾‹</p>  <figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¸€ä¸ªç§æœ‰ã€é™æ€ã€ä¸å¯å˜çš„æ–¹æ³•   æ–¹æ³•å</span><br>.method <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> onCreate$lambda-<span class="hljs-number">2</span>(Lkotlin/jvm/internal/Ref$IntRef;Lcom/zj/wuaipojie/ui/ChallengeSecond;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/view/View;)Z <span class="hljs-comment">//(è¿™é‡Œé¢æ˜¯æ–¹æ³•çš„å‚æ•°)è¿™é‡Œæ˜¯æ–¹æ³•è¿”å›å€¼ç±»å‹ï¼Œè¡¨ç¤ºå¸ƒå°”å€¼ç±»å‹ï¼Œè¿”å›å‡æˆ–çœŸ</span><br>    .registers <span class="hljs-number">7</span>  <span class="hljs-comment">//å¯„å­˜å™¨æ•°é‡</span><br><br>    .line <span class="hljs-number">33</span>  <span class="hljs-comment">//ä»£ç æ‰€åœ¨çš„è¡Œæ•°</span><br>    iget p0, p0, Lkotlin/jvm/internal/Ref$IntRef;-&gt;element:I  <span class="hljs-comment">//è¯»å–p0(ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå‚è€ƒå¯„å­˜å™¨çŸ¥è¯†)ä¸­elementçš„å€¼èµ‹å€¼ç»™p0</span><br><br>    const/<span class="hljs-number">4</span> p5, <span class="hljs-number">0x1</span>  <span class="hljs-comment">//p5èµ‹å€¼1</span><br><br>    const/<span class="hljs-number">16</span> v0, <span class="hljs-number">0xa</span> <span class="hljs-comment">//v0èµ‹å€¼10ï¼Œåœ¨16è¿›åˆ¶é‡Œaè¡¨ç¤º10</span><br><br>    <span class="hljs-keyword">if</span>-ge p0, v0, :cond_15  <span class="hljs-comment">//åˆ¤æ–­p0çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºv0çš„å€¼(å³p0çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äº10)ï¼Œå¦‚æœå¤§äºæˆ–ç­‰äºåˆ™è·³è½¬åˆ°:cond_15</span><br><br>    .line <span class="hljs-number">34</span>  <span class="hljs-comment">//ä»¥ä¸‹æ˜¯å¸¸è§çš„Toastå¼¹çª—ä»£ç </span><br>    check-cast p1, Landroid/content/Context; <span class="hljs-comment">//æ£€æŸ¥Contextå¯¹è±¡å¼•ç”¨</span><br><br>    const-string p0, <span class="hljs-string">"è¯·å…ˆè·å–10ä¸ªç¡¬å¸å“¦"</span> <span class="hljs-comment">//å¼¹çª—æ–‡æœ¬ä¿¡æ¯ï¼ŒæŠŠ""é‡Œçš„å­—ç¬¦ä¸²æ•°æ®èµ‹å€¼ç»™p0</span><br><br>    check-cast p0, Ljava/lang/CharSequence; <span class="hljs-comment">//æ£€æŸ¥CharSequenceå¯¹è±¡å¼•ç”¨</span><br><br>    invoke-<span class="hljs-keyword">static</span> {p1, p0, p5}, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast; <br>    <span class="hljs-comment">//å°†å¼¹çª—æ–‡æœ¬ã€æ˜¾ç¤ºæ—¶é—´ç­‰ä¿¡æ¯ä¼ ç»™p1</span><br><br>    move-result-object p0  <span class="hljs-comment">//ç»“æœä¼ é€’ç»™p0</span><br><br>    invoke-virtual {p0}, Landroid/widget/Toast;-&gt;show()V  <span class="hljs-comment">//å½“çœ‹åˆ°è¿™ä¸ªToast;-&gt;showä½ å°±åº”è¯¥ååº”è¿‡æ¥è¿™é‡Œæ˜¯å¼¹çª—ä»£ç </span><br><br>    <span class="hljs-keyword">goto</span> :goto_31  <span class="hljs-comment">//è·³è½¬åˆ°:goto_31</span><br><br>    :cond_15 <span class="hljs-comment">//è·³è½¬çš„ä¸€ä¸ªåœ°å€</span><br><br>    invoke-virtual {p1}, Lcom/zj/wuaipojie/ui/ChallengeSecond;-&gt;isvip()Z  <span class="hljs-comment">//åˆ¤æ–­isvipæ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦ä¸ºçœŸ(å³ç»“æœæ˜¯å¦ä¸º1)</span><br><br>    move-result p0  <span class="hljs-comment">//ç»“æœèµ‹å€¼ç»™p0</span><br><br>    <span class="hljs-keyword">if</span>-eqz p0, :cond_43 <span class="hljs-comment">//å¦‚æœç»“æœä¸º0åˆ™è·³è½¬cond_43åœ°å€</span><br><br>    const p0, <span class="hljs-number">0x7f0d0018</span>  <span class="hljs-comment">//åœ¨arscä¸­çš„idç´¢å¼•ï¼Œè¿™ä¸ªå€¼å¯ä»¥è¿›è¡ŒæŸ¥è¯¢</span><br><br>    .line <span class="hljs-number">37</span><br>    invoke-virtual {p2, p0}, Landroid/widget/ImageView;-&gt;setImageResource(I)V <span class="hljs-comment">//è®¾ç½®å›¾ç‰‡èµ„æº</span><br><br>    const p0, <span class="hljs-number">0x7f0d0008</span><br><br>    .line <span class="hljs-number">38</span><br>    invoke-virtual {p3, p0}, Landroid/widget/ImageView;-&gt;setImageResource(I)V<br><br>    const p0, <span class="hljs-number">0x7f0d000a</span><br><br>    .line <span class="hljs-number">39</span><br>    invoke-virtual {p4, p0}, Landroid/widget/ImageView;-&gt;setImageResource(I)V<br><br>    .line <span class="hljs-number">40</span><br>    sget-object p0, Lcom/zj/wuaipojie/util/SPUtils;-&gt;INSTANCE:Lcom/zj/wuaipojie/util/SPUtils; <br><br>    check-cast p1, Landroid/content/Context;<br><br>    const/<span class="hljs-number">4</span> p2, <span class="hljs-number">0x2</span> <span class="hljs-comment">//p2èµ‹å€¼2</span><br><br>    const-string p3, <span class="hljs-string">"level"</span> <span class="hljs-comment">//spçš„ç´¢å¼•</span><br><br>    invoke-virtual {p0, p1, p3, p2}, Lcom/zj/wuaipojie/util/SPUtils;-&gt;saveInt(Landroid/content/Context;Ljava/lang/String;I)V <span class="hljs-comment">//å†™å…¥æ•°æ®</span><br><br>    <span class="hljs-keyword">goto</span> :goto_50 <span class="hljs-comment">//è·³è½¬åœ°å€</span><br><br>    :cond_43<br><br>    check-cast p1, Landroid/content/Context;<br><br>    const-string p0, <span class="hljs-string">"\u8bf7\u5148\u5145\u503c\u5927\u4f1a\u5458\u54e6\uff01"</span> <span class="hljs-comment">//è¯·å…ˆå……å€¼å¤§ä¼šå‘˜å“¦ï¼</span><br><br>    check-cast p0, Ljava/lang/CharSequence;<br><br>    invoke-<span class="hljs-keyword">static</span> {p1, p0, p5}, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br><br>    move-result-object p0<br><br>    invoke-virtual {p0}, Landroid/widget/Toast;-&gt;show()V<br><br>    :goto_50<br>    <span class="hljs-keyword">return</span> p5  <span class="hljs-comment">//è¿”å›p5çš„å€¼</span><br>.end method <span class="hljs-comment">//æ–¹æ³•ç»“æŸ</span><br><br><span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æ˜¯å¤§ä¼šå‘˜çš„æ–¹æ³•</span><br>.method <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-title function_">isvip</span><span class="hljs-params">()</span>Z<br>    .registers <span class="hljs-number">2</span><br><br>    const/<span class="hljs-number">4</span> v0, <span class="hljs-number">0x0</span> <span class="hljs-comment">//v0èµ‹å€¼0</span><br><br>    <span class="hljs-keyword">return</span> v0 <span class="hljs-comment">//è¿”å›v0çš„å€¼</span><br><br>.end method<br><br></code></pre></td></tr></tbody></table></figure><p>  <a href="https://www.52pojie.cn/thread-650395-1-1.html">https://www.52pojie.cn/thread-650395-1-1.html</a></p><p>  <a href="https://www.52pojie.cn/thread-632178-1-1.html">å®‰å“æ¸¸æˆå†…è´­ç ´è§£ä¹‹æ»šåŠ¨çš„å¤©ç©º - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p>  <a href="https://www.52pojie.cn/thread-654654-1-1.html">ã€Šæ•™æˆ‘å…„å¼Ÿå­¦Androidé€†å‘03 ç ´è§£ç¬¬ä¸€ä¸ªAndroidæ¸¸æˆ ã€‹ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p></li></ul><h1 id="3-ç¤ºä¾‹"><a href="#3-ç¤ºä¾‹" class="headerlink" title="3.ç¤ºä¾‹"></a>3.ç¤ºä¾‹</h1><ul><li><p>1.é¦–å…ˆå®‰è£…å¥½æ ¸å¿ƒç ´è§£ï¼Œå‹¾é€‰åé‡å¯å¯ä»¥ä½¿ç”¨</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222040498.png"></p></li><li><p>2.å®‰è£…è¯¾ç¨‹æ‰€éœ€Demo</p><p>  <a href="https://pan.baidu.com/s/1cUInoi">https://pan.baidu.com/s/1cUInoi</a>   å¯†ç ï¼š07p9</p></li><li><p>3.åœ¨jadxä¸­æŸ¥è¯¢å…³é”®å­—ï¼ˆæœ‰æ—¶å€™åç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šå°†æ±‰å­—åç¼–è¯‘ä¸ºunicodeç¼–ç ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222041246.png"></p></li><li><p>ä¿®æ”¹ä»£ç é€»è¾‘</p><p>  å°†åˆ¤æ–­æ¡ä»¶æ”¹ä¸ºå¼ºåˆ¶è·³è½¬</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222041482.png"></p><p>  è·³è½¬åæ³¨é‡Šæ‰å…¶åˆ¤æ–­æ¡ä»¶ï¼Œä¸ç®¡æ˜¯å¦ä¸ºçœŸéƒ½æ‰§è¡Œä¸‹åˆ—é€»è¾‘</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222041586.png"></p></li></ul><p><a href="https://www.notion.so/1b0a6f4b4daf8074a46adc1041b616a6?pvs=21">åˆ‡æ°´æœå¤§æˆ˜</a></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222042093.png"></p>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>smail</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†APKæ–‡ä»¶ç»“æ„ï¼ŒåŒå¼€ï¼Œæ±‰åŒ–ï¼ŒåŸºç¡€ä¿®æ”¹</title>
    <link href="/2025/03/05/ZJ2/%E5%88%9D%E8%AF%86APK%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%EF%BC%8C%E5%8F%8C%E5%BC%80%EF%BC%8C%E6%B1%89%E5%8C%96%EF%BC%8C%E5%9F%BA%E7%A1%80%E4%BF%AE%E6%94%B9%201aba6f4b4daf806ab293e060e8f7d41f/"/>
    <url>/2025/03/05/ZJ2/%E5%88%9D%E8%AF%86APK%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%EF%BC%8C%E5%8F%8C%E5%BC%80%EF%BC%8C%E6%B1%89%E5%8C%96%EF%BC%8C%E5%9F%BA%E7%A1%80%E4%BF%AE%E6%94%B9%201aba6f4b4daf806ab293e060e8f7d41f/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆè¯†APKæ–‡ä»¶ç»“æ„ï¼ŒåŒå¼€ï¼Œæ±‰åŒ–ï¼ŒåŸºç¡€ä¿®æ”¹"><a href="#åˆè¯†APKæ–‡ä»¶ç»“æ„ï¼ŒåŒå¼€ï¼Œæ±‰åŒ–ï¼ŒåŸºç¡€ä¿®æ”¹" class="headerlink" title="åˆè¯†APKæ–‡ä»¶ç»“æ„ï¼ŒåŒå¼€ï¼Œæ±‰åŒ–ï¼ŒåŸºç¡€ä¿®æ”¹"></a>åˆè¯†APKæ–‡ä»¶ç»“æ„ï¼ŒåŒå¼€ï¼Œæ±‰åŒ–ï¼ŒåŸºç¡€ä¿®æ”¹</h1><h1 id="1-APKç»“æ„"><a href="#1-APKç»“æ„" class="headerlink" title="1.APKç»“æ„"></a>1.APKç»“æ„</h1><p>apk å…¨ç§° Android Packageï¼Œå®ƒç›¸å½“äºä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåªè¦åœ¨ç”µè„‘ä¸Šå°†apkåç¼€æ”¹ä¸ºzipå³å¯è§£å‹ã€‚</p><table><thead><tr><th><strong>æ–‡ä»¶</strong></th><th><strong>æ³¨é‡Š</strong></th></tr></thead><tbody><tr><td>assetsç›®å½•</td><td>å­˜æ”¾APKçš„é™æ€èµ„æºæ–‡ä»¶ï¼Œæ¯”å¦‚è§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ç­‰</td></tr><tr><td>lib ç›®å½•</td><td>armeabi-v7aåŸºæœ¬é€šç”¨æ‰€æœ‰androidè®¾å¤‡ï¼Œarm64-v8aåªé€‚ç”¨äº64ä½çš„androidè®¾å¤‡ï¼Œx86å¸¸è§ç”¨äºandroidæ¨¡æ‹Ÿå™¨ï¼Œå…¶ç›®å½•ä¸‹çš„.soæ–‡ä»¶æ˜¯cæˆ–c++ç¼–è¯‘çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶</td></tr><tr><td>META-INFç›®å½•</td><td>ä¿å­˜åº”ç”¨çš„ç­¾åä¿¡æ¯ï¼Œç­¾åä¿¡æ¯å¯ä»¥éªŒè¯APKæ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œç›¸å½“äºAPKçš„èº«ä»½è¯(éªŒè¯æ–‡ä»¶æ˜¯å¦åˆè¢«ä¿®æ”¹)</td></tr><tr><td>resç›®å½•</td><td>resç›®å½•å­˜æ”¾èµ„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬å›¾ç‰‡ï¼Œå­—ç¬¦ä¸²ç­‰ç­‰ï¼ŒAPKçš„è„¸è›‹ç”±ä»–çš„layoutæ–‡ä»¶è®¾è®¡</td></tr><tr><td>AndroidManifest.xmlæ–‡ä»¶</td><td>APKçš„åº”ç”¨æ¸…å•ä¿¡æ¯ï¼Œå®ƒæè¿°äº†åº”ç”¨çš„åå­—ï¼Œç‰ˆæœ¬ï¼Œæƒé™ï¼Œå¼•ç”¨çš„åº“æ–‡ä»¶ç­‰ç­‰ä¿¡æ¯</td></tr><tr><td>classes.dexæ–‡ä»¶</td><td>classes.dexæ˜¯javaæºç ç¼–è¯‘åç”Ÿæˆçš„javaå­—èŠ‚ç æ–‡ä»¶ï¼ŒAPKè¿è¡Œçš„ä¸»è¦é€»è¾‘</td></tr><tr><td>resources.arscæ–‡ä»¶</td><td>resources.arscæ˜¯ç¼–è¯‘åçš„äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œæ˜ å°„ç€èµ„æºå’Œidï¼Œé€šè¿‡Ræ–‡ä»¶ä¸­çš„idå°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„èµ„æº</td></tr></tbody></table><ul><li><p>APK æ–‡ä»¶æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œå¯é€šè¿‡è§£å‹å·¥å…·å¯¹å…¶è¿›è¡Œè§£å‹ç¼©ä»¥æŸ¥çœ‹å…¶å†…éƒ¨ç»“æ„ï¼Œä½†è§£å‹ç¼©åçš„æ–‡ä»¶ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œå¿…é¡»é‡æ–°æ‰“åŒ…å¹¶ç­¾ååæ‰èƒ½å®‰è£…åˆ°è®¾å¤‡ä¸Šã€‚</p><h3 id="1-æ–‡ä»¶ç»“æ„"><a href="#1-æ–‡ä»¶ç»“æ„" class="headerlink" title="1. æ–‡ä»¶ç»“æ„"></a><strong>1. æ–‡ä»¶ç»“æ„</strong></h3><ul><li><strong>/META-INFæ–‡ä»¶å¤¹</strong> ï¼šåŒ…å«åº”ç”¨ç¨‹åºçš„ç­¾åä¿¡æ¯ç­‰å…ƒæ•°æ®ï¼Œå¦‚MANIFEST.MFï¼ˆåº”ç”¨çš„æ¸…å•æ–‡ä»¶ï¼‰ã€CERT.SFï¼ˆåŒ…å«ç­¾åä¿¡æ¯ï¼Œç”¨äºæ ¡éªŒåº”ç”¨åŒ…çš„å®Œæ•´æ€§ï¼‰ã€CERT.RSAï¼ˆåº”ç”¨çš„æ•°å­—è¯ä¹¦ï¼Œå­˜å‚¨äº†è¯ä¹¦ä¿¡æ¯ï¼‰ã€‚</li><li><strong>/resæ–‡ä»¶å¤¹</strong> ï¼šå­˜å‚¨åº”ç”¨ç¨‹åºçš„å„ç§èµ„æºæ–‡ä»¶ï¼Œå¦‚ç•Œé¢å¸ƒå±€ï¼ˆå¸ƒå±€æ–‡ä»¶ï¼Œå¦‚<code>activity_main.xml</code>ï¼‰ã€å›¾å½¢å›¾åƒï¼ˆæ”¾åœ¨\drawable- [é…ç½®]æ–‡ä»¶å¤¹ä¸­ï¼Œä¸åŒçš„å±å¹•å¯†åº¦æœ‰ä¸åŒçš„ç›®å½•ï¼‰ã€å­—ç¬¦ä¸²ï¼ˆ<code>strings.xml</code>ï¼‰ã€æ ·å¼ï¼ˆ<code>styles.xml</code>ï¼‰ã€é¢œè‰²ï¼ˆ<code>colors.xml</code>ï¼‰ã€åŠ¨ç”»ï¼ˆå¦‚<code>animated.xml</code>ï¼‰ç­‰ã€‚</li><li><strong>/assetsæ–‡ä»¶å¤¹</strong> ï¼šå­˜æ”¾åº”ç”¨ç¨‹åºçš„ä»»æ„èµ„æºï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ï¼Œè¿™äº›æ–‡ä»¶ä¼šåœ¨ç¼–è¯‘æ—¶ä¿ç•™åœ¨åŸæ ·ï¼Œä¸ä¼šè¢«å¤„ç†ã€‚</li><li><strong>/libæ–‡ä»¶å¤¹</strong> ï¼šç”¨äºå­˜å‚¨åº”ç”¨ç¨‹åºçš„åŸç”Ÿä»£ç åº“ï¼ˆ <code>.so</code>æ–‡ä»¶ï¼‰ï¼Œé’ˆå¯¹ä¸åŒçš„å¤„ç†å™¨æ¶æ„æœ‰ä¸åŒçš„æ–‡ä»¶å¤¹ï¼ˆå¦‚<code>/lib/armeabi- v7a/</code>ã€<code>/lib/arm64- v8a/</code>ã€<code>/lib/x86/</code>ç­‰ï¼‰ã€‚</li><li><strong>/AndroidManifest.xml</strong> ï¼šæ˜¯åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶ï¼Œå£°æ˜äº†åº”ç”¨ç¨‹åºçš„ç»„ä»¶ï¼ˆå¦‚æ´»åŠ¨ã€æœåŠ¡ã€å¹¿æ’­æ¥æ”¶å™¨ã€å†…å®¹æä¾›è€…ï¼‰ã€æƒé™ã€å›¾æ ‡ã€æ ‡ç­¾ã€ç‰ˆæœ¬ç­‰é‡è¦ä¿¡æ¯ã€‚</li><li><strong>/classes.dexæ–‡ä»¶</strong> ï¼šæ˜¯åº”ç”¨ç¨‹åºçš„ Java æˆ– Kotlin ç¼–è¯‘ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ã€‚</li><li><strong>/resources.arscæ–‡ä»¶</strong> ï¼šæ˜¯ Android èµ„æºæ–‡ä»¶ï¼ŒåŒ…å«äº†åº”ç”¨ç¨‹åºä¸­çš„å„ç§èµ„æºï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ ·å¼ã€é¢œè‰²ç­‰ï¼‰çš„ç´¢å¼•ä¿¡æ¯ã€‚</li><li><strong>å…¶ä»–æ–‡ä»¶</strong> ï¼šå¦‚è¯ä¹¦æ–‡ä»¶ï¼ˆå¦‚<code>/META-INF/CERT.SF</code> å’Œ<code>/META-INF/CERT.RSA</code>ï¼‰ã€åº”ç”¨å›¾æ ‡ã€åº”ç”¨å¯åŠ¨å±æ–‡ä»¶ç­‰ã€‚</li></ul><h3 id="2-APKçš„åŠ è½½è¿‡ç¨‹"><a href="#2-APKçš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="2. APKçš„åŠ è½½è¿‡ç¨‹"></a><strong>2. APKçš„åŠ è½½è¿‡ç¨‹</strong></h3><p>  å½“ç”¨æˆ·å®‰è£… APK æ–‡ä»¶æ—¶ï¼ŒAndroid ç³»ç»Ÿä¼šè§£æ APK æ–‡ä»¶çš„ç»“æ„ï¼Œæå–å…¶ä¸­çš„ AndroidManifest.xml æ–‡ä»¶å’Œ resources.arsc æ–‡ä»¶ï¼Œè¯†åˆ«å‡ºåº”ç”¨ç¨‹åºçš„ç»„ä»¶ã€èµ„æºã€æƒé™ç­‰ä¿¡æ¯ã€‚ä¹‹åï¼Œç³»ç»Ÿä¼šå°† classes.dex æ–‡ä»¶ä¸­çš„å­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶è§£é‡Šæ‰§è¡Œï¼Œå®Œæˆåº”ç”¨ç¨‹åºçš„å¯åŠ¨å’Œè¿è¡Œã€‚åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šæ ¹æ®éœ€è¦åŠ¨æ€åŠ è½½å¹¶ä½¿ç”¨å…¶ä»–èµ„æºæ–‡ä»¶ï¼ˆå¦‚ res æ–‡ä»¶å¤¹ä¸­çš„èµ„æºæ–‡ä»¶å’Œ assets æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼‰ã€‚</p></li></ul><h1 id="2-åŒå¼€åŠåŸç†"><a href="#2-åŒå¼€åŠåŸç†" class="headerlink" title="2.åŒå¼€åŠåŸç†"></a>2.åŒå¼€åŠåŸç†</h1><p><a href="https://blog.csdn.net/u014294681/article/details/116270479">ã€VirtualAPP åŒå¼€ç³»åˆ—08ã€‘å¦‚ä½•å®ç°å¤šå¼€ - UID_virtualapp ä½¿ç”¨-CSDNåšå®¢</a></p><p>åŒå¼€ï¼šç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ‰‹æœºåŒæ—¶è¿è¡Œä¸¤ä¸ªæˆ–å¤šä¸ªç›¸åŒçš„åº”ç”¨ï¼Œä¾‹å¦‚åŒæ—¶è¿è¡Œä¸¤ä¸ªå¾®ä¿¡</p><table><thead><tr><th><strong>åŸç†</strong></th><th><strong>è§£é‡Š</strong></th></tr></thead><tbody><tr><td>ä¿®æ”¹åŒ…å</td><td>è®©æ‰‹æœºç³»ç»Ÿè®¤ä¸ºè¿™æ˜¯2ä¸ªAPPï¼Œè¿™æ ·çš„è¯å°±èƒ½ç”Ÿæˆ2ä¸ªæ•°æ®å­˜å‚¨è·¯å¾„ï¼Œæ­¤æ—¶çš„å¤šå¼€å°±ç­‰äºä½ æ‰“å¼€äº†ä¸¤ä¸ªäº’ä¸å¹²æ‰°çš„APP</td></tr><tr><td>ä¿®æ”¹Framework</td><td>å¯¹äºæœ‰ç³»ç»Ÿä¿®æ”¹æƒé™çš„å‚å•†ï¼Œå¯ä»¥ä¿®æ”¹Frameworkæ¥å®ç°åŒå¼€çš„ç›®çš„ï¼Œä¾‹å¦‚ï¼šå°ç±³è‡ªå¸¦å¤šå¼€</td></tr><tr><td>é€šè¿‡è™šæ‹ŸåŒ–æŠ€æœ¯å®ç°</td><td>è™šæ‹ŸFrameworkå±‚ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€æ¨¡æ‹ŸAndroidå¯¹ç»„ä»¶çš„ç®¡ç†ã€è™šæ‹Ÿåº”ç”¨è¿›ç¨‹ç®¡ç† ç­‰ä¸€æ•´å¥—è™šæ‹ŸæŠ€æœ¯ï¼Œå°†APKå¤åˆ¶ä¸€ä»½åˆ°è™šæ‹Ÿç©ºé—´ä¸­è¿è¡Œï¼Œä¾‹å¦‚ï¼šå¹³è¡Œç©ºé—´</td></tr><tr><td>ä»¥æ’ä»¶æœºåˆ¶è¿è¡Œ</td><td>åˆ©ç”¨åå°„æ›¿æ¢ï¼ŒåŠ¨æ€ä»£{è¿‡}{æ»¤}ç†ï¼Œhookäº†ç³»ç»Ÿçš„å¤§éƒ¨åˆ†ä¸systemâ€”serverè¿›ç¨‹é€šè®¯çš„å‡½æ•°ï¼Œä»¥æ­¤ä½œä¸ºâ€œæ¬ºä¸Šç’ä¸‹â€çš„ç›®çš„ï¼Œæ¬ºéª—ç³»ç»Ÿâ€œä»¥ä¸ºâ€åªæœ‰ä¸€ä¸ªapkåœ¨è¿è¡Œï¼Œç’è¿‡æ’ä»¶è®©å…¶â€œè®¤ä¸ºâ€è‡ªå·±å·²ç»å®‰è£…ã€‚ä¾‹å¦‚ï¼šVirtualApp</td></tr></tbody></table><h2 id="ï¼ˆ1ï¼‰é€šè¿‡MTç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€"><a href="#ï¼ˆ1ï¼‰é€šè¿‡MTç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€" class="headerlink" title="ï¼ˆ1ï¼‰é€šè¿‡MTç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€"></a>ï¼ˆ1ï¼‰é€šè¿‡MTç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€</h2><p>1.ä½¿ç”¨MTç®¡ç†å™¨æå–åº”ç”¨çš„å®‰è£…åŒ…</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/51cc4787-95b3-4e35-a392-92d492744021.png"></p><p>2.æ‰¾åˆ°æˆ‘ä»¬è¦æå–çš„apkï¼Œæå–å®šä½</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/image.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221955092.png"></p><p>3.é€šè¿‡APKå…±å­˜åŠŸèƒ½ä¿®æ”¹åŒ…åå®ç°apkåŒå¼€</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221957108.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221957109.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221957110.png"></p><p>4.å®ç°åŒå¼€</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958621.png"></p><h2 id="ï¼ˆ2ï¼‰é€šè¿‡NPç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€"><a href="#ï¼ˆ2ï¼‰é€šè¿‡NPç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€" class="headerlink" title="ï¼ˆ2ï¼‰é€šè¿‡NPç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€"></a>ï¼ˆ2ï¼‰é€šè¿‡NPç®¡ç†å™¨ä¿®æ”¹åŒ…åå®ç°åŒå¼€</h2><p>æµç¨‹ä¸MTå¤§è‡´ç›¸åŒ</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958997.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958998.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958999.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958000.png"></p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221958001.png"></p><p>æ‰“å¼€ä¿®æ”¹æŠ¥ååçš„apkå®‰è£…</p><p><img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221959552.png"></p><p>å°±å¯ä»¥åœ¨æ‰‹æœºä¸Šå®ŒæˆåŒå¼€ã€‚å› ä¸ºä¿®æ”¹æŠ¥åå®ç°åŒå¼€åŠ¨äº†åº”ç”¨çš„ç­¾åä¿¡æ¯ï¼Œå¦‚æœå¼€å‘è€…åšäº†ç­¾åæ ¡éªŒå¯èƒ½ä¼šå‡ºç°å®‰è£…åé—ªé€€å´©æºƒç­‰æƒ…å†µã€‚</p><h1 id="3-æ±‰åŒ–APK"><a href="#3-æ±‰åŒ–APK" class="headerlink" title="3.æ±‰åŒ–APK"></a>3.æ±‰åŒ–APK</h1><p>ä½¿ç”¨ä¸“é—¨çš„å·¥å…·å¯¹å¤–æ–‡ç‰ˆçš„è½¯ä»¶èµ„æºè¿›è¡Œè¯»å–ï¼Œç¿»è¯‘ï¼Œä¿®æ”¹ï¼Œå›å†™ç­‰ä¸€ç³»åˆ—å¤„ç†ï¼Œä½¿ç”¨è½¯ä»¶çš„èœå•ï¼Œå¯¹è¯æ¡†ï¼Œæç¤ºç­‰ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºä¸ºä¸­æ–‡ï¼Œè€Œç¨‹åºçš„å†…æ ¸å’ŒåŠŸèƒ½ä¿æŒä¸å˜ï¼Œè¿™ä¸ªè¿‡ç¨‹å³ä¸ºè½¯ä»¶æ±‰åŒ–ã€‚</p><p>ï¼ˆéœ€è¦æ³¨æ„ï¼Œå¦‚æœè¦ç›´æ¥è£…åº”ç”¨å°±åº”è¯¥å…ˆç­¾åå®‰è£…ï¼Œçœ‹çŸ³å¦æœ‰ç­¾åæ ¡éªŒå¯¼è‡´çš„é—ªé€€ã€‚ï¼‰</p><p><strong>åŸºæœ¬ä¸Šå­—ç¬¦ä¸²éƒ½æ˜¯åœ¨arscé‡Œï¼Œå»ºè®®ä¸€é”®æ±‰åŒ–ï¼Œç„¶åå†æ¶¦è‰²ã€‚å°‘é‡æ²¡æ±‰åŒ–åˆ°çš„å­—ç¬¦ä¸²å‚è€ƒè§†é¢‘ä¸­çš„æ–¹æ³•å®šä½å»é€ä¸ªæ±‰åŒ–ã€‚</strong></p><p>   <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503221959189.png"></p><h2 id="ï¼ˆ1ï¼‰ç®€å•çš„è‹±è¯­å­—å¥ä¿®æ”¹"><a href="#ï¼ˆ1ï¼‰ç®€å•çš„è‹±è¯­å­—å¥ä¿®æ”¹" class="headerlink" title="ï¼ˆ1ï¼‰ç®€å•çš„è‹±è¯­å­—å¥ä¿®æ”¹"></a>ï¼ˆ1ï¼‰ç®€å•çš„è‹±è¯­å­—å¥ä¿®æ”¹</h2><ul><li><p>1.æˆ‘ä»¬åœ¨ç®¡ç†å™¨ä¸­ç‚¹å‡»æŸ¥çœ‹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222000125.png"></p></li><li><p>2.åˆ©ç”¨MTè‡ªå¸¦çš„æœç´¢åŠŸèƒ½</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222000631.png"></p></li><li><p>3.ç‚¹å‡»é«˜çº§æœç´¢ç›¸å½“ä½¿ç”¨å…¨å±€æœç´¢ï¼ˆæœç´¢åº”ç”¨ä¸­çš„å…¨éƒ¨æ–‡ä»¶ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222000935.png"></p></li><li><p>4.å¯¹æŸ¥è¯¢åˆ°çš„ç»“æœè¿›è¡Œåç¼–è¯‘</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222001609.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222001610.png"></p></li><li><p>5.å¯¹å†…å®¹è¿›è¡Œä¿®æ”¹åä¿</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222001075.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222001076.png"></p></li><li><p>6.å‘ç°æˆ‘ä»¬å¯¹å†…å®¹è¿›è¡Œäº†é‡æ–°ç­¾åï¼Œåº”ç”¨ä¸æœ€å¼€å§‹å®‰è£…å·²ç»æ˜¯ä¸ä¸€æ ·çš„äº†ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222004158.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222002990.png"></p></li><li><p>7.å¯¹äºå¸è½½æç¤ºå¯ä»¥ç›´æ¥å…³é—­å¤„ç†ï¼Œåœ¨è®¾ç½®é‡Œçš„APKå®‰è£…æ£€éªŒè¯å…³é—­å°±ä¸ä¼šå†æç¤º</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222005497.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222005498.png"></p></li><li><p>8.å…³é—­åè¿˜ä¼šå‡ºç°ç­¾åä¸ä¸€è‡´å®‰è£…å¤±è´¥çš„ç°è±¡ã€‚ï¼ˆå¯ä»¥å¸è½½åŸåº”ç”¨æˆ–åˆ©ç”¨XPçš„æ¨¡å—æ ¸å¿ƒç ´è§£æ¥è§£å†³è¿™ç±»é—®é¢˜ï¼‰</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222005117.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222005118.png"></p></li><li><p>9.å®Œæˆåæˆ‘ä»¬ä¼šå‘ç°ä¿®æ”¹éƒ¨åˆ†å·²ç»å˜ä¸ºä¸­æ–‡æ¨¡å¼</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222006665.png"></p></li></ul><h2 id="ï¼ˆ2ï¼‰åˆ©ç”¨å¼€å‘è€…åŠ©æ‰‹æœç´¢"><a href="#ï¼ˆ2ï¼‰åˆ©ç”¨å¼€å‘è€…åŠ©æ‰‹æœç´¢" class="headerlink" title="ï¼ˆ2ï¼‰åˆ©ç”¨å¼€å‘è€…åŠ©æ‰‹æœç´¢"></a>ï¼ˆ2ï¼‰åˆ©ç”¨å¼€å‘è€…åŠ©æ‰‹æœç´¢</h2><ul><li><p>1.ä¸‹è½½å®‰è£…åä¼šæœ‰ä¸€ä¸ªå°å›¾æ ‡</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222006876.png"></p></li><li><p>2.æˆ‘ä»¬åˆ°éœ€è¦ä¿®æ”¹çš„appé¡µé¢ç‚¹å‡»å›¾æ ‡ï¼Œç‚¹å‡»å¼€å§‹èµ„æºåˆ†æ</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222006872.png"></p></li><li><p>3.ç‚¹å‡»éœ€è¦æŸ¥çœ‹çš„äº®æ¡éƒ¨åˆ†ï¼Œç‚¹å‡»å¤åˆ¶æˆ‘ä»¬éœ€è¦çš„æ–‡æœ¬ä¿¡æ¯ï¼Œå†å›åˆ°MTç®¡ç†å™¨ä¸­é‡å¤ä¸Šè¿°æ­¥éª¤å³å¯</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222007495.png"></p></li></ul><p>ä¹Ÿå¯ä»¥ç›´æ¥å†MTæµè§ˆå™¨ä¸­å¼€é€šæ±‰åŒ–ç¿»è¯‘æ’ä»¶</p><p>æˆ‘ä»¬å‘ç°ç¬¬äºŒæ¬¡ç­¾ååè½¯ä»¶å¯ä»¥ç›´æ¥å®‰è£…æˆåŠŸï¼ŒåŸå› æ˜¯MTè‡ªå¸¦çš„ç­¾åä¿¡æ¯ä¸€è‡´ï¼Œä¸ä¼šå‡ºç°ç­¾åä¿¡æ¯å†²çªçš„æƒ…å†µï¼Œå¯ä»¥ç›´æ¥è¦†ç›–å®‰è£…</p><h2 id="ï¼ˆ3ï¼‰æ”¾åœ¨dexæ–‡ä»¶ä¸­"><a href="#ï¼ˆ3ï¼‰æ”¾åœ¨dexæ–‡ä»¶ä¸­" class="headerlink" title="ï¼ˆ3ï¼‰æ”¾åœ¨dexæ–‡ä»¶ä¸­"></a>ï¼ˆ3ï¼‰æ”¾åœ¨dexæ–‡ä»¶ä¸­</h2><ul><li><p>1.é€‰æ‹©dexç¼–è¾‘å™¨++</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222007447.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222007448.png"></p></li><li><p>2.åŒæ ·æ¥æœç´¢æˆ‘ä»¬ä¿®æ”¹çš„å­—ç¬¦ï¼Œæœç´¢ç±»å‹å¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222008816.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222008817.png"></p></li><li><p>3.å¾ˆå¿«å°±èƒ½çš„å¾—åˆ°æœç´¢ç»“æœ</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222008163.png"></p></li><li><p>4.ä¿®æ”¹åä¿å­˜é€€å‡ºé‡å¤ä¸Šè¿°æ­¥éª¤</p></li></ul><h1 id="4-åˆè¯†AndroidManifest-xml"><a href="#4-åˆè¯†AndroidManifest-xml" class="headerlink" title="4.åˆè¯†AndroidManifest.xml"></a>4.<strong>åˆè¯†AndroidManifest.xml</strong></h1><p>AndroidManifest.xmlæ–‡ä»¶æ˜¯æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ä¿¡æ¯æè¿°æ–‡ä»¶ï¼Œå®šä¹‰äº†åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„Activity,Service,Content providerå’ŒBroadcastReceiverç»„ä»¶ä¿¡æ¯ã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºåœ¨æ ¹ç›®å½•ä¸‹å¿…é¡»åŒ…å«ä¸€ä¸ªAndroidManifest.xmlæ–‡ä»¶ï¼Œä¸”æ–‡ä»¶åä¸èƒ½ä¿®æ”¹ã€‚å®ƒæè¿°äº†packageä¸­æš´éœ²çš„ç»„ä»¶ï¼Œä»–ä»¬å„è‡ªçš„å®ç°ç±»ï¼Œå„ç§èƒ½è¢«å¤„ç†çš„æ•°æ®å’Œå¯åŠ¨ä½ç½®ã€‚</p><table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>å®šä¹‰</strong></th></tr></thead><tbody><tr><td>versionCode</td><td>ç‰ˆæœ¬å·ï¼Œä¸»è¦ç”¨æ¥æ›´æ–°ï¼Œä¾‹å¦‚:12</td></tr><tr><td>versionName</td><td>ç‰ˆæœ¬åï¼Œç»™ç”¨æˆ·çœ‹çš„ï¼Œä¾‹å¦‚:1.2</td></tr><tr><td>package</td><td>åŒ…åï¼Œä¾‹å¦‚ï¼šcom.zj.52pj.demo</td></tr><tr><td>uses-permission android:name=â€â€</td><td>åº”ç”¨æƒé™ï¼Œä¾‹å¦‚ï¼šandroid.permission.INTERNET ä»£è¡¨ç½‘ç»œæƒé™</td></tr><tr><td>android:label=â€@string/app_nameâ€</td><td>åº”ç”¨åç§°</td></tr><tr><td>android:icon=â€@mipmap/ic_launcherâ€</td><td>åº”ç”¨å›¾æ ‡è·¯å¾„</td></tr><tr><td>android:debuggable=â€trueâ€</td><td>åº”ç”¨æ˜¯å¦å¼€å¯debugæƒé™</td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table><p>ä½¿ç”¨NTæµè§ˆå™¨ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶</p><ul><li><p>1.ç›´æ¥è¿›å…¥æŸ¥çœ‹ç¼–è¯‘</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222008126.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009665.png"></p></li><li><p>2.ä¿®æ”¹apkå›¾æ ‡å’Œåå­—ï¼Œåœ¨NPç®¡ç†å™¨ä¸­ä½¿ç”¨é€šç”¨ç¼–è¾‘è¿›è¡Œä¿®æ”¹</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009864.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009865.png"></p></li><li><p>3.ä¿å­˜å®‰è£…å‘ç°åˆå‡ºç°ç­¾åä¿¡æ¯ä¸ä¸€è‡´å› ä¸ºä¸Šè¾¹ç”¨çš„MTç®¡ç†å™¨ç­¾åï¼Œå’Œç°åœ¨NPç­¾åä¸ä¸€è‡´ï¼ŒæŒ‰ä¸Šè¿°æ–¹æ³•è§£å†³å³å¯ï¼Œå®‰è£…åå¯ä»¥è§‚å¯Ÿåˆ°ä¿®æ”¹æˆåŠŸã€‚</p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009655.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009656.png"></p><p>  <img src="https://raw.githubusercontent.com/CC-NX/blogImage/main//_img/202503222009657.png"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Androidé€†å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>APKç»“æ„</tag>
      
      <tag>åŒå¼€åŸç†</tag>
      
      <tag>APKæ±‰åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/03/02/hello-world/"/>
    <url>/2025/03/02/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">"My New Post"</span><br></code></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
